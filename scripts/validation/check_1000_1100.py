#!/usr/bin/env python3
"""
Тестирование секций 1000-1100 базы знаний.
Минимум 5 уникальных клиентских запросов на каждую секцию.
"""

import sys
sys.path.insert(0, 'src')

from src.knowledge.retriever import CascadeRetriever

retriever = CascadeRetriever(use_embeddings=False)

# Тестовые запросы для секций 1000-1100 (имитация клиентов)
TEST_QUERIES = {
    # ==================== REGIONS (13 entries) ====================
    "regions_shymkent_1000": [
        "для магазинов в шымкенте есть предложение",
        "шымкент wipon поставите кассы",
        "работаете в шымкенте",
        "шымкент оборудование и программа",
        "в шымкенте wipon подключаете",
    ],
    "regions_karaganda_1001": [
        "бизнес в караганде кассовые решения",
        "караганда программа учёта подключите",
        "поддержка в караганде есть",
        "касса wipon караганда доставка",
        "караганда касса wipon",
    ],
    "regions_aktau_1002": [
        "подключить wipon в актау",
        "актау wipon работает",
        "актау доставка оборудования",
        "в актау касса wipon",
        "актау система учёта",
    ],
    "regions_pavlodar_1003": [
        "продукты wipon павлодар доставка",
        "павлодар программа учёта",
        "оборудование wipon павлодар",
        "павлодар касса wipon",
        "павлодар онлайн касса",
    ],
    "regions_kostanay_1004": [
        "для костаная решения wipon",
        "костанай касса wipon подключение",
        "костанай wipon работает",
        "костанай программа wipon",
        "в костанае доставка wipon",
    ],
    "regions_ustkam_1005": [
        "усть-каменогорск касса wipon",
        "оскемен wipon настройка",
        "усть-каменогорск wipon установим",
        "усть-каменогорск обучение wipon",
        "в усть-каменогорске настройка wipon",
    ],
    "regions_atyrau_1006": [
        "атырау онлайн кассы wipon",
        "атырау программа учёта wipon",
        "атырау pos терминалы wipon",
        "атырау касса wipon доставка",
        "wipon атырау настройка",
    ],
    "regions_turkestan_1007": [
        "туркестан кассовые решения wipon",
        "для туркестана оборудование wipon",
        "туркестан обучение персонала wipon",
        "туркестан wipon касса",
        "туркестан доставка wipon",
    ],
    "regions_shymkent_equip_1041": [
        "шымкент оборудование и программу wipon",
        "шымкент wipon комплект",
        "для шымкента программа wipon настройка",
        "шымкент магазин настроим wipon",
        "шымкент программа wipon подключение",
    ],
    "regions_karaganda_equip_1042": [
        "караганда онлайн кассу подключить",
        "караганда комплект оборудования wipon",
        "караганда wipon подключение кассы",
        "караганда магазин wipon касса программа",
        "караганда wipon комплект",
    ],
    "regions_pavlodar_equip_1043": [
        "павлодар комплект standard wipon",
        "павлодар wipon standard тариф",
        "павлодар касса сканер принтер wipon",
        "павлодар оборудование программа wipon standard",
        "павлодар wipon комплект стандарт",
    ],
    "regions_shu_kz_1049": [
        "шу қаласына касса жеткізесіздер",
        "шу қаласында wipon",
        "шуға кассалық аппарат",
        "шу wipon касса",
        "шу қаласына wipon орнату",
    ],
    "regions_village_delivery_1087": [
        "в село доставите оборудование wipon",
        "магазин в селе доставка wipon",
        "доставка в аул wipon",
        "сельский магазин оборудование wipon доставка",
        "в деревню wipon доставите",
    ],

    # ==================== PRODUCTS (18 entries) ====================
    "products_business_program_1008": [
        "программа для бизнеса wipon",
        "wipon для бизнеса какая программа",
        "wipon программа учёта автоматизации",
        "для магазина программа wipon какую предлагаете",
        "программа автоматизации wipon для магазинов",
    ],
    "products_difference_1009": [
        "чем wipon отличается от других систем",
        "wipon собственная касса бесплатный офд",
        "преимущества wipon техподдержка без посредников",
        "wipon отличие от конкурентов",
        "у wipon своя касса и офд",
    ],
    "products_small_shop_1010": [
        "wipon для небольшого магазина",
        "маленький магазин wipon без лишней сложности",
        "небольшой магазин продажи остатки аналитика wipon",
        "wipon для маленького магазина подойдёт",
        "небольшой магазин wipon учёт",
    ],
    "products_chain_stores_1011": [
        "сеть магазинов wipon единая база",
        "несколько точек wipon один кабинет",
        "управление точками wipon единая база",
        "wipon для сети магазинов аналитика",
        "wipon сеть магазинов управление",
    ],
    "products_turnkey_1013": [
        "wipon под ключ оборудование программа настройка",
        "комплексное решение wipon под ключ",
        "wipon запуск под ключ сопровождение",
        "оборудование программа настройка wipon под ключ",
        "wipon запускаем работу под ключ",
    ],
    "products_no_accountant_1016": [
        "wipon без бухгалтера вести учёт",
        "wipon продажи остатки налоги сам",
        "без бухгалтера wipon самому вести",
        "wipon бухгалтерский консалтинг",
        "wipon сам веду учёт без бухгалтера",
    ],
    "products_almaty_full_1040": [
        "wipon программа для магазина алматы",
        "алматы wipon касса сканер принтер под ключ",
        "wipon алматы магазин под ключ",
        "что за программа wipon для алматы",
        "wipon алматы доставим настроим",
    ],
    "products_chain_almaty_pro_1044": [
        "сеть магазинов алматы тариф pro wipon",
        "wipon pro для сети точек алматы",
        "несколько точек алматы wipon pro расширенный",
        "pos моноблоки для сети wipon алматы",
        "wipon тариф pro сеть магазинов",
    ],
    "products_fastfood_1045": [
        "wipon касса для фастфуда",
        "фастфуд wipon быстрая печать чеков",
        "для фастфуда wipon учёт продаж закупок",
        "фастфуд касса wipon программа",
        "wipon для фастфуда касса",
    ],
    "products_fastfood_automation_1046": [
        "wipon автоматизация фастфудов",
        "фастфуд wipon подключение кассы программы",
        "автоматизируем фастфуды wipon",
        "wipon для фастфуда быстро без сбоев",
        "ставите автоматизацию для фастфудов wipon",
    ],
    "products_sales_purchases_1047": [
        "wipon полный учёт продажи закупки остатки",
        "программа wipon учёт продаж закупок",
        "wipon всё в одном месте учёт",
        "продажи закупки остатки аналитика wipon",
        "wipon программа подойдёт для полного учёта",
    ],
    "products_install_kz_1051": [
        "қандай программа орнату керек wipon",
        "wipon бағдарламасын орнату",
        "wipon бағдарлама орнатып көрсетіп береміз",
        "wipon орнатып іске қосып береміз",
        "wipon бағдарламасы орнату қазақша",
    ],
    "products_construction_1054": [
        "wipon точка стройматериалов касса сканер",
        "стройматериалы wipon программа учёта",
        "wipon для стройматериалов просто удобно",
        "магазин стройматериалов wipon касса программа",
        "для стройматериалов wipon что предлагаете",
    ],
    "products_demo_1058": [
        "wipon демо версия попробовать",
        "демо доступ wipon протестировать",
        "попробовать wipon перед покупкой",
        "wipon тестировать программу демо",
        "демо wipon есть",
    ],
    "products_market_stall_1067": [
        "wipon для точки на рынке",
        "небольшие точки рынок wipon",
        "павильон на рынке wipon",
        "wipon для рынка касса программа",
        "wipon точки на рынке подойдёт",
    ],
    "products_franchise_1070": [
        "wipon для франшизы сеть точек",
        "франшиза wipon учёт по точкам",
        "общая аналитика франшиза wipon",
        "франчайзинг wipon справится",
        "wipon франшиза учёт по точкам аналитика",
    ],
    "products_windows_mac_1078": [
        "wipon программа windows 10",
        "wipon на mac веб версия",
        "какая ос wipon windows",
        "wipon программа для windows",
        "на маке wipon веб версия",
    ],
    "products_boutique_1098": [
        "wipon для бутика одежды учёт размерам цветам",
        "небольшой бутик wipon категории",
        "wipon учёт одежды по размерам цветам категориям",
        "бутик одежды wipon подойдёт",
        "wipon для бутика учёт размеры цвета",
    ],

    # ==================== SUPPORT (22 entries) ====================
    "support_setup_help_1015": [
        "wipon помогаете с установкой настройкой",
        "wipon подключим настроим обучим",
        "помощь настройкой wipon обучим",
        "wipon ничего искать не придётся",
        "установка настройка wipon помощь",
    ],
    "support_migrate_umag_1018": [
        "переход с umag на wipon",
        "umag в wipon перенос номенклатуры",
        "миграция umag wipon выгрузим загрузим",
        "umag выгрузить wipon загрузить",
        "с umag на wipon перехожу",
    ],
    "support_migrate_beksar_1019": [
        "переход с бексар на wipon остатки цены",
        "бексар в wipon миграция остатки",
        "с бексар на wipon перехожу",
        "бексар wipon перенос остатков цен",
        "миграция бексар wipon",
    ],
    "support_migrate_moysklad_1020": [
        "переход с мойсклад на wipon",
        "мойсклад в wipon миграция товары остатки",
        "импорт из мойсклад wipon",
        "с мойсклад на wipon перенос",
        "мойсклад wipon клиентская база",
    ],
    "support_export_umag_1021": [
        "выгрузить товары umag загрузить wipon",
        "umag база товаров wipon загрузка",
        "umag экспорт wipon без потерь",
        "umag выгрузка wipon",
        "база товаров umag в wipon",
    ],
    "support_migrate_x2pos_1022": [
        "переход с x2pos на wipon",
        "x2pos в wipon миграция данных",
        "сопровождаем переход x2pos wipon",
        "x2pos wipon перенос данных",
        "с x2pos на wipon ничего не потеряется",
    ],
    "support_history_beksar_1023": [
        "история продаж бексар wipon перенести",
        "бексар история wipon сохранить",
        "уйти от бексар история wipon",
        "перенести историю бексар wipon нельзя",
        "бексар wipon история продаж",
    ],
    "support_migrate_time_1024": [
        "сколько времени переход wipon миграция",
        "миграция wipon сколько занимает",
        "перенос данных wipon от 30 минут до часа",
        "время миграции wipon",
        "wipon переход сколько времени занимает",
    ],
    "support_umag_onboarding_1025": [
        "сопровождение при переходе с umag wipon",
        "umag wipon помощь на старте",
        "umag wipon подключить кассу обучим",
        "сопровождение umag wipon миграция",
        "умаг wipon помогаем подключить обучаем",
    ],
    "support_x2pos_help_1026": [
        "техподдержка x2pos wipon переход",
        "x2pos wipon сопровождение этапах",
        "помощь при переходе x2pos wipon",
        "x2pos wipon пока всё заработает",
        "сопровождение x2pos wipon миграция",
    ],
    "support_beksar_training_1027": [
        "обучение после бексар wipon сотрудники",
        "бексар wipon обучение персонала",
        "сотрудники привыкнут бексар wipon",
        "адаптация после бексар wipon обучение",
        "бексар wipon помогаете привыкнуть",
    ],
    "support_cashier_training_1028": [
        "обучите кассиров wipon мойсклад переход",
        "кассиры привыкнут wipon быстро",
        "покажем как работать wipon кассиры",
        "обучение кассиров wipon",
        "кассиры wipon обучение",
    ],
    "support_after_connect_1029": [
        "сопровождаете после подключения wipon",
        "wipon поддержка после установки всегда",
        "wipon не только установка сопровождение",
        "wipon дальнейшее сопровождение",
        "поддержка wipon после подключения",
    ],
    "support_registration_time_1030": [
        "регистрация wipon быстрая несколько минут",
        "сколько минут регистрация wipon",
        "wipon регистрация быстро",
        "время регистрации wipon",
        "регистрация wipon быстрая",
    ],
    "support_connection_time_1031": [
        "подключение wipon сколько времени",
        "wipon подключение 30 минут час",
        "как долго подключение wipon",
        "время подключения wipon",
        "wipon подключение быстро или долго",
    ],
    "support_online_setup_1032": [
        "wipon ехать в офис не нужно",
        "подключение wipon онлайн полностью",
        "wipon удалённое подключение настройка",
        "не надо ехать wipon онлайн",
        "wipon всё онлайн подключение",
    ],
    "support_start_after_payment_1033": [
        "wipon когда начать после оплаты",
        "после оплаты wipon сразу активируем",
        "wipon активация быстро после оплаты",
        "практически сразу wipon после оплаты",
        "wipon сразу после оплаты начинать",
    ],
    "support_register_kassa_1034": [
        "зарегистрировать кассу wipon сложно",
        "wipon помогаете регистрация кассы",
        "регистрация кассы wipon шаг за шагом",
        "wipon регистрация кассы не сложно",
        "поможем регистрация кассы wipon",
    ],
    "support_ecp_required_1035": [
        "wipon эцп при регистрации кассы",
        "wipon нужна эцп офд",
        "электронная подпись wipon офд касса",
        "wipon эцп для кассы офд",
        "эцп регистрация wipon офд",
    ],
    "support_kazakh_lang_1072": [
        "wipon қазақша қолдау бар",
        "техникалық қолдау қазақша wipon",
        "wipon қазақ тілінде қолдау",
        "поддержка на казахском wipon",
        "wipon казахский язык поддержка",
    ],
    "support_night_hours_1077": [
        "wipon поддержка ночью до полуночи",
        "круглосуточная поддержка wipon ночью",
        "wipon поддержка выходные до 21",
        "до скольки wipon поддержка работает",
        "wipon ночная поддержка магазин",
    ],
    "support_cashier_onboarding_1089": [
        "wipon обучаете кассиров при установке",
        "при установке wipon покажем кассирам",
        "wipon обучение персонала при установке",
        "кассиров wipon научим при подключении",
        "wipon обучаем при установке оборудования",
    ],

    # ==================== EQUIPMENT (11 entries) ====================
    "equipment_start_kit_1012": [
        "wipon что нужно для старта минимум",
        "минимальный комплект wipon для старта",
        "wipon для начала что купить оборудование",
        "оборудование для начала wipon касса сканер",
        "wipon минимум оборудования для старта",
    ],
    "equipment_banknote_counter_1036": [
        "wipon счётчик банкнот есть",
        "счётчик купюр wipon",
        "wipon машинка для денег счётчик",
        "счётчик денег wipon быстро",
        "wipon счётчик банкнот кассовые операции",
    ],
    "equipment_offer_list_1037": [
        "какое оборудование wipon предлагаете список",
        "wipon каталог оборудования что есть",
        "список оборудования wipon",
        "wipon что можно купить оборудование",
        "оборудование wipon моноблоки сканеры весы",
    ],
    "equipment_ready_kits_1038": [
        "wipon готовые комплекты standard",
        "готовый набор wipon standard+",
        "комплект wipon под ключ готов к работе",
        "wipon комплекты из коробки",
        "wipon готовый комплект standard standard+",
    ],
    "equipment_popular_1039": [
        "wipon что берут чаще всего комплект",
        "самое популярное оборудование wipon",
        "wipon что рекомендуете комплект standard",
        "популярный комплект wipon",
        "wipon самый ходовой комплект",
    ],
    "equipment_veggies_1048": [
        "wipon оборудование для овощей фруктов весы",
        "весовой товар wipon весы касса",
        "wipon для овощного магазина весы",
        "развесной товар wipon оборудование",
        "wipon весы передают вес в программу",
    ],
    "equipment_quiet_1056": [
        "wipon тихое оборудование без шума",
        "для кофейни wipon бесшумная касса",
        "wipon тихий принтер моноблок",
        "тихое wipon для кофейни",
        "wipon оборудование тишина кофейня",
    ],
    "equipment_rental_1083": [
        "wipon аренда оборудования нет рассрочка",
        "взять в аренду wipon нет",
        "арендовать кассу wipon нет рассрочка",
        "wipon оборудование напрокат нет",
        "wipon аренды нет только рассрочка kaspi",
    ],
    "equipment_scales_weigh_1088": [
        "wipon весы для развеса магазина",
        "весы wipon передают вес в кассу программу",
        "wipon весы интеграция автоматически цена",
        "wipon весы для магазина вес в кассу",
        "весы wipon автоматический подсчёт цены",
    ],
    "equipment_customer_screen_1090": [
        "wipon второй экран для покупателей",
        "экран покупателя wipon видит сумму",
        "wipon дисплей для клиента доверие",
        "второй экран wipon покупатель видит",
        "wipon экран покупателя товары сумма",
    ],
    "equipment_cold_storage_1095": [
        "wipon оборудование холодные склады",
        "для холода wipon минусовая температура",
        "работа в холоде wipon стабильно",
        "морозильный склад wipon оборудование",
        "wipon холодный склад павильон стабильно",
    ],

    # ==================== INTEGRATIONS (8 entries) ====================
    "integrations_kaspi_store_1052": [
        "интеграция kaspi магазин wipon",
        "kaspi магазин wipon заказы автоматически",
        "wipon kaspi магазин синхронизация",
        "каспи магазин wipon интеграция",
        "wipon kaspi магазин данные продажи",
    ],
    "integrations_halyk_pos_1055": [
        "халык pos терминал wipon сумма автоматически",
        "halyk терминал wipon интеграция",
        "wipon интеграция halyk bank терминал",
        "терминал халык wipon сумма передаётся",
        "wipon halyk pos терминал подключить",
    ],
    "integrations_marketplaces_1061": [
        "wipon интеграции kaspi halyk market",
        "маркетплейсы wipon заказы автоматически",
        "kaspi halyk market wipon синхронизация",
        "wipon интеграция маркетплейсы заказы чеки",
        "онлайн площадки wipon интеграция",
    ],
    "integrations_online_shop_1065": [
        "wipon интеграция онлайн магазин kaspi halyk",
        "интернет магазин wipon синхронизация",
        "wipon ecommerce интеграция заказы",
        "онлайн продажи wipon интеграция",
        "wipon интеграция онлайн магазин",
    ],
    "integrations_kaspi_red_1076": [
        "kaspi red wipon оплата рассрочка",
        "каспи рассрочка wipon сумма автоматически",
        "wipon оплата через kaspi red приложение",
        "kaspi рассрочка wipon",
        "wipon kaspi red оплата",
    ],
    "integrations_multi_terminals_1080": [
        "wipon несколько pos терминалов одна система",
        "два терминала wipon подключить",
        "wipon много терминалов несколько банков",
        "несколько терминалов wipon подключить",
        "wipon несколько pos терминалов",
    ],
    "integrations_multi_acquiring_1085": [
        "wipon эквайринг несколько банков сразу",
        "терминалы разных банков wipon выбирать",
        "два банка эквайринг wipon",
        "wipon несколько банков эквайринг терминалы",
        "wipon эквайринг от разных банков",
    ],
    "integrations_api_1091": [
        "wipon api интеграция сайт",
        "api wipon своя интеграция",
        "wipon api документация есть",
        "интегрировать wipon api",
        "wipon api по запросу",
    ],

    # ==================== PRICING (4 entries) ====================
    "pricing_tariff_choice_1014": [
        "wipon какой тариф выбрать lite standard pro",
        "lite standard pro wipon в чём разница",
        "wipon сравнение тарифов lite standard",
        "какой тариф wipon лучше",
        "wipon что выбрать lite или standard",
    ],
    "pricing_wholesale_retail_1068": [
        "wipon разные цены опт розница прайслисты",
        "оптовые розничные цены wipon два прайса",
        "wipon несколько прайслистов standart pro",
        "прайсы опт розница wipon",
        "wipon два прайса опт розница",
    ],
    "pricing_installment_1075": [
        "wipon рассрочка оплата тариф оборудование",
        "оплатить в рассрочку wipon тариф",
        "wipon частями оплатить рассрочка",
        "рассрочка wipon и тариф и оборудование",
        "wipon оплата в рассрочку тариф",
    ],
    "pricing_program_free_1099": [
        "wipon бесплатный тариф mini базовые функции",
        "программа бесплатная wipon mini",
        "wipon бесплатно mini базовый",
        "wipon 0 тенге бесплатный тариф",
        "бесплатная версия wipon mini",
    ],

    # ==================== FEATURES (5 entries) ====================
    "features_delivery_1017": [
        "wipon доставка курьер оформить",
        "wipon заказы на доставку оформлять",
        "доставка wipon курьерская служба",
        "wipon доставка заказы оформление",
        "заказы на доставку wipon",
    ],
    "features_two_currencies_kz_1060": [
        "wipon екі валюта теңге доллар қазақша",
        "екі валютамен жұмыс wipon",
        "wipon теңге доллар екі валюта",
        "екі валюта бір программада wipon",
        "wipon екі валютамен есеп",
    ],
    "features_price_tags_1071": [
        "wipon печать ценников этикеток",
        "ценники wipon принтер этикеток",
        "wipon этикетки ценники печатать",
        "печать ценников wipon из программы",
        "wipon ценники этикетки",
    ],
    "features_logo_receipt_1079": [
        "wipon логотип на чеке",
        "логотип на чеке wipon добавить",
        "wipon чек с логотипом магазина",
        "добавить логотип на чек wipon",
        "wipon печать логотипа на чеке",
    ],
    "features_multi_currency_1097": [
        "wipon несколько валют система только тенге",
        "работа в тенге wipon только",
        "wipon только тенге валюта",
        "в какой валюте wipon тенге",
        "wipon система работает только в тенге",
    ],

    # ==================== EMPLOYEES (4 entries) ====================
    "employees_shift_control_1063": [
        "wipon учёт смен сотрудников контроль",
        "смены кассиров wipon отслеживание",
        "wipon кто когда работал смены",
        "контроль смен wipon сотрудники",
        "wipon смены персонала учёт",
    ],
    "employees_restrict_cashier_1069": [
        "wipon ограничить кассира доступ",
        "кассир видит только свои продажи wipon",
        "wipon запретить кассиру редактировать",
        "ограничения для кассира wipon",
        "wipon кассир ограниченный доступ",
    ],
    "employees_access_levels_1073": [
        "wipon уровни доступа директор бухгалтер кассир",
        "разные права wipon директор кассир",
        "wipon настроить доступ отдельно каждому сотруднику",
        "права по должностям wipon",
        "wipon директор всё видит кассир только кассу",
    ],
    "employees_block_user_1082": [
        "wipon заблокировать сотрудника доступ",
        "уволился сотрудник wipon заблокировать",
        "wipon отключить доступ сотруднику",
        "заблокировать пользователя wipon",
        "wipon блокировка сотрудника",
    ],

    # ==================== INVENTORY (4 entries) ====================
    "inventory_max_items_1059": [
        "wipon сколько товаров максимум",
        "лимит товаров wipon база",
        "wipon максимум позиций в базе",
        "сколько товаров wipon можно добавить",
        "wipon лимит номенклатуры",
    ],
    "inventory_batches_expiry_1062": [
        "wipon партии срок годности учёт",
        "учёт по партиям wipon просрочка",
        "wipon срок годности товаров партии",
        "партионный учёт wipon годность",
        "wipon партии товаров срок годности",
    ],
    "inventory_low_stock_1064": [
        "wipon уведомление минимальный остаток товар",
        "оповещение wipon заканчивается товар",
        "wipon предупреждение когда товар заканчивается",
        "минимальный остаток wipon уведомление",
        "wipon товар заканчивается уведомление",
    ],
    "inventory_serial_imei_1081": [
        "wipon учёт по серийным номерам imei",
        "серийники wipon техника электроника",
        "wipon imei серийный номер учёт",
        "учёт по imei wipon",
        "wipon серийные номера товаров",
    ],

    # ==================== MOBILE (2 entries) ====================
    "mobile_phone_only_1066": [
        "wipon с телефона без компьютера продавать",
        "мобильное приложение wipon вместо компьютера",
        "wipon только телефон работать продажи",
        "wipon ревизия приёмка с телефона",
        "wipon вести программу телефон без пк",
    ],
    "mobile_iphone_ipad_1074": [
        "wipon приложение iphone ipad ios",
        "версия wipon для айфона айпада",
        "wipon ios приложение работает",
        "айфон wipon приложение есть",
        "wipon для iphone ipad",
    ],

    # ==================== FISCAL (2 entries) ====================
    "fiscal_tax_registration_1092": [
        "wipon помогаете оформить кассу налоговый орган офд",
        "регистрация кассы wipon в налоговой офд",
        "wipon помощь регистрация ккм офд",
        "зарегистрировать кассу wipon офд правильно",
        "wipon регистрация кассы налоговая офд",
    ],
    "fiscal_ofd_auto_send_1096": [
        "wipon касса автоматически офд при пробитии",
        "автоматическая передача офд wipon чек",
        "wipon данные в офд автоматом при чеке",
        "офд wipon автоматически при пробитии чека",
        "wipon касса офд автоматом",
    ],

    # ==================== ANALYTICS (2 entries) ====================
    "analytics_top_selling_1093": [
        "wipon отчёт топ продаваемых товаров доля выручке",
        "самые продаваемые товары wipon отчёт",
        "wipon рейтинг продаж товаров топ",
        "какие товары продаются лучше wipon",
        "wipon топ товаров по продажам",
    ],
    "analytics_loss_items_1094": [
        "wipon товары убыток прибыль по каждому",
        "убыточные позиции wipon определить",
        "wipon прибыль по товару убыточные",
        "какие товары невыгодные wipon убыток",
        "wipon убыточные товары определить",
    ],

    # ==================== STABILITY (2 entries) ====================
    "stability_wifi_connection_kz_1050": [
        "wipon wifi арқылы қосылады интернет",
        "wi-fi wipon қолдаймыз тұрақты",
        "wipon интернет арқылы wifi",
        "сымсыз интернет wipon wifi",
        "wipon вайфай арқылы жұмыс",
    ],
    "stability_weak_internet_1084": [
        "wipon слабый интернет офлайн режим",
        "при плохом интернете wipon синхронизация",
        "wipon нестабильный интернет офлайн",
        "медленный интернет wipon работает",
        "wipon офлайн режим данные синхронизируются",
    ],

    # ==================== TIS (2 entries) ====================
    "tis_overview_kz_1053": [
        "тис жүйесі wipon қазақша туралы",
        "тіс үш компонентті wipon интеграцияланған",
        "wipon тис артықшылығы ндс шегі",
        "жеңілдетілген режим тис wipon",
        "тис wipon кәсіпкерлерге арналған",
    ],
    "tis_retail_tax_auto_1086": [
        "wipon розничный налог автоматически считает",
        "программа wipon налоги розничный автомат",
        "wipon расчёт розничного налога автоматически",
        "налоги розничный wipon считаются автоматом",
        "wipon автоматический расчёт розничного налога",
    ],

    # ==================== PROMOTIONS (1 entry) ====================
    "promotions_auto_discount_1057": [
        "wipon касса считает скидки акция автоматически",
        "скидки настроить заранее wipon касса",
        "wipon автоматическая скидка при продаже акция",
        "касса wipon автомат скидки по акции",
        "wipon акции скидки касса автоматом",
    ],
}

def test_section(topic: str, queries: list) -> dict:
    """Тестирует одну секцию с несколькими запросами."""
    results = {"topic": topic, "passed": 0, "failed": 0, "failures": []}

    for query in queries:
        matches = retriever.search(query, top_k=3)
        found = False
        positions = []

        for i, match in enumerate(matches):
            match_topic = match.section.topic if match else 'unknown'
            positions.append(f"{i+1}:{match_topic[:30]}")
            if match_topic == topic:
                found = True
                break

        if found:
            results["passed"] += 1
        else:
            results["failed"] += 1
            results["failures"].append({
                "query": query,
                "got": positions
            })

    return results

def main():
    print("=" * 70)
    print("ТЕСТИРОВАНИЕ СЕКЦИЙ 1000-1100")
    print("=" * 70)

    total_passed = 0
    total_failed = 0
    failed_sections = []

    for topic, queries in TEST_QUERIES.items():
        result = test_section(topic, queries)
        total_passed += result["passed"]
        total_failed += result["failed"]

        if result["failed"] > 0:
            failed_sections.append(result)
            status = f"✗ {topic}: {result['passed']}/{len(queries)} ({result['passed']*100//len(queries)}%)"
            print(status)
            for failure in result["failures"]:
                print(f"   ✗ '{failure['query']}' → {failure['got']}")
        else:
            print(f"✓ {topic}: {len(queries)}/{len(queries)} (100%)")

    total = total_passed + total_failed
    accuracy = total_passed / total * 100 if total > 0 else 0

    print("\n" + "=" * 70)
    print(f"ИТОГО: {total_passed}/{total} ({accuracy:.1f}%)")
    print(f"Секций с ошибками: {len(failed_sections)}")
    print("=" * 70)

    if failed_sections:
        print("\nСЕКЦИИ ТРЕБУЮЩИЕ ДОРАБОТКИ:\n")
        for section in sorted(failed_sections, key=lambda x: x["failed"], reverse=True):
            print(f"{section['topic']} ({section['failed']} ошибок):")
            for failure in section["failures"]:
                print(f"  - {failure['query']}")
            print()

if __name__ == "__main__":
    main()
