"""
Конфигурация: состояния, интенты, база знаний, шаблоны
"""

from src.settings import settings

# =============================================================================
# ИНТЕНТЫ: КОРНИ СЛОВ (быстрая проверка)
# =============================================================================

INTENT_ROOTS = {
    "greeting": [
        # Стандартные приветствия
        "привет", "здравств", "добр", "хай", "приветств", "салют", "хелло", "хэлло",
        # Разговорные варианты
        "прив", "здаров", "здарова", "дарова", "даров", "йо", "хаюшки", "хаю",
        "приветик", "привки", "ку", "здрасьте", "здрасте", "здасте",
        # Формальные
        "доброго", "приветствую",
        # Дополнительные разговорные
        "дратути", "превед", "приф", "прива", "здоров", "хеллоу", "хело",
        "приветос", "приветули", "здравия", "бонжур", "хола",
        # Время суток
        "утречк", "вечерочек", "денечек", "денёчек",
        # Казахские/мусульманские приветствия
        "салам", "ассалам", "салем", "сәлем",
        # Дополнительные варианты с опечатками
        "здраствуй", "здраствуйт", "здравтвуйте", "привте", "привт",
        "приет", "прювет", "хэй", "хей", "хэлоу", "хэллоу", "алоха",
        # Региональные (СНГ)
        "саламалейк", "ассаламу", "шалом", "мархаба", "сайн", "сайн уу",
        # Неформальные/молодёжные
        "хаюш", "здаров братан", "куку", "йоу", "ёу", "эй", "здорова",
        "приветос бандитос", "хеллоу ворлд", "хай пипл",
    ],
    "price_question": [
        # Стандартные
        "цен", "стоим", "стоит", "прайс", "почём", "тариф", "расценк", "ценник",
        "бюджет", "деньг", "рубл", "₽", "руб",
        # Разговорные и опечатки
        "почом", "скока", "скольк", "ценик", "прайслист", "прайс-лист",
        "денюжк", "финанс", "оплат", "платёж", "платеж",
        # Косвенные
        "выйдет", "обойд", "потрат", "влет", "затрат",
        # Дополнительные разговорные
        "чё почём", "чо почем", "ценочка", "ценовая", "прайсик", "тарифчик",
        "скоко", "сколь", "скок", "денежк", "деняг", "бабл", "бабок",
        "за сколько", "какой прайс", "скинь прайс", "скинь цен",
        # Сленг
        "чек", "чеков", "влетит", "влетает", "встанет", "встаёт",
        "потянет", "тянет на", "выливает", "стоимост",
        # Вопросы об условиях
        "подешевле", "дешевле можн", "скидос", "скидон",
        # Дополнительные ценовые варианты
        "тенге", "₸", "тг", "тенгушк", "долларов", "$", "usd", "кзт",
        "прайсец", "ценочк", "сумм", "какая сумма", "общая сумм",
        "калькулятор", "посчитай", "рассчита", "калькуляц",
        "минималк", "минимальн", "максимальн", "средн цен",
        # Вопросы о способах оплаты
        "безнал", "наличк", "картой", "переводом", "счёт", "счет",
        "рассрочк", "кредит", "в долг", "частями", "помесячн",
        # Сравнительные ценовые
        "дороже", "выгодн", "экономн", "бюджетн", "премиум",
    ],
    "objection_price": [
        # Стандартные
        "дорог", "дешевл", "скидк", "бесплатн", "денег нет", "не потянем",
        # Разговорные и сленг
        "дороговат", "недёшев", "недешев", "кусает", "кусач", "по карман",
        "накладн", "неподъём", "неподъемн", "не по карман", "жирно",
        # Сравнения
        "конкурент дешевл", "дешевле есть", "у других дешев",
        # Бюджет
        "нет бюджет", "бюджет не позвол", "финансов не хват", "не выдел",
        "не заложен", "ограничен бюджет", "урезали бюджет",
        # Дополнительные
        "дорга", "дорага", "дешивле", "прайс кусает", "жирноват",
        "перебор", "много хотите", "много просите", "завышен",
        "неоправдан", "не стоит таких", "переплат", "не окуп",
        "не отобь", "экономим", "не тянем", "не вытянем",
        "режем расход", "сокращаем затрат", "оптимизируем бюджет",
        # Дополнительные ценовые возражения
        "неподъёмн", "грабёж", "грабительск", "космическ цен", "заоблачн",
        "астрономическ", "золот", "конск", "негуманн", "нереальн цен",
        "за такие деньги", "таких денег не стоит", "цена завышен",
        "ценник лютый", "ценник конский", "ценник космос",
        # Финансовые трудности
        "кризис", "тяжёлые времена", "сложн период", "финансов труд",
        "касса пустая", "оборотки нет", "выручк упала", "продажи упали",
        "нечем платить", "не из чего", "на хлеб не хватает",
        # Сравнение с ценами
        "у вас дороже", "в два раза дороже", "вдвое дороже", "втрое",
        "нашёл дешевле", "видел за меньше", "предлагали дешевле",
    ],
    "objection_no_time": [
        # Стандартные
        "нет времен", "занят", "не сейчас", "позж", "потом", "перезвон",
        # Разговорные
        "некогда", "завал", "запар", "аврал", "горит", "дедлайн",
        "в другой раз", "на днях", "через недел", "через месяц",
        "не до этого", "голова забит", "руки не доход",
        # Вежливые отказы
        "давайте позж", "может потом", "сейчас не могу", "напишите позж",
        # Дополнительные
        "времени нет", "не успеваю", "загружен", "зашиваюсь", "зашива",
        "конец квартал", "конец год", "конец месяц", "отчётност",
        "после праздник", "после отпуск", "после нового год",
        "сезон", "высокий сезон", "несезон", "пик нагрузк",
        "разгребу дела", "разгребём", "освобожусь", "освободимся",
        "следующий квартал", "в новом году",
        # Дополнительные временные отказы
        "в ближайшее время не получится", "на этой неделе никак",
        "совещания весь день", "митинги", "встречи расписан",
        "командировка", "в поездке", "в отъезде", "в разъездах",
        "проект горит", "релиз", "дедлайны горят", "сдача проекта",
        "инвентаризац", "проверк", "аудит", "ревизия",
        "выходные скоро", "после выходных", "на следующей",
        "давайте в понедельник", "давайте во вторник", "на след недел",
        # Сленг временной
        "щас не до этого", "ща не могу", "не ща", "попозже",
        "как-нибудь потом", "когда-нибудь", "не в это время",
        "времечка нет", "ни минутки", "ни секунды", "загруз полный",
    ],
    "objection_competitor": [
        # CRM-системы
        "битрикс", "амо", "amocrm", "amo crm", "мегаплан", "salesforce",
        "pipedrive", "hubspot", "zoho", "freshsales", "1с:crm", "1c:crm",
        "retailcrm", "envybox", "клиентикс", "простой бизнес",
        # POS/ресторанные системы
        "iiko", "ийко", "айко", "poster", "постер", "r_keeper", "r-keeper",
        "quick resto", "quickresto", "frontpad", "фронтпад",
        # Общие фразы
        "уже есть", "уже пользу", "используем", "работаем в",
        "внедрили", "перешли на", "купили", "подключили",
        # Сравнения
        "у нас своя", "самописн", "написали сам", "своя разработк",
        # Дополнительные CRM
        "террасофт", "terrasoft", "creatio", "s2", "planfix", "планфикс",
        "yclients", "iклиент", "yclients", "мегаплан", "wirecrm",
        "insightly", "monday", "notion", "trello", "asana", "jira",
        # Дополнительные фразы
        "сидим на", "работаем на", "юзаем", "пользуем",
        "устраивает текущ", "менять не хотим", "привыкли", "обучены",
        "вложили деньги", "мигрировать дорого", "переносить данные",
        # Дополнительные CRM и системы
        "kommo", "комо", "коммо", "roistat", "ройстат", "calltouch",
        "carrotquest", "carrot", "chatra", "чатра", "jivosite", "живосайт",
        "usedesk", "юздеск", "omnidesk", "омнидеск", "helpdesk", "хелпдеск",
        "mango office", "mango", "манго офис", "манго", "oktell", "октел",
        # Бухгалтерские/ERP
        "1с бухгалтер", "1с предприят", "1с торговл", "эльба", "контур",
        "сбис", "sbis", "мой склад", "мойсклад", "складской учёт",
        # Дополнительные POS
        "rkeeper", "ркипер", "р-кипер", "атол", "атолл", "эвотор", "evotor",
        "сбербизнес", "sber бизнес", "дримкас", "dreamkas", "модуль касс",
        # Общие возражения о конкурентах
        "всё настроено", "всё налажено", "система работает", "нет смысла менять",
        "перенос будет стоить", "переучив", "переобучат", "обучать заново",
        "только внедрили", "недавно купили", "договор заключ", "контракт",
    ],
    "question_features": [
        # Стандартные
        "функци", "возможност", "умеет", "может", "интеграц", "что делает",
        "как работает", "что включ", "что такое", "что это", "что за",
        "расскажи о", "расскажите о", "расскажи про", "расскажите про",
        # Расширенные
        "фичи", "фича", "опции", "опция", "способн", "позволя",
        "поддержива", "предоставля", "обеспечива", "реализова",
        "есть ли", "можно ли", "поддержка", "функционал",
        # Сравнительные
        "отличи", "преимущ", "выгод", "плюс", "минус", "особенност",
        "чем лучше", "чем хуже", "в чём разниц",
        # Дополнительные
        "расскаж про", "расскажите про", "покажите как",
        "что умеет", "что может", "что позволяет", "на что способ",
        "фишки", "фишка", "киллер фич", "уникальн",
        "автоматизац", "автоматич", "триггер", "сценари",
        "шаблон", "конструктор", "настройк", "кастомизац",
        "гибкость", "масштабиру", "безопасност", "надёжност",
        # Технические вопросы
        "api", "апи", "webhook", "вебхук", "rest", "soap", "json",
        "выгрузка", "импорт", "экспорт", "бэкап", "резервн копи",
        "облачн", "cloud", "saas", "сервер", "хостинг", "локальн",
        "мобильн приложен", "ios", "android", "андроид", "айфон",
        # Вопросы о процессах
        "воронк", "лид", "сделк", "конверсия", "конверси",
        "аналитик", "отчёт", "отчет", "дашборд", "dashboard", "статистик",
        "автодейств", "автоответ", "автоназначен", "распределен",
        # Дополнительные вопросы
        "как устроен", "как организован", "как построен", "архитектур",
        "ограничен", "лимит", "квота", "сколько можно",
        "права доступ", "роли", "ролевая", "разграничен прав",
        "история измен", "логирован", "журнал", "аудит действ",
        "уведомлен", "оповещен", "алерт", "напоминан",
    ],
    "question_integrations": [
        # Стандартные
        "интеграц", "подключ", "связ", "синхрониз", "1с", "телефон", "почт",
        "whatsapp", "telegram", "битрикс24",
        # Kaspi и банки
        "kaspi", "каспи", "каспий", "банк", "банков", "эквайринг",
        # Расширенные сервисы
        "viber", "вотсап", "вацап", "телеграм", "инстаграм", "instagram",
        "вконтакте", "vk", "facebook", "фейсбук", "avito", "авито",
        "юла", "циан", "domclick", "яндекс", "yandex", "google", "гугл",
        # Системы и API
        "api", "апи", "webhook", "вебхук", "zapier", "albato", "make",
        "ip-телефон", "sip", "сип", "asterisk", "манго", "mango",
        "мегафон", "билайн", "мтс", "tele2", "теле2", "ростелеком",
        # Бухгалтерия и учёт
        "1с", "мой склад", "мойсклад", "эльба", "контур", "сбис", "sbis",
        # Дополнительные
        "ватсапп", "воцап", "тг", "телега", "инста", "вк", "фб",
        "озон", "ozon", "wildberries", "вайлдберриз", "wb",
        "amo", "битрикс", "бит24", "б24",
        "comagic", "roistat", "ройстат", "calltouch", "колтач",
        "jivosite", "живосайт", "carrot", "чатра", "chatra",
        "sendpulse", "unisender", "mailchimp", "getresponse",
        "tilda", "тильда", "wordpress", "вордпресс", "битрикс сайт",
        # Дополнительные интеграции
        "халык", "halyk", "халык банк", "каспи gold", "каспи ред",
        "forte", "форте", "jusan", "жусан", "bereke", "береке",
        # Маркетплейсы и доставка
        "kaspi магазин", "каспи магазин", "alibaba", "алибаба",
        "cdek", "сдэк", "boxberry", "боксберри", "почта росси",
        "яндекс доставк", "яндекс маркет", "яндекс еда",
        "glovo", "глово", "wolt", "волт", "bolt", "болт",
        # Телефония расширенная
        "sipuni", "сипуни", "voximplant", "вокимплант", "twilio",
        "телфин", "telfin", "novofon", "новофон", "zadarma", "задарма",
        "onlinepbx", "онлайнпбкс", "gravitel", "гравител",
        # Чат-боты и мессенджеры
        "waba", "вааба", "whatsapp business", "бизнес ватсап",
        "botmother", "ботмазер", "salebot", "сейлбот", "smartbot",
        # Email-сервисы
        "sendsay", "сендсей", "dashamail", "дашамейл", "notisend",
        "mailerlite", "мейлерлайт", "email рассылк", "емейл рассыл",
        # Дополнительные сервисы
        "amo виджет", "bitrix маркет", "1с коннектор", "прямая интеграц",
    ],
    "agreement": [
        # Стандартные
        "интересн", "давайте", "расскажите", "хочу", "готов", "согласен",
        "подходит", "нравится", "да,", "да!", "ок", "хорошо", "годится",
        # Разговорные
        "окей", "ладно", "договорились", "идёт", "идет", "пойдёт", "пойдет",
        "замётано", "заметано", "супер", "класс", "отлично", "круто",
        # Активный интерес
        "покажите", "продемонстрир", "демо", "попробова", "тест", "пробн",
        "запишите", "оформ", "подключ", "начн", "старт",
        # Оставить заявку
        "оставлю заявк", "оставить заявк", "оформить заявк", "подать заявк",
        # Уточняющий интерес
        "поподробн", "подробн", "детальн", "конкретн", "расскаж ещё",
        "а как", "а что", "а можно",
        # Дополнительные
        "океюшки", "лады", "ладушки", "добро", "принято", "понял",
        "го", "погнали", "поехали", "стартуем", "начинаем",
        "в деле", "зайду", "гляну", "посмотрю", "попробую",
        "заинтересов", "заинтриговал", "звучит интересн", "звучит неплох",
        "любопытн", "хочется попробова", "было бы интересн",
        "почему бы и нет", "можно попробова", "давай попробу",
        "запиши", "записывай", "бронируй", "бронирую",
        # Дополнительные позитивные сигналы
        "топ", "огонь", "бомба", "зашибись", "вау", "wow", "кайф", "найс", "nice",
        "классно", "здорово", "прикольно", "интересненько", "норм", "норма",
        "чётко", "четко", "збс", "ништяк", "ок, ок", "ага", "угу", "ммм",
        # Деловое согласие
        "готовы обсудить", "готов рассмотр", "можем обсудить", "давайте обсудим",
        "берём", "берем", "оформляем", "оформляй", "заключаем", "подписыва",
        "выставляйте счёт", "счёт выставляй", "выставь счёт", "пришлите счёт",
        "высылайте договор", "пришлите договор", "оплачиваем", "оплачу",
        # Мягкое согласие
        "почему нет", "не против", "согласен попробова", "можно попробова",
        "попробуем", "рискнём", "рискнем", "а давайте", "а почему бы",
        "склоняюсь", "больше склон", "скорее да", "наверн да",
        # Вопросы как согласие
        "как записаться", "как начать", "как подключиться", "куда платить",
        "какие документы", "что нужно для", "как оформить",
    ],
    "rejection": [
        # Стандартные - FIX: удалены "не интересн", "не нужн", "не хочу", "не буд", "отказ"
        # Они вызывали false positives типа "мне нужна" → rejection
        # Эти случаи теперь корректно обрабатываются priority_patterns в patterns.py
        " не надо", "нет,", "нет!", "отстань", "пока не",
        # Разговорные и резкие
        "отвали", "отвяжи", "достал", "хватит", "прекрат", "стоп",
        "не пиши", "не звони", "заблокир", "в бан", "спам",
        # Вежливые отказы
        "спасибо не надо", "благодарю но", "пожалуй нет", "воздерж",
        "обойдусь", "обойдёмся", "справимся сами", "сами разбер",
        # Скептицизм
        "не верю", "сомнева", "вряд ли", "навряд", "не уверен",
        # Дополнительные
        "неинтересн", "ненужн", "ненадо", "нихачу", "нибуду",
        "без вас обойд", "без вас справ", "пас", "пасс",
        "отписыва", "удали", "убери", "исключи",
        "надоел", "утомил", "замучил", "задолбал",
        "не актуальн", "неактуальн", "не релевантн", "мимо",
        "не наш формат", "не наша тема", "не по адресу",
        # Категоричные отказы
        "никогда", "ни за что", "ни при каких", "категорическ",
        "абсолютн нет", "точно нет", "однозначн нет", "определённо нет",
        "ни в коем случае", "ни в коем", "ни под каким",
        # Грубые отказы (для распознавания)
        "пошёл", "пошли вы", "идите лесом", "идите нафиг", "отвянь",
        "от*бись", "отстаньте", "достали уже", "задолбали",
        "сколько можно", "снова вы", "опять вы", "да сколько раз",
        # Мягкие отказы
        "не сейчас", "не в этот раз", "может быть потом", "возможно позже",
        "пока воздерж", "пока откаж", "на данный момент нет",
        "сейчас не готов", "сейчас не актуальн",
        # Отказ по причине
        "не подходит", "не для нас", "не наше", "не наш профиль",
        "мы не ваша целевая", "не ваш клиент", "не целевая аудитор",
        "закрыт бизнес", "закрываемся", "банкрот", "ликвидац",
        # Технические причины
        "нет компьютер", "нет интернет", "не пользуемся", "работаем офлайн",
    ],
    "contact_provided": [
        # Email
        "@", "mail", "почта", "gmail", "yandex", "inbox", "outlook", "rambler",
        "емейл", "имейл", "мейл", "email", "e-mail",
        # Телефон
        "телефон", "позвон", "номер", "мобильн", "сотов", "трубк",
        "набер", "звякн", "созвон", "ватсап пиши", "в телегу пиши",
        # Дополнительные
        "мой номер", "напишите на", "пишите на", "звоните на",
        "вот контакт", "вот телефон", "вот почта", "скину номер",
        "запиши мой", "запишите мой", "записывай",
        "вотсап", "телеграм", "тг", "телега",
        # Дополнительные контактные данные
        "mail.ru", "bk.ru", "list.ru", "internet.ru", "yahoo", "icloud",
        "protonmail", "hotmail", "live.com", "корпоративн почт",
        # Телефонные форматы
        "+7", "8-", "87", "+77", "7 7", "восем", "плюс сем",
        "городск номер", "рабочий телефон", "личный телефон",
        "директ", "direct", "личк", "лс", "pm", "дм",
        # Мессенджеры расширенные
        "signal", "сигнал", "discord", "дискорд", "skype", "скайп",
        "zoom", "зум", "teams", "тимс", "meet", "мит",
        # Соцсети
        "инста ник", "тг ник", "вк ид", "fb id", "linkedin",
    ],

    # =================================================================
    # SPIN-ИНТЕНТЫ (для методологии SPIN Selling)
    # =================================================================

    # Ответы на S-вопросы (Situation - текущая ситуация)
    "situation_provided": [
        # Размер команды
        "человек", "сотрудн", "команд", "штат", "коллектив", "персонал",
        # Тип бизнеса
        "магазин", "точк", "точек", "ресторан", "кафе", "опт", "розниц",
        "склад", "офис", "салон", "клиник", "агентств", "студия",
        "производств", "завод", "фабрик", "сервис", "служб",
        # Текущие инструменты
        "excel", "эксел", "табли", "1с", "битрикс", "на бумаг", "блокнот",
        "вручную", "руками", "менеджер", "продавц", "в голов",
        "гугл табли", "гугл докс", "notion", "trello",
        # Текущий процесс
        "ведём", "ведем", "используем", "работаем", "пользуемся",
        # Дополнительные типы бизнеса
        "франшиз", "сеть", "филиал", "отделен", "представительств",
        "интернет-магазин", "онлайн-магазин", "маркетплейс", "e-commerce",
        "бар", "пекарн", "столов", "кондитерск", "кофейн", "пиццер",
        "автосервис", "автомойк", "шиномонтаж", "сто",
        "парикмахерск", "барбершоп", "spa", "спа", "массажн", "фитнес",
        "стоматолог", "мед центр", "лаборатор", "аптек",
        # Дополнительные инструменты
        "airtable", "эйртейбл", "smartsheet", "смартшит", "monday", "мандей",
        "asana", "асана", "basecamp", "бейскемп", "clickup", "кликап",
        "тетрадк", "ежедневник", "стикер", "записк", "напоминалк",
        # Размеры и масштаб
        "малый бизнес", "средний бизнес", "крупный бизнес", "микробизнес",
        "стартап", "ип", "ооо", "тоо", "индивидуальн предприниматель",
    ],

    # Ответы на P-вопросы (Problem - выявление проблем)
    "problem_revealed": [
        # Потери и ошибки
        "теря", "упуск", "забыва", "путаниц", "ошибк", "неразберих",
        "не успева", "долго", "много времен", "вручную", "рутин",
        # Отсутствие контроля
        "нет контрол", "не знаю", "не вижу", "не понима", "непонятн",
        "не отслежива", "не фиксир",
        # Проблемы
        "проблем", "сложн", "неудобн", "бардак", "хаос", "беспорядок",
        "головн бол", "боль", "мучает", "надоел", "достал",
        # Негативные последствия
        "уход", "сбега", "недовольн", "жалу", "ругают",
        # Дополнительные проблемы
        "дублир", "дубликат", "повтор", "пересечен", "конфликт",
        "нет единой", "разрозненн", "разбросан", "несогласован",
        "просрочк", "опоздан", "задержк", "срыв срок", "дедлайн проваливаем",
        "текучк", "увольня", "уходят люди", "кадры бегут",
        # Коммуникационные проблемы
        "не доходит", "теряется информац", "не передают", "забыли сказать",
        "каждый по-своему", "нет единых стандарт", "самодеятельност",
        "клиент жалуется", "клиент ругается", "негатив от клиент",
        # Технические проблемы
        "тормозит", "виснет", "падает", "глючит", "баг", "ошибки система",
        "не синхронизир", "данные расход", "потеря данных",
    ],

    # Ответы на I-вопросы (Implication - осознание последствий)
    "implication_acknowledged": [
        # Количественные потери
        "потер", "убытк", "недополуч", "упущен", "стоит", "обходит",
        "тысяч", "миллион", "рубл", "тенге", "процент", "клиент уход",
        # Временные затраты
        "час", "день", "недел", "тратим", "уходит", "занимает",
        # Признание серьёзности
        "критичн", "серьёзн", "важн", "да, это", "согласен", "верно",
        "да уж", "к сожалению", "увы", "к сожелению", "точно",
        "примерно", "около", "наверное", "где-то",
    ],

    # Ответы на N-вопросы (Need-Payoff - ценность решения)
    "need_expressed": [
        # Желания
        "хоте", "нуж", "надо", "было бы", "если бы", "идеальн",
        # Решения
        "автоматиз", "контрол", "видеть", "понима", "экономить", "сберечь",
        "упрост", "ускор", "наладить", "систематиз", "организ",
        # Признание ценности
        "помогло бы", "решило бы", "избавило", "спасло",
        "было бы отлично", "было бы супер", "было бы здорово",
        "да, это", "конечно", "естественно", "определённо",
    ],

    # Отрицание проблемы (ответ на P-вопросы)
    "no_problem": [
        # Прямое отрицание проблемы
        "нет проблем", "проблем нет", "всё хорошо", "все хорошо",
        "всё нормально", "все нормально", "нас устраивает", "нас всё устраивает",
        "справляемся", "справляемся сами", "у нас всё ок", "у нас все ок",
        "у нас нет таких", "с этим всё в порядке", "с этим все в порядке",
        "всё работает", "все работает", "не жалуемся", "нет такого",
        "это не про нас", "у нас иначе", "нам это не грозит",
        "нет никаких", "ничего подобного", "таких нет",
        # Косвенное отрицание
        "нет не теряем", "нет не забыва", "нет всё фиксиру", "нет контролиру",
        "с этим порядок", "тут всё ок", "тут все ок", "здесь норм",
    ],

    # Отрицание потребности (ответ на N-вопросы)
    "no_need": [
        # Прямое отрицание потребности
        "не нужно", "нам не нужно", "нам это не нужно", "не надо",
        "нам не надо", "не требуется", "нам не требуется",
        "обойдёмся", "обойдемся", "обходимся", "обойдусь",
        "и так справляемся", "и так справимся", "справимся сами",
        "пока не нужно", "сейчас не нужно", "в этом нет необходимости",
        "без этого обойдёмся", "без этого обойдемся", "без этого проживём",
        "нет необходимости", "не видим необходимости", "не вижу смысла",
        "нам это ни к чему", "это лишнее", "не актуально",
        # Косвенное отрицание
        "текущего хватает", "хватает того что есть", "нас устраивает как есть",
        "менять не хотим", "ничего менять не надо", "оставим как есть",
    ],

    # =================================================================
    # НОВЫЕ ИНТЕНТЫ (добавлены для полноты классификации)
    # =================================================================

    # Запрос обратного звонка
    "callback_request": [
        "перезвон", "позвон", "свяжи", "связаться", "набери", "наберите",
        "жду звонк", "ожидаю звонк", "вот номер", "вот телефон", "вот контакт",
        "запиши номер", "запишите номер", "мой телефон", "мой номер",
        "созвонимся", "созвониться", "пообщаться", "поговорить",
        "на связи", "выйти на связь", "контакт для связи",
        # Дополнительные
        "брось звоночек", "кинь звонок", "стукни", "черкани",
        "напиши в ватсап", "напиши в телегу", "кинь в тг",
        "пинганите", "тукните", "тыкните", "постучитесь",
        "когда удобно позвонить", "во сколько звонить", "в какое время",
        "утром позвоните", "вечером позвоните", "после обеда",
        "завтра перезвоните", "в понедельник", "на неделе",
    ],

    # Запрос демо
    "demo_request": [
        "демо", "демонстрац", "показать", "покажите", "попробова", "потестир",
        "тестов", "пробн", "триал", "trial", "бесплатн период", "бесплатн доступ",
        "посмотреть как работает", "в действии", "на примере", "живой пример",
        "тест драйв", "тест-драйв", "ознакомительн", "презентац",
        # Дополнительные
        "freemium", "фримиум", "free trial", "фри триал", "пилот", "пилотн",
        "poc", "proof of concept", "пруф оф концепт", "демка", "демоверсия",
        "тестовый аккаунт", "тестовая учётк", "песочниц", "sandbox",
        "покрутить", "пощупать", "поюзать", "потыкать", "поклацать",
        "хочу глянуть", "хочу посмотреть", "хочу увидеть", "покажи",
        "устроить демо", "назначить демо", "забукать демо", "забронировать демо",
        "онлайн показ", "вебинар", "скринкаст", "screen share", "шаринг экрана",
    ],

    # Запрос консультации
    "consultation_request": [
        "консультац", "проконсультир", "совет", "посовет", "порекоменд",
        "помогите разобрат", "помогите понять", "помогите выбрать",
        "вопрос по", "вопросы о", "хотел бы обсудить", "хотел бы поговорить",
        "нужна помощь", "нужен совет", "что посоветуете",
        # Дополнительные
        "подсказать", "подскажите", "объясните", "объясни", "расскажите",
        "разъясните", "проясните", "уточните", "расшифруйте",
        "не понимаю как", "не могу разобраться", "запутался",
        "поясните простым", "на пальцах", "для чайников",
        "нужен эксперт", "поговорить со специалист", "менеджер нужен",
        "хочу узнать подробнее", "хочу разобраться", "хочу понять",
    ],

    # Сравнение с конкурентами
    "comparison": [
        "сравн", "разниц", "отличи", "отличает", "лучше чем", "хуже чем",
        "преимущ", "плюс", "минус", "vs", "против", "или", "вместо",
        "почему вас", "почему вы", "чего нет у", "что есть у вас",
        "по сравнению", "относительно",
        # Дополнительные
        "аналог", "альтернатив", "конкурент", "похож на",
        "чем круче", "чем лучше", "чем отличается", "в чём разница",
        "что выбрать", "что взять", "что лучше", "что хуже",
        "табличка сравнен", "матрица сравнен", "сравнительная таблиц",
        "battle", "батл", "versus", "версус",
    ],

    # Детали по цене
    "pricing_details": [
        "что входит", "из чего состоит", "складывается цена", "состав тариф",
        "прайс-лист", "прайслист", "расчёт", "расчет", "калькуляц",
        "скидк", "акци", "минимальн пакет", "базов тариф",
        "за пользователя", "за рабочее место", "за лицензию",
        "помесячн", "ежемесячн", "годов оплат", "разов оплат",
        "рассрочк", "отсрочк", "условия оплат", "способы оплат",
        # Дополнительные
        "тарифная сетк", "линейка тариф", "пакетные предложен",
        "enterprise", "энтерпрайз", "корпоративн тариф", "premium", "pro",
        "стандарт", "бизнес", "старт", "лайт", "free", "фри", "бесплатн",
        "дополнительн опции", "платные модули", "надбавки", "доплаты",
        "внедрение", "настройка", "обучение", "сопровождение", "поддержка",
        "скрытые плат", "комиссия", "абонентская", "единоразов",
        "возврат средств", "гарантия возврат", "money back",
    ],

    # Возражение "надо подумать"
    "objection_think": [
        "подумать", "посовещ", "обсудить", "согласов", "посоветов",
        "с руководств", "с начальств", "с директор",
        "не в моей компетенц", "не я решаю", "решение принима",
        "дайте время", "нужно время", "раздумать", "обдумать",
        "не готов", "не готовы", "перезвоню сам", "вернусь",
        "пока не могу", "пока не готов",
        # Дополнительные
        "спрошу у шефа", "уточню у директор", "согласую с собственник",
        "посоветуюсь с партнёр", "покажу коллег", "обсужу с командой",
        "это не моё решен", "выше моего уровня", "не уполномоч",
        "взвесить все за и против", "сравнить вариант", "подумать на холодн голов",
        "переспать с мыслью", "переварить информац", "осмыслить",
        "пока рано решать", "ещё не созрел", "нужно дозреть",
    ],

    # Прощание
    "farewell": [
        "до свидания", "до связи", "до встречи", "пока", "всего доброго",
        "всего хорошего", "удачи", "хорошего дня", "хорошего вечера",
        "спасибо пока", "благодарю пока", "бай", "бб", "покедова",
        "чао", "адьёс", "на сегодня всё", "на этом всё",
        # Дополнительные
        "досвидос", "бывай", "бываем", "давай", "ну давай",
        "созвонимся", "ещё спишемся", "на связи", "будем на связи",
        "хорошего продолжения", "успехов", "удачного дня", "отличного дня",
        "приятного вечера", "спокойной ночи", "добрых снов",
        "ариведерчи", "гудбай", "goodbye", "bye", "see you", "сиюу",
    ],

    # Благодарность
    "gratitude": [
        "спасибо", "благодарю", "спс", "пасибо", "благодарн", "признателен",
        "большое спасибо", "огромное спасибо", "спасибо за", "благодарю за",
        "очень благодарен", "очень признателен",
        # Дополнительные
        "сенкс", "thanks", "thx", "thank you", "респект", "respect",
        "премного благодар", "искренне благодар", "от души",
        "благодарочка", "спасибочки", "спасибки", "благодарствую",
        "оценил помощь", "выручили", "помогли", "спасли",
    ],

    # Болтовня/Small talk
    "small_talk": [
        "как дела", "как жизнь", "как настроение", "как сам", "как сама",
        "что нового", "что новенького", "как выходные", "как праздники",
        "какая погода", "хорошая погода",
        # Дополнительные
        "как оно", "как ты", "как вы там", "чё как", "шо нового",
        "норм дела", "как поживаете", "как идут дела", "как бизнес",
        "как настрой", "как боевой дух", "как моральный дух",
        "ну что там", "ну как", "давно не общались", "сто лет не виделись",
    ],

    # Неясно/Уточнение
    "unclear": [
        "что", "ась", "чего", "не понял", "не понятно", "что это",
        "повторите", "ещё раз", "не расслышал", "переформулир",
        "можно подробнее", "что имеете в виду",
        # Дополнительные
        "чёё", "чоо", "шо", "шта", "а?", "э?", "хм", "ммм",
        "не уловил", "не догнал", "не врубился", "не дошло",
        "объясните ещё раз", "можно повторить", "перефразируй",
        "слишком сложно", "простыми словами", "на пальцах объясни",
        "чего-чего", "как-как", "в смысле", "то есть",
    ],

    # =================================================================
    # PHASE 3: Circular Flow (возврат назад по фазам)
    # =================================================================

    "go_back": [
        # Прямые запросы на возврат
        "вернуться", "назад", "подожди", "стоп", "погоди",
        "давай вернёмся", "давай вернемся", "хочу вернуться",
        "вернись", "вернитесь", "можно назад",
        # Остановка
        "подождите", "минутку", "секунду", "постой",
        "притормози", "давай помедленнее", "не так быстро",
    ],
    "correct_info": [
        # Исправление информации
        "я ошибся", "я неправильно", "не так сказал", "уточню",
        "на самом деле", "точнее", "уточняю", "исправляюсь",
        "не совсем так", "я имел в виду", "правильнее будет",
        "я неверно", "я неточно", "перепутал", "ошибка",
        # Переосмысление
        "погодите", "стоп", "нет подождите", "не то сказал",
        "давайте заново", "давай заново", "с начала",
    ],

    # =================================================================
    # ДОПОЛНИТЕЛЬНЫЕ ВОЗРАЖЕНИЯ (Phase 4 coverage)
    # =================================================================

    "objection_complexity": [
        # Сложность внедрения
        "сложно", "сложност", "непрост", "трудно", "труднос",
        "внедрен", "внедрят", "настройк", "настраива",
        # Переход и миграция
        "переход", "мигрир", "миграц", "перенос", "переносить",
        # Обучение
        "переучи", "обучени", "обучать", "учить заново",
        # Ресурсы
        "ресурсов нет", "нет ресурс", "много работ", "много возн",
        # Страхи
        "сломает", "пугает", "боюсь", "страшно", "риск",
        # Сопротивление
        "сопротивля", "не захот", "будут против", "не примут",
        # Время на внедрение
        "займёт", "займет", "потребует", "долго настра",
        # Дополнительные
        "болезнен", "геморрой", "головняк", "морок", "канитель",
        "заморочк", "запар", "сложняк", "непросто",
    ],

    "objection_trust": [
        # Недоверие
        "не уверен", "не верю", "не доверя", "сомнева", "сомнен",
        # Доказательства
        "гарант", "доказательств", "подтверд", "подтвержден",
        # Отзывы и кейсы
        "отзыв", "референс", "кейс", "пример клиент", "кто пользу",
        # Скептицизм
        "слишком хорош", "звучит красиво", "обещани", "обеща",
        "обманете", "обман", "развод", "разводк", "лохотрон",
        # Проверка
        "проверить", "убедиться", "удостовериться",
        # Риски
        "а если не", "что если", "вдруг не",
        # Репутация
        "репутац", "надёжн", "надежн", "стабильн", "давно на рынк",
    ],

    "objection_timing": [
        # Отложить
        "не сейчас", "позже", "потом", "после", "через",
        "в следующ", "на следующ", "в будущ",
        # Конкретные сроки
        "после нового год", "после праздник", "после отпуск",
        "в январ", "в феврал", "весн", "осен", "летом", "зимой",
        "через месяц", "через недел", "через полгод", "через год",
        "в конце год", "в начале год", "в следующем квартал",
        # Привязка к событиям
        "после проект", "после релиз", "после закрыт", "после сдач",
        "когда бюджет", "когда утверд", "когда согласу",
        # Неопределённые сроки
        "когда-нибудь", "как-нибудь", "рано ещё", "рано еще",
        "пока рано", "не время", "несвоеврем",
        # Напоминания
        "напомните", "напишите позже", "перезвоните потом",
    ],

    "objection_no_need": [
        # Прямой отказ
        "не нужно", "не надо", "не требует", "не нужна",
        "ненужно", "ненадо",
        # Справляемся сами
        "справляемся", "справимся", "обойдёмся", "обойдемся",
        "обходимся", "хватает", "достаточно",
        # Нет проблемы
        "нет проблем", "проблем нет", "всё работает", "все работает",
        "и так норм", "и так хорош", "устраива",
        # Альтернативы
        "excel", "эксел", "блокнот", "тетрадк", "таблиц",
        "своими силами", "вручную", "по старинк",
        # Размер бизнеса
        "маленьк", "небольш", "мало клиент", "мало заказ",
        # Отсутствие смысла
        "не вижу смысл", "зачем нам", "для чего", "лишн",
        "трата ресурс", "трата времен", "трата денег",
    ],

    "info_provided": [
        # Тип бизнеса
        "занимаемся", "работаем в", "наша сфера", "наш бизнес",
        "продаём", "продаем", "производим", "оказыва услуг",
        # Размер
        "человек", "сотрудник", "менеджер", "продавец", "оператор",
        "точек", "филиал", "офис", "магазин", "ресторан",
        # Клиенты
        "клиент", "заказчик", "покупател", "b2b", "b2c", "корпоратив",
        # Обороты
        "оборот", "выручк", "средний чек", "в месяц", "в год",
        # Каналы
        "сайт", "инстаграм", "маркетплейс", "авито", "звонк",
    ],

    # =================================================================
    # НОВЫЕ ВОПРОСЫ О ПРОДУКТЕ (12 интентов)
    # =================================================================

    "question_security": [
        # Безопасность данных
        "безопасност", "защит", "шифрован", "шифруем", "криптограф",
        "gdpr", "персональн данн", "пдн", "152-фз", "фз-152",
        # Доступ и авторизация
        "двухфакторн", "2fa", "авторизац", "аутентификац", "права доступ",
        "парол", "сертификат", "ssl", "https", "tls",
        # Хранение
        "где хранятся данные", "серверы где", "дата центр", "датацентр",
        "резервн копи", "бэкап", "backup", "восстановлен",
        # Угрозы
        "взлом", "хакер", "утечк", "уязвимост", "пентест",
        "аудит безопасност", "iso 27001", "соответстви", "комплаенс",
        # Конфиденциальность
        "конфиденциальн", "nda", "неразглашен", "приватност",
    ],

    "question_support": [
        # Каналы поддержки
        "техподдержк", "тех поддержк", "саппорт", "support", "помощь",
        "поддержк", "хелпдеск", "helpdesk", "служба поддержк",
        # Время работы
        "круглосуточн", "24/7", "24 на 7", "время работы поддержк",
        "в выходные", "по праздникам", "нерабочее время",
        # Скорость
        "время ответа", "как быстро отвечают", "скорость реакц",
        "сколько ждать", "время реагирован",
        # Способы связи
        "чат поддержк", "телефон поддержк", "email поддержк",
        "тикет систем", "написать в поддержк", "позвонить в поддержк",
        # Качество
        "выделенный менеджер", "персональн менеджер", "аккаунт менеджер",
        "русскоязычн поддержк", "на русском",
    ],

    "question_implementation": [
        # Процесс
        "внедрен", "внедрят", "как проходит внедрен", "этапы внедрен",
        "процесс внедрен", "план внедрен", "дорожн карт",
        # Сроки
        "сколько занимает внедрен", "срок внедрен", "как быстро внедр",
        "за сколько внедр", "длительность внедрен",
        # Участники
        "кто внедряет", "нужен ли специалист", "ваши специалист",
        "самостоятельн внедр", "нужна помощь для внедр",
        # Подготовка
        "что нужно для внедрен", "подготовка к внедрен", "требования",
        "предварительн работ", "аудит перед внедр",
        # Риски
        "простой при внедрен", "без остановки работ", "параллельн работ",
    ],

    "question_training": [
        # Обучение
        "обучен", "обуча", "курс", "тренинг", "вебинар",
        "как научить", "как обучить", "обучат сотрудник",
        # Материалы
        "документац", "инструкц", "руководств", "мануал", "гайд",
        "видеоурок", "видео инструкц", "туториал", "tutorial",
        # База знаний
        "база знаний", "faq", "чаво", "справк", "хелп", "help",
        "подсказк", "онбординг", "onboarding",
        # Сертификация
        "сертификац", "сертификат", "экзамен", "тест знан",
        # Формат
        "онлайн обучен", "очное обучен", "дистанционн", "самостоятельн",
        "групповое обучен", "индивидуальн обучен",
    ],

    "question_updates": [
        # Частота
        "обновлен", "апдейт", "update", "новые версии", "релиз",
        "как часто обновля", "частота обновлен",
        # Процесс
        "автоматическ обновлен", "ручное обновлен", "нужно ли обновля",
        "обновляется само", "обновление без простоя",
        # Новые функции
        "новые функц", "дорожн карт", "roadmap", "роадмап",
        "что планируется", "будущие функц", "развитие продукт",
        # Совместимость
        "обратная совместимост", "ломают ли обновлен", "миграц при обновлен",
        # История
        "changelog", "история изменен", "что нового", "release notes",
    ],

    "question_mobile": [
        # Приложение
        "мобильн приложен", "приложен", "app", "аппка",
        "есть ли приложен", "мобильн версия",
        # Платформы
        "ios", "айос", "iphone", "айфон", "ipad", "айпад",
        "android", "андроид", "гугл плей", "google play", "app store",
        # Функционал
        "что можно в приложен", "функции приложен", "полн функционал",
        "офлайн в приложен", "синхронизац приложен",
        # Уведомления
        "push уведомлен", "пуш", "уведомлен на телефон", "мобильн уведомлен",
    ],

    "question_offline": [
        # Офлайн работа
        "офлайн", "offline", "без интернет", "без сети",
        "автономн", "локальн работ", "локально",
        # Синхронизация
        "синхронизац", "синк", "sync", "когда появится интернет",
        "данные сохран", "не потеряются данные",
        # Сценарии
        "если пропадёт интернет", "перебои с интернет", "нестабильн интернет",
        "в поле", "на выезде", "в командировк",
    ],

    "question_data_migration": [
        # Миграция
        "миграц", "перенос данн", "импорт данн", "загруз данн",
        "перенести из", "импортировать из", "выгрузить из",
        # Источники
        "из excel", "из эксел", "из 1с", "из битрикс", "из амо",
        "из другой crm", "из старой систем", "из таблиц",
        # Процесс
        "как перенести", "сколько занимает перенос", "кто переносит",
        "помогаете с переносом", "миграц данных бесплатн",
        # Форматы
        "csv", "xlsx", "json", "xml", "api для миграц",
        # Качество
        "потеря данных при перенос", "дубликаты", "очистка данных",
    ],

    "question_customization": [
        # Настройка
        "настройк", "кастомизац", "customization", "кастомиз",
        "можно настро", "гибкость настро",
        # Поля
        "свои поля", "кастомн поля", "дополнительн поля", "создать поле",
        "типы полей", "справочник", "словар",
        # Процессы
        "свои процесс", "бизнес процесс", "воронк", "этап",
        "свои статус", "свои этап", "workflow",
        # Интерфейс
        "изменить интерфейс", "своя тема", "брендирован", "white label",
        "логотип", "цветовая схем",
        # Отчёты
        "свои отчёт", "кастомн отчёт", "конструктор отчёт",
    ],

    "question_reports": [
        # Отчёты
        "отчёт", "отчет", "report", "репорт", "аналитик",
        "какие отчёт", "виды отчёт", "типы отчёт",
        # Дашборды
        "дашборд", "dashboard", "панель", "графики", "диаграмм",
        "визуализац", "виджет",
        # Метрики
        "kpi", "метрик", "показател", "конверси", "воронк продаж",
        "средний чек", "выручк", "план факт",
        # Выгрузка
        "выгрузк", "экспорт", "excel отчёт", "pdf отчёт",
        "автоматическ отчёт", "по расписан", "на почту отчёт",
        # Глубина
        "история данных", "за какой период", "ретроспектив",
    ],

    "question_automation": [
        # Автоматизация
        "автоматизац", "автомат", "автоматическ",
        "автодействи", "авторассылк", "автозадач",
        # Триггеры
        "триггер", "trigger", "условия", "событи",
        "если то", "when then", "при наступлен",
        # Действия
        "автоматическ письм", "автоматическ смс", "автозвон",
        "автоназначен", "автораспределен", "авторотац",
        # Сценарии
        "сценарий автоматизац", "бот", "робот", "автопилот",
        "без участия человек", "рутинн задач",
        # Примеры
        "какие можно автоматизир", "примеры автоматизац",
    ],

    "question_scalability": [
        # Масштабируемость
        "масштабиру", "масштаб", "scalab", "скейл",
        "на сколько пользовател", "сколько пользовател поддержива",
        # Рост
        "при росте", "если вырастем", "при увеличен",
        "100 пользовател", "1000 пользовател", "10000",
        # Производительность
        "производительност", "скорость при больш", "нагрузк",
        "высокая нагрузк", "много данных", "большой объём",
        # Архитектура
        "горизонтальн масштаб", "вертикальн масштаб",
        "кластер", "балансировк", "распределён",
        # Тарифы
        "тариф при росте", "цена при увеличен", "оптовые скидк",
    ],

    # =================================================================
    # НОВЫЕ ВОЗРАЖЕНИЯ (10 интентов)
    # =================================================================

    "objection_risk": [
        # Страхи
        "риск", "рискован", "страшн", "боюсь", "опасаюсь",
        "а вдруг", "а если не", "что если",
        # Неопределённость
        "неизвестн", "непредсказуем", "непонятн чем закончит",
        "не уверен что получит", "нет гарантий",
        # Последствия
        "потеряем данные", "сломается", "перестанет работать",
        "откатить назад", "вернуть как было",
        # Опыт других
        "слышал что проблем", "читал негатив", "знакомые жаловал",
    ],

    "objection_team_resistance": [
        # Сопротивление
        "сотрудники против", "команда против", "люди не захотят",
        "коллектив не примет", "персонал откажет",
        # Привычки
        "привыкли к старому", "не хотят менять", "сопротивляются",
        "саботаж", "саботиру", "бойкот",
        # Обучение
        "не научатся", "не освоят", "сложно для сотрудник",
        "возрастные сотрудник", "не технически грамотн",
        # Мотивация
        "зачем им это", "им это не нужно", "не видят смысла",
        "не понимают зачем",
    ],

    "objection_security": [
        # Недоверие к облаку
        "не доверяю облак", "облако небезопасн", "только локальн",
        "on-premise", "на своих сервер", "у себя хранить",
        # Утечки
        "данные утекут", "украдут данные", "взломают", "хакнут",
        "сольют базу", "продадут данные",
        # Конкуренты
        "конкуренты узнают", "коммерческ тайн", "секретн информац",
        # Регуляторы
        "регулятор не одобрит", "проверки", "штрафы",
        "не соответствует требован",
    ],

    "objection_bad_experience": [
        # Прошлый опыт
        "уже пробовали", "уже внедряли", "был опыт",
        "обожглись", "наелись", "нахлебались",
        # Негативные результаты
        "не зашло", "не прижилось", "не использовали",
        "пылится", "деньги на ветер", "выбросили деньги",
        # Конкретные проблемы
        "глючил", "тормозил", "падал", "баги",
        "поддержка не помогала", "забросили",
        # Скептицизм
        "все crm одинаков", "везде одно и то же", "не верю в crm",
    ],

    "objection_priority": [
        # Другие задачи
        "другие приоритет", "есть важнее", "не в приоритет",
        "сейчас не до crm", "не до этого",
        # Проекты
        "другой проект", "заняты другим", "параллельно не можем",
        "ресурсы на другое", "фокус на другом",
        # Отложить
        "потом вернёмся", "позже рассмотрим", "в следующем году",
        "когда закончим текущ", "после текущего проект",
    ],

    "objection_scale": [
        # Слишком маленькие
        "мы слишком маленьк", "нас мало", "маленькая компания",
        "для нас избыточн", "слишком мощн для нас",
        # Слишком большие
        "мы слишком больш", "enterprise нужен", "корпоративн решен",
        "не для нашего масштаб",
        # Несоответствие
        "не наш размер", "не подходит по масштаб",
        "для другого сегмент", "не наш сегмент",
    ],

    "objection_change_management": [
        # Процессы
        "менять процесс", "перестраивать", "ломать",
        "работающую систем не трогай", "не чини то что работает",
        # Документация
        "переписывать регламент", "менять инструкц",
        "адаптировать процесс",
        # Организация
        "реорганизац", "трансформац", "изменения в компан",
        "не готовы к изменен",
    ],

    "objection_contract_bound": [
        # Контракт
        "контракт до", "договор до", "связаны контракт",
        "обязательства по договор", "условия контракт",
        # Сроки
        "до конца года", "ещё полгода", "ещё год",
        "расторгнуть дорого", "штраф за расторжен",
        # Лицензии
        "оплачена лицензия", "подписка до", "предоплата",
    ],

    "objection_company_policy": [
        # Политика
        "политика компан", "корпоративн правила", "регламент",
        "у нас запрещен", "не разреша",
        # Руководство
        "руководство против", "директор против", "начальство не одобр",
        "не моё решен", "выше моей компетенц",
        # Процедуры
        "согласован", "тендер", "закупочн процедур",
        "конкурс", "только через тендер",
        # IT-политика
        "it-отдел против", "безопасники против", "не в реестре поставщик",
    ],

    "objection_roi_doubt": [
        # ROI
        "не окупится", "не отобьёт", "деньги на ветер",
        "инвестиции не вернут", "пустая трата",
        # Сомнения
        "не верю в roi", "сомневаюсь в окупаемост",
        "а точно окупится", "где гарантии окупаемост",
        # Расчёты
        "покажите расчёт", "как посчитали roi", "откуда цифры",
        "на чём основан", "реальные ли цифры",
        # Примеры
        "у кого окупилось", "реальные примеры окупаемост",
    ],

    # =================================================================
    # ПОЗИТИВНЫЕ СИГНАЛЫ (8 интентов)
    # =================================================================

    "ready_to_buy": [
        # Готовность
        "готов купить", "готовы покупать", "берём", "берем",
        "оформляем", "давайте оформ", "хочу купить",
        # Решение
        "решили брать", "решение принят", "выбор сделан",
        "остановились на вас", "выбрали вас",
        # Действия
        "давайте начинать", "приступаем", "стартуем",
        "когда можно начать", "как быстро подключ",
        # Деньги
        "готовы платить", "деньги есть", "оплачиваем",
    ],

    "budget_approved": [
        # Бюджет
        "бюджет есть", "бюджет выделен", "бюджет согласован",
        "деньги выделили", "финансирование есть",
        # Согласование
        "бюджет утверждён", "руководство одобрило бюджет",
        "финдиректор подписал", "cfo одобрил",
        # Сумма
        "бюджет на это", "заложили в бюджет", "запланировали расходы",
        "в бюджете предусмотрен",
    ],

    "decision_maker_identified": [
        # Полномочия
        "я принимаю решен", "решение за мной", "я решаю",
        "в моей компетенц", "я уполномочен",
        # Должность
        "я директор", "я владелец", "я собственник",
        "я руководитель", "я ceo", "я генеральн",
        # Прямой доступ
        "решаю без согласован", "не надо ни с кем согласов",
        "единолично решаю",
    ],

    "urgency_expressed": [
        # Срочность
        "срочно", "urgentно", "горит", "вчера надо было",
        "как можно скорее", "asap", "немедленно",
        # Дедлайны
        "дедлайн", "до конца недели", "до конца месяца",
        "нужно успеть", "сроки поджимают",
        # Причины
        "клиенты ждут", "проект запускается", "открытие скоро",
        "потеряем клиент если", "упустим возможность",
    ],

    "competitor_dissatisfied": [
        # Недовольство
        "надоел", "достал", "устали от", "замучил",
        "не устраивает текущ", "текущая система не справля",
        # Проблемы
        "глючит постоянно", "тормозит", "падает",
        "поддержка не отвечает", "забили на нас",
        # Желание сменить
        "хотим сменить", "ищем замену", "присматриваем альтернатив",
        "пора менять", "переезжаем с",
        # Сравнение
        "у вас лучше чем", "вы лучше чем наш текущ",
    ],

    "expansion_planned": [
        # Рост
        "расширяемся", "растём", "увеличиваемся",
        "открываем филиал", "открываем офис", "новая точка",
        # Масштаб
        "нанимаем людей", "увеличиваем штат", "растёт команда",
        "больше клиентов", "растёт клиентская база",
        # Планы
        "планируем рост", "стратегия роста", "масштабирован",
        "выход на новые рынки", "новые регионы",
    ],

    "positive_feedback": [
        # Впечатления
        "нравится", "впечатля", "круто выглядит", "классно",
        "удобн интерфейс", "понятн интерфейс",
        # Демо
        "хорошее демо", "демо понравил", "увидел что нужно",
        "это то что искали",
        # Функции
        "функции впечатляют", "много полезного", "всё что нужно есть",
        "даже больше чем ожидал",
        # Эмоции
        "вау", "wow", "супер", "отлично", "здорово",
    ],

    "internal_champion": [
        # Продвижение
        "буду продвигать", "порекоменду", "расскажу коллегам",
        "покажу руководству", "покажу директору",
        # Поддержка
        "буду защищать", "буду за вас", "поддержу инициатив",
        "буду адвокат",
        # Действия
        "организую встречу", "соберу людей", "презентую команде",
        "подготовлю аргументы",
    ],

    # =================================================================
    # ЭТАПЫ ПОКУПКИ (8 интентов)
    # =================================================================

    "request_proposal": [
        # КП
        "кп", "коммерческ предложен", "предложение",
        "пришлите кп", "скиньте кп", "вышлите предложен",
        # Детали
        "подробное предложен", "индивидуальн предложен",
        "персональн предложен", "под нас кп",
        # Формат
        "на почту кп", "pdf предложен", "презентац предложен",
    ],

    "request_contract": [
        # Договор
        "договор", "контракт", "соглашен",
        "пришлите договор", "шаблон договор", "проект договор",
        # Условия
        "условия договор", "пункты договор", "что в договор",
        "типовой договор", "стандартн договор",
        # Юристы
        "юристам на проверк", "согласовать с юрист",
        "правовая экспертиз",
    ],

    "request_invoice": [
        # Счёт
        "счёт", "счет", "invoice", "инвойс",
        "выставьте счёт", "пришлите счёт", "скиньте счёт",
        # Реквизиты
        "реквизиты для оплат", "ваши реквизит", "куда платить",
        "банковские реквизит",
        # Формат
        "счёт на оплату", "счёт-факт", "акт", "закрывающ документ",
    ],

    "request_discount": [
        # Скидка
        "скидк", "дисконт", "discount",
        "можно скидк", "есть скидк", "дайте скидк",
        # Условия
        "скидка за объём", "скидка за год", "оптовая скидк",
        "скидка на старт", "скидка новым клиент",
        # Торг
        "можно дешевле", "уступите в цене", "подвинетесь по цене",
        "сделайте скидк", "какие скидк есть",
    ],

    "negotiate_terms": [
        # Переговоры
        "обсудить условия", "договориться", "гибкие услов",
        "можно изменить условия", "индивидуальн условия",
        # Детали
        "по пунктам пройтись", "детали обсудить",
        "нюансы уточнить", "частности обговорить",
        # Компромисс
        "найти компромисс", "пойти навстречу", "встречн предложен",
    ],

    "request_trial_extension": [
        # Продление
        "продлить триал", "продлить тест", "продлить пробн",
        "ещё время на тест", "дополнительн время",
        # Причины
        "не успели оценить", "не хватило времен", "нужно больше времен",
        "ещё не все протестировал", "хочу ещё попробовать",
        # Условия
        "можно продлить", "сколько стоит продлен", "бесплатно продл",
    ],

    "request_references": [
        # Референсы
        "референс", "отзыв клиент", "рекомендац",
        "кто пользуется", "ваши клиент", "список клиент",
        # Контакты
        "можно поговорить с клиент", "дайте контакт клиент",
        "связаться с вашим клиент",
        # Отзывы
        "где почитать отзыв", "что пишут о вас", "рейтинг",
        "на каких сайтах отзыв",
    ],

    "request_sla": [
        # SLA
        "sla", "соглашен об уровне сервис", "уровень сервис",
        "гарантии сервис", "service level agreement",
        # Метрики
        "uptime", "аптайм", "доступност", "99.9",
        "время реакц", "время решен", "mttr", "mttf",
        # Компенсации
        "компенсац за простой", "штрафы за нарушен sla",
        "что если не выполн",
        # Документ
        "sla документ", "покажите sla", "какие гарантии",
    ],

    # =================================================================
    # ВОПРОСЫ О КОМПАНИИ (4 интента)
    # =================================================================

    "company_info_question": [
        # О компании
        "кто вы", "что за компания", "расскажите о компан",
        "о вашей компан", "что вы за организац",
        # История
        "сколько лет на рынке", "когда основан", "история компан",
        "давно работаете", "с какого года",
        # Размер
        "сколько сотрудник", "какой штат", "большая компания",
        "сколько человек в команд",
        # Локация
        "где находитесь", "офис где", "в каком город",
        "российская компания", "казахстанская", "международн",
    ],

    "experience_question": [
        # Опыт
        "какой опыт", "опыт работы", "сколько проектов",
        "сколько внедрен", "сколько клиент",
        # Отрасли
        "с какими отраслями работали", "в нашей сфере работали",
        "есть опыт с ресторан", "есть опыт с ритейл",
        # Масштаб
        "с какими компаниями работ", "крупные клиент",
        "известные клиент", "с кем работали",
        # Экспертиза
        "эксперты в чём", "специализац", "сильные стороны",
    ],

    "case_study_request": [
        # Кейсы
        "кейс", "case study", "пример внедрен", "история успеха",
        "покажите кейс", "есть кейс",
        # Результаты
        "результаты внедрен", "эффект от внедрен",
        "что получили клиент", "какие результаты",
        # Детали
        "подробный кейс", "с цифрами", "с метриками",
        "до и после", "before after",
        # Похожие
        "кейс из нашей отрасли", "похожий кейс", "релевантн кейс",
    ],

    "roi_question": [
        # ROI
        "roi", "возврат инвестиц", "окупаемост",
        "какой roi", "когда окупится", "срок окупаемост",
        # Экономия
        "сколько сэконом", "экономия времен", "экономия денег",
        "уменьшение затрат", "снижение расходов",
        # Расчёт
        "как посчитать roi", "калькулятор roi", "формула roi",
        # Прирост
        "рост продаж", "увеличен конверс", "прирост выручк",
        "на сколько вырастут продаж",
    ],

    # =================================================================
    # УПРАВЛЕНИЕ ДИАЛОГОМ (5 интентов - 1 существующий + 4 новых)
    # =================================================================

    "request_brevity": [
        # Прямые запросы
        "короче", "покороче", "кратко", "краткость",
        "по сути", "суть", "главное", "основное",
        # Негативные сигналы о длине
        "не грузи", "не грузите", "не грузить",
        "слишком длинно", "много текста", "много слов",
        "длинно", "затянуто",
        # Запросы на сжатость
        "сократи", "сократите", "ужми", "сожми",
        "без воды", "воду убери", "давай без воды",
        # Разговорные
        "ближе к делу", "к делу", "давай к делу",
        "не растекайся", "не размазывай",
        "конкретнее", "конкретику",
        # Мягкие запросы
        "можно покороче", "можно кратко",
        "скажите главное", "в двух словах",
    ],

    "clarification_request": [
        # Уточнение
        "что вы имеете в виду", "что имели в виду", "поясните",
        "уточните", "разъясните", "проясните",
        # Непонимание
        "не понял что вы", "не понимаю что", "о чём вы",
        "что это значит", "как это понять",
        # Детали
        "можно подробнее", "расскажите подробн", "детальнее",
        "конкретнее", "точнее скажите",
    ],

    "repeat_request": [
        # Повтор
        "повторите", "повтори", "ещё раз", "заново",
        "скажите ещё раз", "можно ещё раз",
        # Слышимость
        "не расслышал", "плохо слышно", "пропустил",
        "не услышал", "прослушал",
        # Текст
        "не прочитал", "пролистал", "упустил момент",
    ],

    "example_request": [
        # Примеры
        "например", "приведите пример", "покажите пример",
        "на примере", "как выглядит",
        # Демонстрация
        "покажите как", "продемонстрируйте", "можно увидеть",
        "как это работает", "в действии",
        # Конкретика
        "конкретный пример", "реальный пример", "из практики",
        "как у других", "как обычно делают",
    ],

    "summary_request": [
        # Итог
        "итого", "резюме", "резюмируйте", "подытожьте",
        "в итоге что", "что в сухом остатке",
        # Краткость
        "главное что", "основн мысль", "ключевое",
        "суть", "вкратце", "коротко",
        # Вывод
        "какой вывод", "к чему пришли", "что имеем",
        "суммируя", "подводя итог",
    ],

    # =================================================================
    # ВОПРОСЫ ОБ ОБОРУДОВАНИИ (12 новых интентов)
    # =================================================================

    "question_equipment_general": [
        "оборудован", "касса", "кассов", "техник", "устройств",
        "какое оборудован", "что нужно из оборудован", "комплектац",
        "кассовое оборудован", "торговое оборудован",
    ],

    "question_pos_monoblock": [
        "моноблок", "pos", "пос", "терминал", "wipon pos",
        "pos duo", "pos premium", "pos i3", "pos i5",
        "wipon 5 в 1", "пять в одном", "5в1",
        "duo lite", "квадро", "quadro",
    ],

    "question_scales": [
        "весы", "взвешива", "весовое", "rongta", "ронгта",
        "умные весы", "торговые весы", "весы с этикетк",
        "электронные весы", "весы wipon",
    ],

    "question_scanner": [
        "сканер", "штрих", "штрихкод", "barcode", "баркод",
        "сканер штрих-код", "беспроводн сканер", "проводн сканер",
        "стационарн сканер", "ручной сканер", "zebra",
    ],

    "question_printer": [
        "принтер", "чековый", "этикеточн", "печать чек",
        "принтер чеков", "принтер этикет", "термопринтер",
        "x-printer", "xprinter", "h200", "h 200",
    ],

    "question_cash_drawer": [
        "денежн ящик", "кассов ящик", "денежный", "ящик для денег",
        "касса для денег", "drawer",
    ],

    "question_equipment_bundle": [
        "комплект", "набор", "bundle", "пакет оборудован",
        "комплект standard", "комплект стандарт", "комплект pro",
        "готовый комплект", "полный комплект",
    ],

    "question_equipment_specs": [
        "характеристик", "параметр", "процессор", "экран",
        "сколько дюйм", "разрешен экран", "оперативк",
        "техническ характеристик", "спецификац",
    ],

    "question_equipment_warranty": [
        "гарантия на оборудован", "гарантийн", "сервис",
        "сервисное обслужив", "ремонт", "сломалось",
        "гарантия сколько", "если сломается",
    ],

    "question_equipment_install": [
        "установ оборудован", "настройк оборудован", "подключен",
        "как установить", "как настроить", "как подключить",
        "самому установить", "нужен специалист",
    ],

    "question_equipment_compat": [
        "совместим", "подходит ли", "работает ли с",
        "подключить к", "совместимость", "поддержива",
        "можно подключить", "интегрир",
    ],

    "question_second_screen": [
        "второй экран", "экран покупател", "дисплей покупател",
        "дисплей клиент", "монитор покупател",
        "экран для клиент", "двухсторонн",
    ],

    # =================================================================
    # ВОПРОСЫ О ТАРИФАХ (8 новых интентов)
    # =================================================================

    "question_tariff_mini": [
        "тариф mini", "тариф мини", "mini за 5000",
        "минимальн тариф", "базов тариф", "5000 тенге",
        "самый дешёв тариф", "начальн тариф",
    ],

    "question_tariff_lite": [
        "тариф lite", "тариф лайт", "lite", "лайт",
    ],

    "question_tariff_standard": [
        "тариф standard", "тариф стандарт", "standard",
        "стандартн тариф",
    ],

    "question_tariff_pro": [
        "тариф pro", "тариф про", "профессиональн тариф",
        "максимальн тариф", "pro тариф",
    ],

    "question_tariff_comparison": [
        "сравнить тариф", "какой тариф лучше", "чем отличаются тариф",
        "разница между тариф", "тариф vs", "тариф или",
    ],

    "question_installment": [
        "рассрочк", "kaspi рассрочк", "каспи рассрочк",
        "0-0-12", "в рассрочку", "частями платить",
        "помесячн", "ежемесячн платёж",
    ],

    "question_trial_period": [
        "тестов период", "пробн период", "триал",
        "бесплатн период", "демо период", "попробовать бесплатн",
    ],

    "question_ofd_payment": [
        "оплата офд", "списыва офд", "офд когда",
        "абонплата офд", "офд ежемесячн",
    ],

    # =================================================================
    # ВОПРОСЫ О ТИС (10 новых интентов)
    # =================================================================

    "question_tis_general": [
        "что такое тис", "тис это", "тис деген не",
        "расскажите про тис", "тис зачем", "тис что",
        "трёхкомпонентн систем", "трехкомпонентн",
    ],

    "question_tis_limits": [
        "лимит тис", "лимиты тис", "ндс лимит",
        "доход тис", "оборот тис", "2,5 млрд",
        "ограничен тис", "порог тис",
    ],

    "question_tis_price": [
        "сколько стоит тис", "цена тис", "стоимость тис",
        "тис стоит", "подключить тис сколько",
        "тис 220000", "тис 350000",
    ],

    "question_tis_requirements": [
        "требован тис", "что нужно для тис", "условия тис",
        "кто может тис", "подходит ли мне тис",
    ],

    "question_tis_benefits": [
        "преимущ тис", "зачем тис", "выгода тис",
        "плюсы тис", "что даёт тис", "польза тис",
    ],

    "question_tis_2026": [
        "тис 2026", "тис в 2026", "изменен тис",
        "новое в тис", "тис по новому", "тис после 2026",
    ],

    "question_tis_components": [
        "что входит в тис", "состав тис", "компонент тис",
        "из чего состоит тис", "тис включает",
    ],

    "question_tis_multi_location": [
        "тис несколько точек", "тис много магазин",
        "тис филиал", "тис на сеть",
    ],

    "question_tis_transition": [
        "перейти на тис", "подключить тис", "как подключить тис",
        "переход на тис", "тиске қосылу",
    ],

    "question_tis_reports": [
        "отчётност тис", "тис отчёт", "налоги тис",
        "тис форм", "тис декларац",
    ],

    # =================================================================
    # ВОПРОСЫ О НАЛОГАХ (8 новых интентов)
    # =================================================================

    "question_retail_tax_general": [
        "розничн налог", "налог 2026", "рознич налог",
        "новый налог", "налог для розниц",
    ],

    "question_retail_tax_rates": [
        "ставка налог", "процент налог", "2%", "4%",
        "какой процент", "налоговая ставк",
    ],

    "question_retail_tax_oked": [
        "окэд", "вид деятельност", "какой окэд",
        "коды деятельност", "разрешён вид",
    ],

    "question_retail_tax_reports": [
        "отчётност налог", "форма 913", "налоговая отчётност",
        "сдавать отчёт", "декларац налог",
    ],

    "question_retail_tax_transition": [
        "перейти на розничн", "как перейти на налог",
        "переход на розничн налог",
    ],

    "question_snr_comparison": [
        "снр сравн", "упрощёнк или", "патент или",
        "какой режим лучше", "режим налогообложен",
    ],

    "question_vat_registration": [
        "ндс регистрац", "плательщик ндс", "встать на ндс",
        "ндс учёт", "регистрац по ндс",
    ],

    "question_tax_optimization": [
        "оптимизац налог", "меньше налог", "снизить налог",
        "экономия на налог", "налоговая оптимизац",
    ],

    # =================================================================
    # БУХГАЛТЕРИЯ И ДОКУМЕНТЫ (8 новых интентов)
    # =================================================================

    "question_accounting_services": [
        "бухгалтер", "бухгалтерск услуг", "wipon consulting",
        "вайпон консалтинг", "бухучёт", "ведение учёт",
    ],

    "question_esf_snt": [
        "эсф", "снт", "электронн счёт-фактур", "счёт-фактур",
        "сопроводительн накладн", "эцп", "электронн подпис",
    ],

    "question_form_910": [
        "форма 910", "910 форм", "упрощённая декларац",
        "налоговая декларац 910", "сдать 910",
    ],

    "question_form_200": [
        "форма 200", "200 форм", "зарплатн отчётност",
        "пенсионн отчислен", "опв", "соцотчислен",
    ],

    "question_form_300": [
        "форма 300", "300 форм", "ндс отчётност",
        "ндс декларац", "сдать ндс",
    ],

    "question_business_registration": [
        "открыть ип", "зарегистр ип", "открыть тоо",
        "регистрац ип", "регистрац тоо", "получить бин",
    ],

    "question_business_closure": [
        "закрыть ип", "закрыть тоо", "ликвидац",
        "прекратить деятельност", "снять с учёт",
    ],

    "question_document_flow": [
        "накладн", "счета на оплат", "акт", "документооборот",
        "первичн документ", "товарн накладн",
    ],

    # =================================================================
    # ИНТЕГРАЦИИ СПЕЦИФИЧНЫЕ (8 новых интентов)
    # =================================================================

    "question_bank_terminal": [
        "терминал банк", "pos-терминал", "пос-терминал",
        "терминал forte", "терминал halyk", "терминал kaspi",
        "терминал jusan", "терминал bcc", "оплата картой",
    ],

    "question_kaspi_integration": [
        "kaspi интеграц", "каспи интеграц", "kaspi магазин",
        "kaspi pay", "каспи пей", "kaspi red", "каспи ред",
    ],

    "question_halyk_integration": [
        "halyk market", "халык маркет", "halyk интеграц",
        "халык интеграц", "терминал халык",
    ],

    "question_1c_integration": [
        "1с интеграц", "выгрузка 1с", "загрузка 1с",
        "связь с 1с", "синхрониз 1с",
    ],

    "question_iiko_integration": [
        "iiko", "ийко", "айко", "r_keeper", "r-keeper",
        "ресторан систем", "quick resto",
    ],

    "question_ofd_connection": [
        "офд", "фискальн оператор", "подключить офд",
        "офд wipon", "оператор фискальн данных",
    ],

    "question_marking_ismet": [
        "маркировк", "ismet", "исмет", "data matrix",
        "маркирован товар", "обязательн маркировк",
    ],

    "question_cashback_loyalty": [
        "wipon cashback", "кешбэк", "кэшбэк", "бонус",
        "программа лояльност", "накопительн систем",
    ],

    # =================================================================
    # УЧЁТ И ОПЕРАЦИИ (10 новых интентов)
    # =================================================================

    "question_inventory": [
        "склад", "складск учёт", "остатки", "товарн учёт",
        "учёт товар", "товары на складе",
    ],

    "question_revision": [
        "ревизия", "инвентаризац", "пересчёт", "сверка остатк",
        "провести ревиз", "учёт остатк",
    ],

    "question_purchase_mgmt": [
        "приёмка", "закупк", "поставщик", "приход товар",
        "оприходован", "накладн от поставщик",
    ],

    "question_sales_mgmt": [
        "продажи учёт", "история продаж", "транзакц",
        "аналитика продаж", "отчёт по продаж",
    ],

    "question_cash_operations": [
        "открытие смен", "закрытие смен", "z-отчёт", "x-отчёт",
        "кассов смен", "внесение наличн", "изъятие наличн",
    ],

    "question_returns_mgmt": [
        "возврат товар", "возврат денег", "оформить возврат",
        "чек возврат", "вернуть товар",
    ],

    "question_employee_control": [
        "контроль сотрудник", "контроль кассир", "права доступ",
        "ограничить доступ", "роли сотрудник", "кто что продал",
    ],

    "question_multi_location": [
        "несколько точек", "несколько магазин", "сеть магазин",
        "филиал", "много торгов точек", "централизован управлен",
    ],

    "question_promo_discounts": [
        "скидк", "акции", "промокод", "распродаж",
        "система скидок", "настроить скидк",
    ],

    "question_price_labels": [
        "ценник", "этикетк", "печать ценник", "печать этикет",
        "ценникопечать", "штрих-код печат",
    ],

    # =================================================================
    # ДОСТАВКА И СЕРВИС (6 новых интентов)
    # =================================================================

    "question_delivery": [
        "доставк", "доставляете", "привезти", "отправить",
        "есть доставк", "курьер",
    ],

    "question_delivery_time": [
        "срок доставк", "когда доставите", "сколько дней",
        "как быстро доставите", "за сколько привезёте",
    ],

    "question_office_location": [
        "где офис", "адрес офис", "филиал",
        "офис в шымкент", "офис в алматы", "офис в астан",
        "где находитесь", "мкр нурсат",
    ],

    "question_working_hours": [
        "часы работ", "до скольки работаете", "режим работ",
        "когда открыты", "во сколько закрыва",
    ],

    "request_refund": [
        "вернуть деньг", "возврат средств", "возврат оплат",
        "деньги обратно", "отмена покупк",
    ],

    "request_equipment_return": [
        "вернуть оборудован", "обмен оборудован",
        "замена оборудован", "не подошло оборудован",
    ],

    # =================================================================
    # БИЗНЕС-СЦЕНАРИИ (10 новых интентов)
    # =================================================================

    "question_grocery_store": [
        "продуктов магазин", "минимаркет", "продукты",
        "гастроном", "супермаркет", "магазин у дома",
    ],

    "question_restaurant_cafe": [
        "ресторан", "кафе", "кулинария", "столов",
        "общепит", "фастфуд", "пекарн", "кофейн",
    ],

    "question_pharmacy": [
        "аптек", "лекарств", "фармац", "маркировк лекарств",
        "аптечн сеть", "аптечн киоск",
    ],

    "question_clothing_store": [
        "одежд", "магазин одежд", "бутик", "размер",
        "размеры и цвет", "модел одежд",
    ],

    "question_small_business": [
        "маленьк магазин", "небольш магазин", "ларёк",
        "киоск", "палатк", "небольш бизнес",
    ],

    "question_network_stores": [
        "сеть магазин", "несколько торгов точек", "франшиз",
        "много магазин", "розничн сеть",
    ],

    "question_market_stall": [
        "рынок", "базар", "ярмарк", "выездн торговл",
        "торговля на рынке", "на базаре",
    ],

    "question_alcohol_tobacco": [
        "алкогол", "табак", "акциз", "лицензия на алкогол",
        "маркировка алкогол", "продажа алкогол",
    ],

    "question_beauty_salon": [
        "салон красот", "парикмахерск", "барбершоп",
        "маникюр", "спа", "косметолог",
    ],

    "question_construction": [
        "стройматериал", "строительн магазин",
        "метры", "литры", "килограмм", "единицы измерен",
    ],

    # =================================================================
    # ТЕХНИЧЕСКИЕ ПРОБЛЕМЫ (6 новых интентов)
    # =================================================================

    "problem_technical": [
        "не работает", "сломалось", "ошибк", "проблем",
        "баг", "глюч", "завис", "не запускается",
    ],

    "problem_connection": [
        "не подключается", "нет связи", "не коннектится",
        "потерял соединен", "отключилось",
    ],

    "problem_sync": [
        "не синхронизир", "данные не обновля",
        "синхронизац ошибк", "рассинхрон",
    ],

    "problem_fiscal": [
        "чек не пробива", "касса не работает", "фискализац ошибк",
        "чек не печата", "офд ошибк",
    ],

    "request_technical_support": [
        "нужна помощь", "техническ помощь", "позовите специалист",
        "вызовите мастер", "нужен техник",
    ],

    "request_configuration": [
        "настройте", "помогите настроить", "конфигурац",
        "нужна настройк", "настроить систем",
    ],

    # =================================================================
    # ЯЗЫК И ПРОЧЕЕ (2 новых интента)
    # =================================================================

    "language_kazakh": [
        "сәлем", "сәлеметсіз", "қалай", "рахмет",
        "қазақша", "казахск", "на казахском",
        "келісемін", "жақсы", "иә",
    ],

    "payment_confirmation": [
        "оплатил", "перевёл", "оплата прошла",
        "деньги отправил", "перечислил", "заплатил",
    ],

    # =================================================================
    # РАЗГОВОРНЫЕ/ЭМОЦИОНАЛЬНЫЕ (10 новых интентов)
    # =================================================================

    "compliment": [
        "молодц", "класс", "супер", "отлично", "круто", "респект",
        "лучшие", "вы лучшие", "классный сервис", "отличный сервис",
        "спасибо за работу", "хорошая работа", "так держать",
        "профессионал", "пятёрка", "пять баллов", "браво", "аплодисмент",
        "красавчик", "красавц", "умнички", "огонь сервис",
    ],

    "joke_response": [
        "хаха", "хехе", "лол", "lol", "ржу", "смешно", "прикольно",
        "ахаха", "хихи", "угарно", "смеюсь", "поржал", "ржунимагу",
        "))))", "😂", "🤣", "смешной", "юморист", "шутка",
        "хохочу", "плачу от смеха", "ору",
    ],

    "surprise_expression": [
        "ого", "ничего себе", "вау", "wow", "офигеть", "ну ничего себе",
        "серьёзно", "да ладно", "не может быть", "вот это да",
        "круто же", "ещё бы", "реально", "правда что ли",
        "не верю своим глазам", "удивил", "поразил", "шок",
    ],

    "frustration_expression": [
        "надоело", "достало", "бесит", "раздража", "злит",
        "утомил", "задолбал", "замучил", "выводит из себя",
        "невыносим", "терпение кончил", "сколько можно",
        "устал от", "хватит уже", "невозможно так",
    ],

    "skepticism_expression": [
        "сомнева", "не верится", "звучит слишком хорош",
        "а точно", "а правда", "не обман", "не развод",
        "гарантии где", "доказательства", "чем подтверд",
        "красиво рассказыва", "на словах", "верится с трудом",
    ],

    "curiosity_expression": [
        "а что если", "интересно было бы", "любопытно",
        "а как насчёт", "а если", "хотелось бы узнать",
        "было бы интересн", "мне любопытн", "заинтриговал",
        "расскажи подробн", "а вот ещё вопрос",
    ],

    "empathy_request": [
        "войдите в положен", "поймите меня", "вы же понимаете",
        "у нас сложная ситуац", "входите в положен",
        "пожалуйста поймите", "мы в трудной ситуац",
        "учтите наш", "примите во вниман",
    ],

    "confusion_expression": [
        "запутался", "голова кругом", "не понимаю",
        "всё смешалось", "потерялся", "не могу разобрать",
        "слишком много информац", "сложно понять",
        "не улавливаю", "не догоняю", "туплю",
    ],

    "impatience_expression": [
        "сколько ждать", "быстрее можно", "долго",
        "когда уже", "сколько ещё", "поторопитесь",
        "давайте быстрее", "нет времени ждать", "срочно надо",
        "время поджимает", "горят сроки", "не успеваем",
    ],

    "relief_expression": [
        "слава богу", "наконец-то", "фух", "ну наконец",
        "ура", "отлегло", "успокоился", "легче стало",
        "камень с души", "облегчен", "дышать легче",
        "выдохнул", "расслабился",
    ],

    # =================================================================
    # ВОПРОСЫ О ФИСКАЛИЗАЦИИ (8 новых интентов)
    # =================================================================

    "question_fiscal_general": [
        "фискализац", "что такое фискализац", "зачем фискализац",
        "обязательн фискализац", "как работает фискализац",
        "фискальн данны", "передача в офд",
    ],

    "question_fiscal_receipt": [
        "чек как выгляд", "что в чеке", "электронн чек",
        "qr код на чеке", "реквизиты чека", "обязательн реквизит",
        "чек покупател", "фискальн чек", "кассов чек",
    ],

    "question_fiscal_z_report": [
        "z-отчёт", "z отчёт", "зет отчёт", "что такое z-отчёт",
        "когда делать z", "закрытие смен z", "z-отчёт ежедневн",
        "обнуление кассы", "итоговый отчёт",
    ],

    "question_fiscal_x_report": [
        "x-отчёт", "x отчёт", "икс отчёт", "что такое x-отчёт",
        "отличие x от z", "промежуточн отчёт", "текущий отчёт",
    ],

    "question_fiscal_kkm": [
        "ккм", "контрольно-кассов", "что такое ккм",
        "нужна ли ккм", "регистрац ккм", "онлайн-касс",
        "кассов аппарат", "налоговая касс",
    ],

    "question_fiscal_ofd_wipon": [
        "офд wipon", "ваш офд", "оператор фискальн данных wipon",
        "офд вайпон", "подключить к офд wipon",
    ],

    "question_fiscal_correction": [
        "чек коррекц", "коррекция чек", "ошибка в чеке",
        "исправить чек", "неправильн чек", "перебить чек",
        "отмена чека", "аннулир чек",
    ],

    "question_fiscal_replacement": [
        "замена фискальн", "замена фн", "срок фн", "фискальн накопител",
        "когда менять фн", "истёк срок фн", "перерегистрац ккм",
    ],

    # =================================================================
    # ВОПРОСЫ ОБ АНАЛИТИКЕ (8 новых интентов)
    # =================================================================

    "question_analytics_sales": [
        "аналитика продаж", "отчёт по продаж", "статистика продаж",
        "сколько продали", "объём продаж", "история продаж",
    ],

    "question_analytics_abc": [
        "abc анализ", "abc-анализ", "абц анализ",
        "какие товары приносят больше", "топ товар", "прибыльн товар",
        "рейтинг товаров", "лучшие товары",
    ],

    "question_analytics_profit": [
        "анализ прибыл", "маржа", "маржинальност", "рентабельност",
        "прибыль по товар", "наценка", "валовая прибыл",
    ],

    "question_analytics_comparison": [
        "сравнить период", "динамика продаж", "рост продаж",
        "сравнение месяц", "год к году", "прошл период",
        "тренд", "изменен", "сравнительн анализ",
    ],

    "question_analytics_realtime": [
        "в реальном времен", "онлайн статистик", "текущие продаж",
        "мониторинг продаж", "сейчас продали", "актуальн данн",
    ],

    "question_analytics_export": [
        "выгрузить в excel", "скачать отчёт", "экспорт отчёт",
        "сохранить отчёт", "отправить отчёт на почт", "pdf отчёт",
    ],

    "question_analytics_custom": [
        "свой отчёт", "настроить отчёт", "кастомн отчёт",
        "создать отчёт", "конструктор отчёт", "индивидуальн отчёт",
    ],

    "question_analytics_dashboard": [
        "дашборд", "панель управлен", "графики", "виджеты",
        "визуализац", "диаграмм", "главн экран",
    ],

    # =================================================================
    # ВОПРОСЫ О ПРОДУКТАХ WIPON (6 новых интентов)
    # =================================================================

    "question_wipon_pro": [
        "wipon pro", "вайпон про", "что такое wipon pro",
        "функции wipon pro", "pro версия", "профессиональн версия",
    ],

    "question_wipon_desktop": [
        "wipon desktop", "вайпон десктоп", "версия для компьютер",
        "десктоп версия", "программа на пк", "приложен для windows",
    ],

    "question_wipon_kassa": [
        "wipon kassa", "вайпон касса", "мобильн касса wipon",
        "касса на телефон", "касса на планшет",
    ],

    "question_wipon_consulting": [
        "wipon consulting", "вайпон консалтинг", "бухгалтерск услуги wipon",
        "консалтинговые услуг", "бухгалтер wipon",
    ],

    "question_wipon_cashback_app": [
        "приложен для клиент", "wipon cashback приложен",
        "приложение покупател", "кешбэк приложен", "app для клиент",
    ],

    "question_product_comparison": [
        "wipon pro vs kassa", "что выбрать wipon", "отличие pro от kassa",
        "какой wipon лучше", "сравнить продукты wipon",
    ],

    # =================================================================
    # ВОПРОСЫ О СОТРУДНИКАХ/КАДРАХ (6 новых интентов)
    # =================================================================

    "question_employees_salary": [
        "зарплата сотрудник", "начислен зп", "расчёт зарплат",
        "выплата зарплат", "зарплатн ведомост",
    ],

    "question_employees_schedule": [
        "график смен", "расписан сотрудник", "график работы кассир",
        "смены сотрудник", "рабочее время",
    ],

    "question_employees_permissions": [
        "ограничить кассир", "роли сотрудник", "права кассир",
        "доступ сотрудник", "настроить права", "разграничен прав",
    ],

    "question_employees_tracking": [
        "контроль кассир", "кто сколько продал", "продажи по кассир",
        "отчёт по сотрудник", "эффективност сотрудник",
    ],

    "question_employees_motivation": [
        "kpi для продавц", "мотивация сотрудник", "бонусы продавц",
        "премирован", "план продаж сотрудник",
    ],

    "question_employees_onboarding": [
        "обучить кассир", "инструкц для персонал", "обучен новых",
        "как научить работать", "адаптац сотрудник",
    ],

    # =================================================================
    # ДОПОЛНИТЕЛЬНЫЕ БИЗНЕС-СЦЕНАРИИ (8 новых интентов)
    # =================================================================

    "question_wholesale": [
        "оптов продаж", "b2b", "оптом", "оптовая торговл",
        "работа с оптовик", "крупн партии", "мелкий опт",
    ],

    "question_auto_parts": [
        "автозапчаст", "авто запчаст", "запчасти", "автомагазин",
        "магазин запчаст", "детали автомобил",
    ],

    "question_electronics": [
        "электроник", "магазин техник", "гаджеты", "смартфон",
        "бытов техник", "компьютерн магазин",
    ],

    "question_pet_shop": [
        "зоотовар", "корм для животн", "зоомагазин",
        "товары для питомц", "ветеринарн товар",
    ],

    "question_flower_shop": [
        "цвет", "букет", "флористик", "цветочн магазин",
        "цветочн бизнес", "продажа цветов",
    ],

    "question_hotel": [
        "гостиниц", "отел", "хостел", "бронирован номер",
        "номерн фонд", "заселен гостей", "мини-отел",
    ],

    "question_service_center": [
        "ремонт техник", "сервис центр", "сервисн центр",
        "мастерск", "ремонтн", "услуги ремонт",
    ],

    "question_sports_shop": [
        "спортивн магазин", "спортинвентар", "спортовар",
        "фитнес товар", "спортивн одежд",
    ],

    # =================================================================
    # ДОПОЛНИТЕЛЬНЫЕ ИНТЕГРАЦИИ (6 новых интентов)
    # =================================================================

    "question_glovo_wolt": [
        "glovo", "глово", "wolt", "волт", "доставка еды интеграц",
        "агрегатор доставк", "заказы из glovo",
    ],

    "question_telegram_bot": [
        "телеграм бот", "telegram bot", "бот для заказ",
        "заказы через телеграм", "тг бот",
    ],

    "question_whatsapp_business": [
        "whatsapp business", "вотсап бизнес", "заказы через вотсап",
        "ватсап интеграц", "waba",
    ],

    "question_instagram_shop": [
        "инстаграм магазин", "продажи через инст", "instagram shop",
        "инста магазин", "интеграц с инстаграм",
    ],

    "question_website_widget": [
        "виджет на сайт", "форма заказ на сайт", "кнопка заказ",
        "онлайн заказ сайт", "интеграц с сайт",
    ],

    "question_delivery_services": [
        "сдэк", "cdek", "интеграц с доставк", "курьерск служб",
        "службы доставк", "boxberry", "почта",
    ],

    # =================================================================
    # ВОПРОСЫ О ПРОМО/ЛОЯЛЬНОСТИ (6 новых интентов)
    # =================================================================

    "question_loyalty_program": [
        "программа лояльност", "постоянн клиент", "лояльност покупател",
        "удержан клиент", "система лояльност",
    ],

    "question_bonus_system": [
        "бонус клиент", "накопительн балл", "бонусн систем",
        "баллы за покупк", "накопительн скидк",
    ],

    "question_discount_cards": [
        "карт скидок", "дисконтн программ", "дисконтн карт",
        "скидочн карт", "клубн карт",
    ],

    "question_gift_cards": [
        "подарочн сертификат", "gift card", "подарочн карт",
        "сертификат на покупк", "электронн сертификат",
    ],

    "question_customer_database": [
        "база покупател", "клиентск база", "база клиент",
        "контакты клиент", "crm клиент",
    ],

    "question_sms_marketing": [
        "sms рассылк", "рассылка клиент", "sms уведомлен",
        "массов рассылк", "оповещен клиент",
    ],

    # =================================================================
    # ВОПРОСЫ О СТАБИЛЬНОСТИ/НАДЁЖНОСТИ (6 новых интентов)
    # =================================================================

    "question_backup_restore": [
        "бэкап", "резервн копирован", "восстановлен данн",
        "backup", "резервн копи", "архив данн",
    ],

    "question_uptime_sla": [
        "uptime", "какой sla", "сбои быва", "время работы систем",
        "стабильност систем", "надёжност серв",
    ],

    "question_server_location": [
        "где сервер", "дата центр", "датацентр", "расположен серверов",
        "серверы в казахстан", "облачн хранилищ",
    ],

    "question_data_encryption": [
        "шифрован данн", "безопасност данн", "защита данн",
        "ssl", "https", "криптограф",
    ],

    "question_disaster_recovery": [
        "восстановлен после сбо", "dr план", "отказоустойчив",
        "что если сервер упад", "резервирован",
    ],

    "question_system_requirements": [
        "какой компьютер нуж", "требован к пк", "системн требован",
        "минимальн требован", "характеристик пк",
    ],

    # =================================================================
    # ВОПРОСЫ О РЕГИОНАХ/ПРИСУТСТВИИ (6 новых интентов)
    # =================================================================

    "question_region_almaty": [
        "офис в алматы", "доставка в алматы", "алматы",
        "алма-ат", "работаете в алматы",
    ],

    "question_region_astana": [
        "офис в астан", "астана", "нур-султан",
        "доставка в астан", "работаете в астан",
    ],

    "question_region_shymkent": [
        "офис в шымкент", "шымкент", "чимкент",
        "доставка в шымкент", "работаете в шымкент",
    ],

    "question_region_other": [
        "караганд", "актоб", "актау", "атырау", "павлодар",
        "семей", "тараз", "кызылорд", "уральск", "кокшетау",
        "костанай", "петропавловск", "другие город",
    ],

    "question_pickup_office": [
        "самовывоз из офис", "забрать самому", "приехать в офис",
        "можно забрать", "самовывоз",
    ],

    "question_courier_service": [
        "курьер привезёт", "доставка курьер", "курьерск доставк",
        "курьер на дом", "служба доставк wipon",
    ],

    # =================================================================
    # ЦЕНОВЫЕ ДОПОЛНИТЕЛЬНЫЕ (5 интентов)
    # =================================================================

    "cost_inquiry": [
        "стоимост", "сколько стоит", "расходы", "затраты", "во сколько обойд",
    ],

    "discount_request": [
        "есть скидк", "какие скидк", "акци", "промокод", "специальн предложен",
    ],

    "payment_terms": [
        "условия оплат", "рассрочк", "отсрочк", "предоплат", "постоплат",
    ],

    "pricing_comparison": [
        "сравнить цен", "сравнить тариф", "отличие тарифов", "разница в цен",
    ],

    "budget_question": [
        "бюджет", "минимальн бюджет", "инвестици", "окупаемост",
    ],

    # =================================================================
    # ЭСКАЛАЦИЯ (2 интента)
    # =================================================================

    "request_human": [
        "оператор", "менеджер", "живой человек", "не бот", "переключи на человек",
    ],

    "need_help": [
        "помогите", "не разберусь", "не могу разобраться", "нужна помощь",
    ],

    # =================================================================
    # ЧУВСТВИТЕЛЬНЫЕ/ЮРИДИЧЕСКИЕ (6 интентов)
    # =================================================================

    "legal_question": [
        "юридическ", "юрист", "правов", "законодательств",
    ],

    "formal_complaint": [
        "жалоб", "претензи", "рекламаци", "книга жалоб",
    ],

    "contract_dispute": [
        "спор по договор", "расторжен", "нарушен условий",
    ],

    "data_deletion": [
        "удалить данн", "удалить аккаунт", "стереть данн", "право на забвен",
    ],

    "gdpr_request": [
        "gdpr", "персональные данн", "защит данн", "обработк данных",
    ],

    "compliance_question": [
        "сертифик", "соответств", "гост", "стандарт", "лицензи", "аттестац",
    ],

    # =================================================================
    # ТЕХНИЧЕСКИЙ (1 интент)
    # =================================================================

    "question_technical": [
        "ssl", "tls", "api", "webhook", "технический", "документация",
    ],
}

# =============================================================================
# ИНТЕНТЫ: ПОЛНЫЕ ФРАЗЫ (для pymorphy2 fallback)
# =============================================================================

INTENT_PHRASES = {
    "greeting": [
        # Стандартные
        "привет", "здравствуйте", "добрый день", "доброе утро", "добрый вечер",
        "хай", "приветствую", "салют",
        # Разговорные
        "прив", "здарова", "дарова", "хаюшки", "приветик", "ку",
        "здрасьте", "доброго времени", "доброго дня",
        # Формальные и вежливые
        "рад приветствовать", "приятно познакомиться", "всем привет",
        # Дополнительные
        "дратути", "превед", "приветос", "здорово", "хеллоу",
        "доброго времени суток", "приветствую вас", "здравия желаю",
        "добренького", "утречко доброе", "добрый денёчек",
    ],
    "price_question": [
        # Стандартные
        "сколько стоит", "какая цена", "прайс", "почём", "стоимость",
        "какой ценник", "по деньгам", "какие тарифы", "какие расценки",
        "сколько это будет стоить", "во сколько обойдётся", "какой бюджет нужен",
        # Вежливые
        "не подскажете стоимость", "можно узнать цену", "подскажите по ценам",
        "интересует стоимость", "хотел бы узнать цену", "скажите сколько",
        # Косвенные
        "интересует финансовая сторона", "что по деньгам", "что по цене",
        "какие условия по оплате", "как по финансам",
        # С контекстом
        "а если на год сколько выйдет", "сколько за месяц", "сколько за пользователя",
        "какая цена за лицензию", "стоимость подписки", "абонентская плата",
        "цена внедрения", "скрытые платежи есть", "есть пробный период",
        # Разговорные
        "чё почём", "скока стоит", "почом будет", "скинь прайс",
        # Дополнительные вежливые
        "не подскажете по стоимости", "сколько это удовольствие стоит",
        "хотелось бы узнать цену", "интересно узнать стоимость",
        "если не секрет сколько", "можете озвучить цену",
        # Дополнительные с контекстом
        "сколько за одно рабочее место", "цена за оператора",
        "сколько если оплатить сразу за год", "есть ли скидка за объём",
        "минимальный пакет сколько стоит", "сколько стоит базовый тариф",
        "какой минимальный платёж", "от какой суммы можно начать",
        "сколько за внедрение берёте", "настройка платная",
        "обучение входит в стоимость", "что входит в цену",
        # Дополнительные разговорные
        "во сколько влетит", "сколько это встанет", "какой чек выйдет",
        "в какую сумму уложимся", "какие денежки нужны",
    ],
    "objection_price": [
        # Стандартные
        "дорого", "слишком дорого", "дешевле есть", "нет бюджета",
        "не потянем", "денег нет", "дороговато",
        # Разговорные
        "цены кусаются", "ценник не по карману", "жирновато",
        "накладно выходит", "неподъёмная сумма",
        # Сравнительные
        "у конкурентов дешевле", "есть варианты подешевле",
        "видел дешевле", "другие предлагают дешевле",
        # Бюджетные
        "бюджет не позволяет", "не заложено в бюджет", "урезали бюджет",
        "выделили мало", "не выделили средства",
        # Скидки
        "есть скидки", "можно дешевле", "скиньте цену", "торг уместен",
        # Дополнительные
        "это перебор", "слишком много хотите", "завышенный ценник",
        "не окупится", "не отобьётся", "рентабельность под вопросом",
        "за эти деньги можно что-то получше", "цена не соответствует",
        "неоправданно дорого", "не стоит таких денег",
        "режем расходы сейчас", "оптимизируем затраты",
        "в кризис не до этого", "экономим каждую копейку",
        "можно бесплатную версию", "есть бесплатный период",
    ],
    "objection_no_time": [
        # Стандартные
        "нет времени", "занят", "не сейчас", "перезвоните позже",
        "давайте потом", "сейчас не могу",
        # Разговорные
        "некогда совсем", "завален работой", "запара на работе", "аврал",
        "горят дедлайны", "конец квартала",
        # Отложенные
        "в другой раз", "на следующей неделе", "через месяц",
        "после праздников", "после отпуска", "давайте в следующем квартале",
        # Вежливые
        "сейчас не лучшее время", "не до этого сейчас", "голова другим забита",
        "руки не доходят", "много других задач",
        # Дополнительные
        "загружены по горло", "зашиваемся", "работы невпроворот",
        "сейчас горячая пора", "высокий сезон у нас",
        "отчётный период", "конец года", "конец месяца",
        "после новогодних праздников", "в январе напишите",
        "пока разгребём текущие дела", "освободимся и свяжемся",
        "может через пару недель", "давайте после выходных",
        "на этой неделе точно нет", "следующий месяц тоже занят",
    ],
    "objection_competitor": [
        # CRM упоминания
        "уже есть crm", "используем битрикс", "у нас амо", "есть система",
        "уже пользуемся", "работаем в другой",
        # Конкретные системы
        "сидим на битриксе", "внедрили амо", "перешли на мегаплан",
        "используем salesforce", "подключили pipedrive", "работаем в hubspot",
        # Своя разработка
        "у нас своя система", "самописная crm", "написали сами",
        "своя разработка", "кастомное решение",
        # Замена
        "менять не планируем", "устраивает текущая", "привыкли к своей",
        "не хотим переучиваться", "переход дорого обойдётся",
        # Дополнительные
        "уже внедрили другую систему", "недавно купили crm",
        "вложились в битрикс", "оплатили амо на год вперёд",
        "команда обучена на другой системе", "все привыкли к текущей",
        "переносить данные сложно", "миграция будет долгой",
        "у нас всё в notion", "ведём в trello",
        "работаем в excel пока нормально", "гугл таблицы устраивают",
        "бесплатной версии хватает", "используем бесплатную crm",
    ],
    "question_features": [
        # Стандартные
        "что умеете", "какие функции", "какие возможности", "что может",
        "что включено", "что входит", "как работает",
        # Вопросы о продукте
        "что такое", "что это такое", "что это за", "что за продукт",
        "расскажите о продукте", "расскажите про продукт",
        "хочу узнать о продукте", "хочу узнать про продукт",
        # Конкретные вопросы
        "есть ли воронка", "есть автоматизация", "можно настроить",
        "умеете делать рассылки", "есть аналитика", "какие отчёты",
        # Сравнительные
        "чем лучше конкурентов", "какие преимущества", "в чём отличие",
        "почему вас выбрать", "что вы можете чего нет у других",
        # Технические
        "какой стек", "на чём написано", "где хранятся данные",
        "есть мобильное приложение", "работает офлайн",
        # Практические
        "сколько займёт внедрение", "нужно ли обучение", "есть поддержка",
        "как быстро отвечаете", "есть документация",
        # Дополнительные
        "какие фишки есть", "в чём ваша фишка", "какая киллер фича",
        "что умеет ваша система", "расскажите про функционал",
        "покажите возможности", "демонстрация возможностей",
        "можно автоматизировать рутину", "есть ли шаблоны",
        "можно настроить под себя", "насколько гибкая система",
        "есть api для разработчиков", "можно кастомизировать",
        "как с безопасностью", "данные защищены",
        "есть резервное копирование", "где сервера расположены",
        "можно выгрузить данные", "экспорт есть",
    ],
    "question_integrations": [
        # Стандартные
        "какие интеграции", "с чем интегрируется", "подключается ли",
        "есть интеграция с", "работает с 1с",
        # Мессенджеры
        "подключается к whatsapp", "есть телеграм бот", "интеграция с вайбер",
        "работает с вконтакте", "подключается инстаграм",
        # Телефония
        "есть интеграция с телефонией", "подключается к ats", "работает с манго",
        "можно записывать звонки", "интеграция с ip-телефонией",
        # Учётные системы
        "синхронизируется с 1с", "есть связь с бухгалтерией",
        "интеграция с мой склад", "подключается к эльбе",
        # Маркетплейсы
        "работает с авито", "подключается к wildberries", "есть озон интеграция",
        # Дополнительные
        "интеграция с вотсапом", "подключить телегу можно",
        "с вк работает", "инста подключается",
        "интеграция с ройстат", "коллтрекинг есть",
        "работает с колмагик", "интегрируется с колтач",
        "есть вебхуки", "апи открытое",
        "можно через zapier", "albato поддерживаете",
        "рассылки через sendpulse", "юнисендер интеграция",
        "с тильдой работает", "формы с сайта собирает",
        "лиды с лендинга подтягивает", "чат на сайт есть",
    ],
    "agreement": [
        # Стандартные
        "интересно", "давайте", "расскажите", "хочу попробовать", "да",
        "согласен", "подходит", "нравится", "готов", "хочу демо",
        # Активный интерес
        "покажите в деле", "хочу посмотреть", "давайте попробуем",
        "запишите на демо", "когда можно посмотреть", "как подключиться",
        # Разговорные
        "окей", "ладно", "договорились", "идёт", "пойдёт", "заметано",
        "супер", "класс", "отлично", "круто", "норм",
        # Уточняющие
        "расскажите подробнее", "а поподробнее можно", "интересно узнать больше",
        "хочу детали", "что ещё умеете",
        # Дополнительные
        "звучит интересно", "звучит неплохо", "заинтересовали",
        "заинтриговали", "любопытно", "хочется попробовать",
        "было бы интересно посмотреть", "можно глянуть",
        "го демо", "погнали", "поехали", "стартуем",
        "давай попробуем", "почему бы и нет", "можно попробовать",
        "запишите меня", "записывайте", "бронируйте время",
        "когда можно созвониться", "когда удобно показать",
        "готов посмотреть", "готовы к демо", "ждём презентацию",
        # Расширенные позитивные сигналы
        "это то что нужно", "именно то что искали", "под нас подходит",
        "нам актуально", "нам релевантно", "то что надо",
        "выставляйте счёт", "присылайте договор", "оформляем",
        "берём на тест", "запускаем пилот", "начинаем работу",
        "жду подробности", "скиньте материалы", "пришлите презентацию",
        "добавьте в чат", "подключите к демо", "включите в рассылку",
    ],

    # =================================================================
    # SPIN-ИНТЕНТЫ (полные фразы)
    # =================================================================

    # Ответы на Situation вопросы
    "situation_provided": [
        "у нас человек", "в команде человек", "нас человек", "работает человек",
        "используем excel", "работаем в excel", "ведём в таблицах", "в 1с",
        "у нас магазин", "у нас ресторан", "у нас склад", "у нас офис",
        "розничная торговля", "оптовые продажи", "сфера услуг",
        "ведём вручную", "записываем в блокнот", "всё в голове",
        "пользуемся", "работаем в", "используем",
    ],

    # Ответы на Problem вопросы
    "problem_revealed": [
        "теряем клиентов", "забываем перезвонить", "путаница в остатках",
        "не успеваем обрабатывать", "много ручной работы", "нет контроля",
        "не видим статистику", "не понимаем что происходит",
        "бардак в данных", "каждый ведёт по-своему", "данные теряются",
        "ошибки в заказах", "проблемы с учётом", "сложно отслеживать",
    ],

    # Ответы на Implication вопросы
    "implication_acknowledged": [
        "теряем тысяч", "уходит часов", "это стоит", "обходится в",
        "примерно клиентов", "около процентов", "тратим времени",
        "да это серьёзно", "да это проблема", "согласен критично",
        "к сожалению много", "да уж немало",
    ],

    # Ответы на Need-Payoff вопросы
    "need_expressed": [
        "было бы здорово", "хотелось бы", "нужно чтобы",
        "помогло бы", "решило бы проблему", "избавило бы",
        "да это упростило бы", "конечно помогло бы",
        "хотим автоматизировать", "нужна система", "хотим видеть",
    ],

    # Отрицание проблемы (ответ на Problem вопросы)
    "no_problem": [
        "нет у нас таких проблем", "нет проблем у нас", "у нас всё хорошо",
        "всё хорошо с этим", "нас всё устраивает", "нас устраивает текущая ситуация",
        "мы справляемся", "справляемся своими силами", "у нас всё под контролем",
        "нет никаких проблем", "проблем не испытываем", "с этим всё в порядке",
        "всё работает нормально", "не жалуемся на это", "нет таких сложностей",
        "это не про нас", "у нас по-другому", "нам это не грозит",
        "ничего подобного у нас нет", "таких проблем не замечали",
        "нет не теряем клиентов", "нет не забываем перезвонить",
        "нет всё фиксируем", "у нас с этим порядок",
    ],

    # Отрицание потребности (ответ на Need-Payoff вопросы)
    "no_need": [
        "нам это не нужно", "не нужно нам это", "мы обойдёмся",
        "обходимся без этого", "и так справляемся", "справимся и так",
        "пока не нужно нам это", "сейчас в этом нет необходимости",
        "без этого обойдёмся нормально", "нет в этом необходимости",
        "не видим в этом необходимости", "не вижу смысла в этом",
        "нам это ни к чему сейчас", "это лишнее для нас",
        "для нас это не актуально", "текущего решения хватает",
        "хватает того что есть сейчас", "нас устраивает как есть",
        "менять ничего не хотим", "ничего менять не нужно",
        "оставим как есть пока", "не требуется нам такое",
    ],

    "rejection": [
        # Стандартные
        "не интересно", "не нужно", "нет", "отстаньте", "не хочу",
        "не буду", "отказываюсь", "не надо",
        # Резкие
        "отвалите", "хватит спамить", "прекратите", "достали",
        "сколько можно", "не пишите больше", "заблокирую",
        # Вежливые
        "спасибо не надо", "благодарю но нет", "пожалуй откажусь",
        "воздержусь", "обойдёмся", "справимся сами",
        # Скептичные
        "не верю в это", "сомневаюсь что поможет", "вряд ли нам подойдёт",
        "не наш вариант", "не для нас",
        # Дополнительные
        "неинтересно совсем", "абсолютно не нужно", "точно нет",
        "без вас обойдёмся", "без вас справимся", "пас",
        "отписывайте меня", "удалите мой контакт", "уберите из базы",
        "надоели", "утомили", "замучили", "задолбали уже",
        "не актуально для нас", "мимо кассы", "не по адресу",
        "это не для нашей компании", "нам это не подходит",
        "мы не ваша целевая аудитория", "не наш профиль",
    ],

    # =================================================================
    # НОВЫЕ ИНТЕНТЫ (полные фразы)
    # =================================================================

    # Запрос обратного звонка
    "callback_request": [
        "перезвоните мне", "позвоните мне", "можете перезвонить",
        "жду вашего звонка", "ожидаю звонка", "свяжитесь со мной",
        "вот мой номер", "вот мой телефон", "запишите мой номер",
        "наберите меня", "созвонимся", "давайте созвонимся",
        "можно созвониться", "хочу поговорить по телефону",
        "лучше по телефону", "удобнее позвонить",
    ],

    # Запрос демо
    "demo_request": [
        "хочу демо", "покажите демо", "можно демо", "дайте демо",
        "хочу посмотреть как работает", "покажите в действии",
        "хочу попробовать", "можно попробовать", "хочу потестировать",
        "есть пробный период", "бесплатный период",
        "дайте тестовый доступ", "пробный доступ", "триал",
        "запишите на демо", "хочу презентацию", "покажите презентацию",
        "можно посмотреть систему", "хочу увидеть интерфейс",
    ],

    # Запрос консультации
    "consultation_request": [
        "нужна консультация", "хочу консультацию", "можно проконсультироваться",
        "посоветуйте что выбрать", "порекомендуйте решение",
        "помогите разобраться", "помогите понять", "помогите выбрать",
        "у меня вопрос", "есть вопросы", "хотел бы обсудить",
        "нужен совет", "что посоветуете", "как лучше сделать",
    ],

    # Сравнение с конкурентами
    "comparison": [
        "чем лучше амо", "чем лучше битрикса", "чем отличаетесь от амо",
        "чем отличаетесь от битрикса", "сравните с амо", "сравните с битрикс",
        "почему вас а не амо", "почему вас а не битрикс",
        "в чём преимущества", "какие плюсы", "какие минусы",
        "что есть у вас чего нет у других", "уникальные функции",
        "амо или вы", "битрикс или вы", "вы или амо",
    ],

    # Детали по цене
    "pricing_details": [
        "что входит в стоимость", "из чего складывается цена",
        "дайте прайс-лист", "пришлите прайс", "скиньте расчёт",
        "есть скидки", "какие акции", "минимальный пакет",
        "базовый тариф сколько", "цена за пользователя",
        "помесячная оплата", "годовая оплата", "есть рассрочка",
        "условия оплаты", "способы оплаты", "как оплатить",
        "скрытые платежи есть", "за что ещё платить",
    ],

    # Возражение "надо подумать"
    "objection_think": [
        "надо подумать", "нужно подумать", "дайте подумать",
        "нужно обсудить", "надо посовещаться", "обсужу с руководством",
        "посоветуюсь с директором", "согласую с начальством",
        "это не я решаю", "решение принимает не я",
        "не в моей компетенции", "нужно время на решение",
        "дайте пару дней", "вернусь позже", "перезвоню когда решу",
        "пока не готов к решению", "нужно всё взвесить",
    ],

    # Прощание
    "farewell": [
        "до свидания", "до связи", "до встречи", "пока",
        "всего доброго", "всего хорошего", "удачи",
        "хорошего дня", "хорошего вечера", "отличного дня",
        "спасибо пока", "спасибо до связи", "благодарю пока",
        "бай", "пока-пока", "чао", "на сегодня всё",
    ],

    # Благодарность
    "gratitude": [
        "спасибо", "благодарю", "большое спасибо", "огромное спасибо",
        "спасибо за информацию", "спасибо за помощь",
        "благодарю за консультацию", "очень благодарен",
        "признателен за помощь", "спасибо что помогли",
    ],

    # Болтовня/Small talk
    "small_talk": [
        "как дела", "как жизнь", "как настроение", "как сам",
        "что нового", "что новенького", "как выходные провели",
        "как праздники", "какая погода", "хорошая погода сегодня",
    ],

    # Неясно/Уточнение
    "unclear": [
        "что", "ась", "чего", "не понял", "не понятно",
        "что это", "повторите пожалуйста", "ещё раз скажите",
        "не расслышал", "переформулируйте", "можно подробнее",
        "что имеете в виду", "что вы сказали",
    ],

    # Phase 3: Circular Flow
    "go_back": [
        "вернуться назад", "давай вернёмся", "хочу вернуться",
        "можно назад", "подождите минутку", "стоп погодите",
        "давай помедленнее", "не так быстро", "притормози",
    ],
    "correct_info": [
        "я ошибся", "не так сказал", "уточню",
        "на самом деле", "я имел в виду", "исправляюсь",
        "не совсем так", "правильнее будет", "я перепутал",
        "давайте заново", "с начала", "не то сказал",
    ],

    # =================================================================
    # ДОПОЛНИТЕЛЬНЫЕ ВОЗРАЖЕНИЯ (Phase 4 coverage)
    # =================================================================

    "objection_complexity": [
        # Сложность внедрения
        "слишком сложно внедрять", "долго настраивать систему",
        "много работы с переходом", "придётся переучивать команду",
        "интеграция займёт месяцы", "нет ресурсов на внедрение",
        "потребует много сил", "процесс миграции пугает",
        "боюсь что всё сломается", "переход будет болезненным",
        "надо переносить данные", "сотрудники будут сопротивляться",
        "нет времени на обучение", "слишком много возни",
        # Дополнительные
        "сложно разобраться", "слишком запутанная система",
        "непростой переход", "долгое внедрение",
        "нужен специалист для настройки", "без айтишника не разберёмся",
    ],

    "objection_trust": [
        # Недоверие
        "не уверен что это работает", "сомневаюсь в результате",
        "а есть гарантии", "кто ещё пользуется вашей системой",
        "покажите отзывы клиентов", "откуда мне знать что не обманете",
        "звучит слишком хорошо", "не верю в такие обещания",
        "какие есть доказательства", "а что если не поможет",
        "можете подтвердить результаты", "хочу увидеть референсы",
        "кейсы из нашей отрасли есть", "почему должен вам доверять",
        # Дополнительные
        "нужны доказательства", "чем докажете", "хочу примеры",
        "есть реальные клиенты", "можно поговорить с вашими клиентами",
        "сколько лет на рынке", "кто за вами стоит",
    ],

    "objection_timing": [
        # Отложить на время
        "не сейчас", "давайте после нового года",
        "перезвоните через месяц", "в следующем квартале обсудим",
        "после праздников вернёмся", "сейчас не лучшее время",
        "подождите до весны", "может быть в следующем году",
        "пока рано об этом говорить", "через полгода напомните",
        "после отпуска созвонимся", "ближе к концу года",
        "когда бюджет сформируем", "после закрытия проекта",
        # Дополнительные
        "давайте отложим", "не в этом месяце", "в другой раз",
        "может потом", "ещё не время", "напишите позже",
    ],

    "objection_no_need": [
        # Нет потребности
        "нам это не нужно", "справляемся без CRM",
        "и так всё работает", "обойдёмся своими силами",
        "нет такой проблемы", "не вижу смысла в этом",
        "нам не требуется автоматизация", "мы маленькие нам не надо",
        "обходимся без этого", "хватает текущих инструментов",
        "excel нас устраивает", "ведём всё в блокноте",
        "зачем нам это нужно", "лишняя трата ресурсов",
        # Дополнительные
        "не нуждаемся", "без этого обойдёмся", "и так хорошо",
        "текущих решений достаточно", "работаем по старинке",
        "нам хватает того что есть", "не видим необходимости",
    ],

    "info_provided": [
        # Информация о бизнесе
        "мы занимаемся продажами", "у нас 10 менеджеров",
        "работаем с корпоративными клиентами", "основной канал сайт",
        "средний чек 50 тысяч", "продаём услуги",
        # Дополнительные
        "у нас ресторан", "у нас магазин", "у нас салон",
        "работаем в сфере услуг", "занимаемся оптовой торговлей",
        "в команде 5 человек", "оборот миллион в месяц",
        "клиентов около 100", "работаем на рынке 3 года",
    ],

    "contact_provided": [
        # Контактные данные
        "мой номер", "вот телефон", "записывайте номер",
        "пишите на почту", "вот мой email", "моя почта",
        "звоните по этому номеру", "мой телеграм",
        "напишите в WhatsApp", "вот визитка",
        # Дополнительные
        "контакт для связи", "связаться можно по",
        "лучше на почту", "пишите сюда", "вот мои контакты",
    ],
}

# Веса для разных методов классификации (из settings.yaml)
CLASSIFIER_CONFIG = {
    "root_match_weight": settings.classifier.weights.root_match,
    "phrase_match_weight": settings.classifier.weights.phrase_match,
    "lemma_match_weight": settings.classifier.weights.lemma_match,
    "high_confidence_threshold": settings.classifier.thresholds.high_confidence,
    "min_confidence": settings.classifier.thresholds.min_confidence,
    # Веса для слияния результатов классификаторов (disambiguation)
    # root_classifier_weight + lemma_classifier_weight должны = 1.0
    "root_classifier_weight": getattr(
        getattr(settings.classifier, "merge_weights", None),
        "root_classifier", 0.6
    ) if hasattr(settings.classifier, "merge_weights") else 0.6,
    "lemma_classifier_weight": getattr(
        getattr(settings.classifier, "merge_weights", None),
        "lemma_classifier", 0.4
    ) if hasattr(settings.classifier, "merge_weights") else 0.4,
}

# =============================================================================
# DISAMBIGUATION CONFIG (уточнение намерения при близких scores)
# =============================================================================

DISAMBIGUATION_CONFIG = {
    # Минимальный confidence для рассмотрения
    "min_confidence_threshold": 0.4,

    # Максимальный разрыв между top-1 и top-2
    "max_score_gap": 0.15,

    # Количество опций для показа пользователю
    "max_options": 3,

    # Минимальный confidence опции для включения
    "min_option_confidence": 0.25,

    # Исключённые интенты (не показывать в disambiguation)
    "excluded_intents": ["unclear", "small_talk"],

    # Интенты которые не требуют disambiguation даже при близких scores
    "bypass_disambiguation_intents": [
        "rejection",
        "contact_provided",
        "demo_request",
    ],

    # Cooldown: не показывать disambiguation N ходов после предыдущего
    "cooldown_turns": 3,
}

# =============================================================================
# ИНТЕНТЫ-ВОПРОСЫ (требуют ответа из базы знаний)
# =============================================================================
# Принцип: когда клиент задаёт вопрос, бот должен СНАЧАЛА ответить,
# а ПОТОМ продолжить квалификацию/продажу

QUESTION_INTENTS = {
    "question_features",      # Что такое? Какие функции?
    "question_integrations",  # С чем интегрируется?
    "price_question",         # Сколько стоит?
    "pricing_details",        # Детали по ценам, что входит?
    "comparison",             # Сравнение с конкурентами
    "consultation_request",   # Запрос консультации
}

# =============================================================================
# СОСТОЯНИЯ И ПЕРЕХОДЫ
# =============================================================================

SALES_STATES = {
    "greeting": {
        "goal": "Поздороваться и узнать чем помочь",
        "required_data": [],
        "transitions": {
            # Переход в SPIN: начинаем с Situation
            "price_question": "spin_situation",
            "question_features": "spin_situation",
            "question_integrations": "spin_situation",
            "agreement": "spin_situation",
            "info_provided": "spin_situation",
            # Сравнение и детали по цене — тоже вопросы, переходим в SPIN
            "comparison": "spin_situation",
            "pricing_details": "spin_situation",
            # Запрос консультации — проявление интереса
            "consultation_request": "spin_situation",
            # Клиент сразу хочет демо или звонок — переходим в close
            "demo_request": "close",
            "callback_request": "close",
            # На rejection сразу мягко закрываем
            "rejection": "soft_close",
            # Прощание — мягко завершаем
            "farewell": "soft_close",
            # Возражения — цена и конкурент можно отработать, время/думать → мягкое закрытие
            "objection_price": "handle_objection",
            "objection_competitor": "handle_objection",
            "objection_no_time": "soft_close",
            "objection_think": "soft_close",
        },
        "rules": {
            # На приветствие просто здороваемся
            "greeting": "greet_back",
            # На непонятное — спрашиваем чем помочь
            "unclear": "ask_how_to_help",
            # На благодарность — кратко ответить и спросить чем помочь
            "gratitude": "acknowledge_and_continue",
            # Small talk — поддержать и узнать чем помочь
            "small_talk": "small_talk_and_continue",
        }
    },

    # =================================================================
    # SPIN SELLING: 4 фазы квалификации
    # =================================================================

    # S - Situation: понять текущую ситуацию клиента
    "spin_situation": {
        "goal": "Понять текущую ситуацию клиента (размер, инструменты, процессы)",
        "spin_phase": "situation",
        "required_data": ["company_size"],
        "optional_data": ["current_tools", "business_type"],
        "transitions": {
            "data_complete": "spin_problem",
            # SPIN progress: клиент рассказал о ситуации — переходим к проблемам
            "situation_provided": "spin_problem",
            # info_provided тоже переводит на следующую фазу (унификация с situation_provided)
            "info_provided": "spin_problem",
            "rejection": "soft_close",
            # Клиент сразу хочет демо или звонок — переходим в close
            "demo_request": "close",
            "callback_request": "close",
            # Прощание — мягко завершаем
            "farewell": "soft_close",
            # Возражения — обрабатываем: цена и конкурент → handle_objection, время/думать → soft_close
            "objection_price": "handle_objection",
            "objection_competitor": "handle_objection",
            "objection_no_time": "soft_close",
            "objection_think": "soft_close",
        },
        "rules": {
            # Conditional: если есть данные для цены, клиент раздражён или повторный запрос — отвечаем
            # Phase 5: Добавлены context-aware условия (should_answer_directly, client_stuck)
            "price_question": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "pricing_details": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "comparison": "answer_and_continue",
            "consultation_request": "acknowledge_and_continue",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            # При неясных ответах — переспрашиваем о ситуации
            # Phase 5: если застряли — переключаемся на clarify
            "unclear": [
                {"when": "client_stuck", "then": "clarify_one_question"},
                "probe_situation"
            ],
            "small_talk": "small_talk_and_continue",
            "gratitude": "acknowledge_and_continue",
        }
    },

    # P - Problem: выявить проблемы и боли
    "spin_problem": {
        "goal": "Выявить проблемы и боли клиента",
        "spin_phase": "problem",
        "required_data": ["pain_point"],
        "transitions": {
            "data_complete": "spin_implication",
            # SPIN progress: клиент раскрыл проблему — переходим к последствиям
            "problem_revealed": "spin_implication",
            # info_provided с pain_point тоже переводит на следующую фазу
            "info_provided": "spin_implication",
            "rejection": "soft_close",
            # Если клиент уже явно выразил интерес — можно пропустить I и N
            "agreement": "presentation",
            # Если клиент говорит "нет проблем" — пробуем показать скрытые последствия
            "no_problem": "spin_implication",
            # Клиент сразу хочет демо или звонок — переходим в close
            "demo_request": "close",
            "callback_request": "close",
            # Прощание — мягко завершаем
            "farewell": "soft_close",
            # Возражения — обрабатываем: цена и конкурент → handle_objection, время/думать → soft_close
            "objection_price": "handle_objection",
            "objection_competitor": "handle_objection",
            "objection_no_time": "soft_close",
            "objection_think": "soft_close",
        },
        "rules": {
            # Conditional: если есть данные для цены, клиент раздражён или повторный запрос — отвечаем
            # Phase 5: Добавлены context-aware условия
            "price_question": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "pricing_details": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "comparison": "answer_and_continue",
            "consultation_request": "acknowledge_and_continue",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            # Если клиент неясно ответил — переспрашиваем о проблемах
            # Phase 5: если застряли — переключаемся на clarify
            "unclear": [
                {"when": "client_stuck", "then": "clarify_one_question"},
                {"when": "client_oscillating", "then": "summarize_and_clarify"},
                "probe_problem"
            ],
            "small_talk": "small_talk_and_continue",
            "gratitude": "acknowledge_and_continue",
        }
    },

    # I - Implication: показать последствия проблем (квантифицировать)
    "spin_implication": {
        "goal": "Помочь осознать последствия и масштаб проблемы",
        "spin_phase": "implication",
        # ВАЖНО: implication_probed устанавливается при ВХОДЕ в фазу (state_machine.py:608)
        # Семантика: "мы вошли в I-фазу", предотвращает пропуск фазы при первом неясном ответе
        "required_data": ["implication_probed"],
        "optional_data": ["pain_impact", "financial_impact"],
        "transitions": {
            "data_complete": "spin_need_payoff",
            "rejection": "soft_close",
            # Если клиент уже понимает масштаб — переходим дальше
            "agreement": "spin_need_payoff",
            "implication_acknowledged": "spin_need_payoff",
            # Если клиент говорит "нет проблем" даже на I-вопрос — идём к N
            "no_problem": "spin_need_payoff",
            # Клиент сразу хочет демо или звонок — переходим в close
            "demo_request": "close",
            "callback_request": "close",
            # Прощание — мягко завершаем
            "farewell": "soft_close",
            # Возражения — обрабатываем: цена и конкурент → handle_objection, время/думать → soft_close
            "objection_price": "handle_objection",
            "objection_competitor": "handle_objection",
            "objection_no_time": "soft_close",
            "objection_think": "soft_close",
        },
        "rules": {
            # Conditional: если есть данные для цены, клиент раздражён или повторный запрос — отвечаем
            # Phase 5: Добавлены context-aware условия
            "price_question": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "pricing_details": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "comparison": "answer_and_continue",
            "consultation_request": "acknowledge_and_continue",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            # При неясных ответах — переспрашиваем о последствиях
            # Phase 5: если застряли — переключаемся на clarify
            "unclear": [
                {"when": "client_stuck", "then": "clarify_one_question"},
                {"when": "client_oscillating", "then": "summarize_and_clarify"},
                "probe_implication"
            ],
            "small_talk": "small_talk_and_continue",
            "gratitude": "acknowledge_and_continue",
        }
    },

    # N - Need-Payoff: клиент сам формулирует ценность решения
    "spin_need_payoff": {
        "goal": "Помочь клиенту сформулировать ценность решения",
        "spin_phase": "need_payoff",
        # ВАЖНО: need_payoff_probed устанавливается при ВХОДЕ в фазу (state_machine.py:610)
        # Семантика: "мы вошли в N-фазу", предотвращает пропуск фазы при первом неясном ответе
        "required_data": ["need_payoff_probed"],
        "optional_data": ["desired_outcome", "value_acknowledged"],
        "transitions": {
            "data_complete": "presentation",
            "agreement": "presentation",
            "need_expressed": "presentation",
            "rejection": "soft_close",
            # Если клиент не видит ценности — мягко завершаем
            "no_need": "soft_close",
            # Клиент сразу хочет демо или звонок — переходим в close
            "demo_request": "close",
            "callback_request": "close",
            # Прощание — мягко завершаем
            "farewell": "soft_close",
            # Возражения — обрабатываем: цена и конкурент → handle_objection, время/думать → soft_close
            "objection_price": "handle_objection",
            "objection_competitor": "handle_objection",
            "objection_no_time": "soft_close",
            "objection_think": "soft_close",
        },
        "rules": {
            # Conditional: если есть данные для цены, клиент раздражён или повторный запрос — отвечаем
            # Phase 5: Добавлены context-aware условия
            "price_question": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "pricing_details": [
                {"when": "can_answer_price", "then": "answer_with_facts"},
                {"when": "should_answer_directly", "then": "answer_with_facts"},
                "deflect_and_continue"
            ],
            "comparison": "answer_and_continue",
            "consultation_request": "acknowledge_and_continue",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            # При неясных ответах — переспрашиваем о ценности
            # Phase 5: если застряли — переключаемся на clarify
            "unclear": [
                {"when": "client_stuck", "then": "clarify_one_question"},
                {"when": "client_oscillating", "then": "summarize_and_clarify"},
                "probe_need_payoff"
            ],
            "small_talk": "small_talk_and_continue",
            "gratitude": "acknowledge_and_continue",
        }
    },

    "presentation": {
        "goal": "Показать ценность продукта",
        "required_data": [],
        "transitions": {
            "agreement": "close",
            "objection_price": "handle_objection",
            "rejection": "soft_close",
            # Клиент хочет демо или звонок — переходим в close
            "demo_request": "close",
            "callback_request": "close",
            # FIX: consultation_request = сильный сигнал интереса → close
            "consultation_request": "close",
            # Прощание — мягко завершаем
            "farewell": "soft_close",
            # Возражения по времени и "надо подумать" — обрабатываем
            "objection_no_time": "handle_objection",
            "objection_think": "handle_objection",
            # Возражение по конкуренту — обрабатываем
            "objection_competitor": "handle_objection",
        },
        "rules": {
            "price_question": "answer_with_facts",
            "pricing_details": "answer_with_facts",
            "comparison": "answer_and_continue",
            "consultation_request": "acknowledge_and_continue",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            "small_talk": "small_talk_and_continue",
            "gratitude": "acknowledge_and_continue",
            "unclear": "clarify_and_continue",
        }
    },

    "handle_objection": {
        "goal": "Отработать возражение",
        "required_data": [],
        "transitions": {
            "agreement": "close",
            "rejection": "soft_close",
            # Клиент хочет демо или звонок — переходим в close
            "demo_request": "close",
            "callback_request": "close",
            # Прощание — мягко завершаем
            "farewell": "soft_close",
            # Conditional: при достижении лимита возражений → soft_close
            "objection_price": [
                {"when": "objection_limit_reached", "then": "soft_close"},
                "handle_objection"
            ],
            "objection_no_time": [
                {"when": "objection_limit_reached", "then": "soft_close"},
                "handle_objection"
            ],
            "objection_think": [
                {"when": "objection_limit_reached", "then": "soft_close"},
                "handle_objection"
            ],
            "objection_competitor": [
                {"when": "objection_limit_reached", "then": "soft_close"},
                "handle_objection"
            ],
            # FIX: Вопросы = сигнал интереса, клиент пересматривает решение
            # Выходим из handle_objection обратно в presentation/close
            "question_features": "presentation",
            "question_integrations": "presentation",
            "comparison": "presentation",
            "consultation_request": "close",  # Сильный сигнал интереса!
            # info_provided = клиент даёт контекст, возвращаем в квалификацию
            "info_provided": "spin_situation",
        },
        "rules": {
            # Conditional: если есть данные для ROI — отвечаем с расчётом
            "price_question": [
                {"when": "can_handle_with_roi", "then": "answer_with_roi"},
                "answer_with_facts"
            ],
            "pricing_details": [
                {"when": "can_handle_with_roi", "then": "answer_with_roi"},
                "answer_with_facts"
            ],
            "comparison": "answer_and_continue",
            "consultation_request": "acknowledge_and_continue",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            "small_talk": "small_talk_and_continue",
            "gratitude": "acknowledge_and_continue",
            "unclear": "clarify_and_continue",
        }
    },

    "close": {
        "goal": "Взять контакт или назначить демо",
        "required_data": ["contact_info"],
        "transitions": {
            "data_complete": "success",
            # Клиент предоставил контакт — успешное завершение
            "contact_provided": "success",
            # Conditional: если контакт уже есть — сразу success, иначе продолжаем
            "agreement": [
                {"when": "ready_for_close", "then": "success"},
                "close"
            ],
            # Демо-запрос: если контакт есть — успех, иначе продолжаем собирать
            "demo_request": [
                {"when": "ready_for_close", "then": "success"},
                "close"
            ],
            "callback_request": [
                {"when": "ready_for_close", "then": "success"},
                "close"
            ],
            "consultation_request": [
                {"when": "ready_for_close", "then": "success"},
                "close"
            ],
            "rejection": "soft_close",
            # Прощание без контакта — мягко завершаем
            "farewell": "soft_close",
            # Возражения — возвращаемся к обработке возражений
            "objection_price": "handle_objection",
            "objection_no_time": "handle_objection",
            "objection_think": "handle_objection",
            "objection_competitor": "handle_objection",
        },
        "rules": {
            # На вопросы — отвечаем и продолжаем собирать контакт
            "price_question": "answer_with_facts",
            "pricing_details": "answer_with_facts",
            "comparison": "answer_and_continue",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            "small_talk": "small_talk_and_continue",
            "gratitude": "acknowledge_and_continue",
            "unclear": "clarify_and_continue",
            # info_provided — клиент дает информацию, продолжаем
            "info_provided": "continue_current_goal",
        }
    },

    "success": {
        "goal": "Завершить успешно",
        "is_final": True
    },

    "soft_close": {
        "goal": "Вежливо завершить, но дать возможность вернуться",
        "is_final": False,  # Не финальное — клиент может передумать
        "transitions": {
            # Если клиент передумал — даём новый шанс
            "agreement": "spin_situation",
            "demo_request": "close",
            "callback_request": "close",
            # Если клиент сам хочет вернуться
            "go_back": "greeting",
            "correct_info": "greeting",
            # Если твёрдо отказывается — остаёмся (но не бесконечно)
            "rejection": "soft_close",
            "farewell": "soft_close",
            # FIX: Вопросы = проявление интереса → возвращаем в диалог
            # Если клиент задаёт вопросы в soft_close, он ещё не ушёл
            "price_question": "presentation",
            "pricing_details": "presentation",  # Детали по ценам = интерес
            "question_features": "spin_situation",
            "question_integrations": "spin_situation",
            "comparison": "presentation",  # Сравнение = выбирает между вариантами
            "consultation_request": "close",  # Хочет консультацию = сильный интерес!
            # info_provided = клиент отвечает на вопросы → продолжаем диалог
            "info_provided": "spin_situation",
            "situation_provided": "spin_situation",
        },
        "rules": {
            # На вопросы — отвечаем (transitions выше обеспечат переход)
            "price_question": "answer_with_facts",
            "pricing_details": "answer_with_facts",
            "question_features": "answer_and_continue",
            "question_integrations": "answer_and_continue",
            "comparison": "answer_and_continue",
            "gratitude": "acknowledge_farewell",
            "small_talk": "polite_farewell",
        }
    }
}

# =============================================================================
# БАЗА ЗНАНИЙ
# =============================================================================

# DEPRECATED: KNOWLEDGE["pricing"] and ["discount_annual"] removed — SSOT is pricing.yaml
# Migration: All pricing data now sourced from knowledge retriever (src/yaml_config/knowledge/pricing.yaml)
# Context: Fix currency desynchronization (₽ → ₸), eliminate hardcoded prices, enforce SSOT principle
# "features" already removed (SSOT is knowledge retriever)
KNOWLEDGE = {}

# =============================================================================
# CATEGORY ROUTER PROMPT
# =============================================================================

CATEGORY_ROUTER_PROMPT = """Определи категории для поиска в базе знаний Wipon (система автоматизации торговли в Казахстане).

КАТЕГОРИИ (выбирай ТОЛЬКО из этого списка):

equipment (316 секций) — оборудование и периферия:
  сканеры штрихкодов, принтеры чеков, весы, POS-терминалы, ТСД,
  совместимость устройств, USB/Bluetooth подключение, какой сканер/принтер выбрать
  КОНКРЕТНЫЕ модели и характеристики оборудования

pricing (286 секций) — цены и тарифы:
  тарифы Mini/Lite/Standard/Pro, сколько стоит, стоимость подписки,
  рассрочка на оборудование, ежемесячный платёж, прайс-лист, кредиты

products (273 секции) — ПРОДУКТЫ И ВЫБОР РЕШЕНИЯ:
  Wipon Desktop, Wipon Kassa, Wipon Pro, Wipon ТИС, Wipon Cashback
  ЧТО ПОДОЙДЁТ для магазина/кафе/фастфуда/бутика/стройматериалов/рынка
  ЧТО ПОСОВЕТУЕТЕ, какую программу выбрать, демо-версия
  Работает ли на Windows/Mac, для сети магазинов, для франшизы
  Можно ли без бухгалтера, о компании, кейсы успеха, системные требования

support (201 секция) — техподдержка и обучение:
  как связаться, обучение кассиров, настройка системы, внедрение, миграция,
  консультации, удалённая помощь, выезд специалиста, переход с других систем
  партнёрская программа, контакты, как начать работу

tis (191 секция) — трёхкомпонентная система для ИП на упрощёнке:
  что такое ТИС, лимиты по доходу и НДС, подключение ТИС, сертификация,
  ТИС vs обычная касса, нужен ли ТИС, налоговые вопросы ИП

regions (130 секций) — регионы и доставка оборудования:
  работаете ли в моём городе (Алматы, Астана, Шымкент, Караганда...),
  доставка оборудования, география работы, по всему Казахстану, офисы компании

inventory (93 секции) — товары и склад:
  остатки, приход товара, списание, перемещение между складами, инвентаризация,
  учёт товаров, большой ассортимент, где товар, расхождения остатков

features (90 секций) — ФУНКЦИИ ВНУТРИ ПРОГРАММЫ:
  печать ценников и этикеток, логотип на чеке, работа с валютами
  доставка заказов (модуль доставки), две валюты, мультивалюта
  возможности программы (общие вопросы о функционале)

integrations (86 секций) — интеграции с внешними сервисами:
  Kaspi.kz, Halyk Market, банки, эквайринг, POS-терминалы,
  маркировка товаров, 1С, ОФД, синхронизация заказов, API

fiscal (68 секций) — фискализация:
  чеки, ОФД, отправка в налоговую, статус фискализации,
  ошибки фискализации, автопробитие чеков, фискальный признак

analytics (63 секции) — аналитика и отчёты:
  себестоимость, расчёт прибыли, отчёты по продажам, статистика,
  топ продаж, ABC-анализ, выручка, финансовые показатели

employees (55 секций) — сотрудники и кадры:
  кассиры, отчёты по продажам сотрудника, кто сколько продал,
  история действий, ошибочное списание, доступы сотрудников

stability (45 секций) — надёжность и стабильность:
  работа офлайн (без интернета), восстановление данных, зависания,
  резервное копирование, данные не пропадут, слабый интернет
  безопасность данных, SLA, шифрование, защита

mobile (35 секций) — мобильное приложение:
  доступ с телефона, удалённый просмотр продаж и остатков,
  приложение iOS/Android, синхронизация с телефоном

promotions (26 секций) — акции и скидки:
  автоматические скидки, расписание акций, скидки по времени,
  программа лояльности, бонусы, кэшбэк

competitors (7 секций) — СРАВНЕНИЕ С КОНКУРЕНТАМИ:
  wipon vs iiko, wipon vs poster, wipon vs 1c, wipon vs umag
  почему wipon лучше, чем отличается, переход с конкурентов

faq (4 секции) — общие частые вопросы

---

ПРИМЕРЫ КЛАССИФИКАЦИИ:
"Что посоветуете для маленького магазина?" → ["products", "equipment", "pricing"]
"подойдёт для фастфуда?" → ["products", "features", "equipment"]
"wipon работает на mac?" → ["products", "support", "features"]
"можно без бухгалтера работать?" → ["products", "tis", "features"]
"есть ли доставка в программе?" → ["features", "integrations", "products"]
"печать ценников" → ["features", "equipment", "inventory"]
"какой сканер лучше?" → ["equipment", "support", "products"]
"работаете в караганде?" → ["regions", "support", "equipment"]
"wipon vs iiko" → ["competitors", "products", "pricing"]
"чем лучше умаг?" → ["competitors", "products", "support"]

---

Запрос клиента: {query}

Выбери {top_k} наиболее подходящих категорий для поиска ответа.
Ответь ТОЛЬКО JSON массивом без пояснений: ["category1", "category2"]"""


# Structured Output версия для Ollama
CATEGORY_ROUTER_PROMPT_STRUCTURED = """/no_think
Определи категории для поиска в базе знаний Wipon.

КАТЕГОРИИ: analytics, competitors, employees, equipment, faq, features, fiscal, integrations, inventory, mobile, pricing, products, promotions, regions, stability, support, tis

ПРИМЕРЫ:
"Что посоветуете для маленького магазина?" → products, equipment, pricing
"какой сканер лучше?" → equipment, support, products
"работаете в караганде?" → regions, support, equipment
"wipon vs iiko" → competitors, products, pricing

Запрос: {query}

Выбери {top_k} подходящих категорий."""


# =============================================================================
# ШАБЛОНЫ ПРОМПТОВ
# =============================================================================

SYSTEM_PROMPT = """Ты менеджер по продажам CRM-системы.

СТРОГО: Отвечай ТОЛЬКО на русском языке. Никогда не переключайся на другие языки.

=== СТИЛЬ ОБЩЕНИЯ ===
- Звучи как живой человек, а не как робот
- Используй разговорные конструкции: "Кстати...", "Вот что важно...", "Смотрите..."
- Избегай шаблонных фраз: "Отлично!", "Спасибо за информацию!", "Рад помочь!"
- Никогда не повторяй одну и ту же фразу дважды

=== ДЛИНА ОТВЕТОВ ===
- Максимум 2-3 предложения
- Максимум 50-60 слов
- Лучше недосказать, чем перегрузить

=== СТРУКТУРА ===
- Короткая реакция (опционально) → Суть ответа
- Если клиент раздражён — ещё короче, без вступлений

=== БЕЗОПАСНОСТЬ ===
- Никогда не выдавай логины, пароли или учётные данные в чат
- Для демо-доступа направляй клиента оставить контактные данные

{tone_instruction}
{style_instruction}"""


# Базовый SYSTEM_PROMPT без tone_instruction (для обратной совместимости)
SYSTEM_PROMPT_BASE = """Ты менеджер по продажам CRM-системы.

СТРОГО: Отвечай ТОЛЬКО на русском языке. Никогда не переключайся на другие языки.

Правила общения:
- Говори на "вы", дружелюбно, без давления
- Отвечай кратко: 2-3 предложения максимум
- Задавай только ОДИН вопрос за раз"""

PROMPT_TEMPLATES = {
    "greet_back": """{system}

Задача: Просто поздороваться в ответ и спросить чем можете помочь.
НЕ задавай вопросов о компании или команде — просто узнай что интересует клиента.

Клиент: "{user_message}"

Ответ на русском (1-2 коротких предложения):""",

    "ask_how_to_help": """{system}

Задача: Вежливо спросить чем можете помочь.
НЕ задавай конкретных вопросов — просто узнай что интересует клиента.

Диалог:
{history}

Клиент: "{user_message}"

Ответ на русском (1-2 коротких предложения):""",

    "greeting": """{system}

Задача: Поздороваться и спросить чем можете помочь.
Клиент: "{user_message}"

Ответ на русском (1-2 предложения):""",

    "deflect_and_continue": """{system}

Ситуация: Клиент спросил о цене, но мы не знаем размер его команды.

Диалог:
{history}

Клиент: "{user_message}"

Структура ответа:
1. Признай вопрос о цене (покажи что услышал)
2. Объясни что цена зависит от количества пользователей
3. Спроси сколько человек будет работать

Пример: "Хороший вопрос! Стоимость зависит от размера команды. Подскажите, сколько человек будет пользоваться системой?"

Задай ОДИН вопрос. Ответ на русском (2 предложения):""",

    "continue_current_goal": """{system}

Цель этапа: {goal}
Уже знаем о клиенте: {collected_data}
Нужно узнать: {missing_data}

Диалог:
{history}

Клиент: "{user_message}"

ВАЖНО - структура ответа:
1. СНАЧАЛА кратко отреагируй на слова клиента (признай проблему, вырази понимание)
2. ПОТОМ естественно перейди к вопросу, который продвигает цель этапа ({goal})

Примеры хороших переходов (чередуй стили, НЕ используй одинаковые вступления):
- "Низкие продажи — серьёзный вызов. Чтобы понять как помочь, подскажите — сколько человек у вас в команде продаж?"
- "Да, потеря клиентов — частая боль. А сколько менеджеров сейчас работает с клиентами?"
- "Это важный момент. Скажите, сколько человек будет пользоваться системой?"
- "[Сразу к делу без вступления] Сколько человек работает в вашей команде?"

Если нужно узнать company_size — спроси сколько человек в команде/продажах.
Если нужно узнать pain_point — спроси какую задачу хотят решить или что не устраивает сейчас.

Задай только ОДИН вопрос. Не начинай с "Отлично!" или "Спасибо!".
Ответ на русском (2 предложения: реакция + вопрос):""",

    "presentation": """{system}

{style_full_instruction}

Информация о клиенте:
- Размер команды: {bc_size_label} ({company_size} человек)
- Категория: {size_category}
- Проблема: {pain_point}
- Отрасль: {industry} (уверенность: {industry_confidence}%)
- Типичные боли отрасли: {ic_pain_examples}
- Примеры для отрасли: {ic_examples}
{pain_reference}

{effective_actions_hint}

Наш продукт: {product_overview}
Фокус боли для этого размера: {bc_pain_focus}
Ценностное предложение: {bc_value_prop}
Питч демо: {bc_demo_pitch}

Диалог:
{history}

Клиент: "{user_message}"

Структура ответа:
1. Кратко отреагируй на последнее сообщение клиента (покажи что услышал)
2. Покажи как наш продукт решает именно ЕГО проблему ({pain_point})
3. Используй ценностное предложение подходящее для размера компании
4. Спроси готов ли попробовать или есть вопросы

Пример: "Да, с {bc_size_label} это особенно актуально. Наша CRM поможет [решение проблемы]. Хотите посмотреть как это работает?"

Ответ на русском (3-4 предложения):""",

    "handle_objection": """{system}

{style_full_instruction}

Тип возражения: {objection_type}
Информация о клиенте:
- Размер: {bc_size_label} ({company_size} человек)
- Отрасль: {industry}
- Проблема: {pain_point}
{pain_reference}

Контраргумент: {objection_counter}
Контраргумент для размера: {bc_objection_counter}

{effective_actions_hint}

Наш продукт: {product_overview}

Диалог:
{history}

Клиент: "{user_message}"

Структура ответа:
1. СНАЧАЛА признай опасения клиента (покажи что понимаешь)
2. ПОТОМ мягко отработай возражение используя контраргумент выше
3. Не дави, сохраняй эмпатию

Ответ на русском (2-3 предложения, без давления, с эмпатией):""",

    "handle_objection_price": """{system}

{style_full_instruction}

Ситуация: Клиент говорит что дорого.
Информация о клиенте:
- Размер: {bc_size_label} ({company_size} человек), категория: {size_category}
- Отрасль: {industry} (уверенность: {industry_confidence}%)
- Проблема: {pain_point}
- Фокус боли: {bc_pain_focus}
{pain_reference}

Контраргумент для этого размера бизнеса: {bc_objection_counter}
Ценностное предложение: {bc_value_prop}
Общий контраргумент: {objection_counter}

{effective_actions_hint}

Диалог:
{history}

Клиент: "{user_message}"

Структура ответа:
1. Признай опасения клиента (эмпатия важна!)
2. Используй один из аргументов подходящих для {bc_size_label}:
   - Контраргумент: {bc_objection_counter}
   - Сравни с ценой проблемы ("сколько теряете на {pain_point}...")
   - Раздели на день/человека
   - Упомяни скидку 20% за год

Ответ на русском (2-3 предложения):""",

    "handle_objection_competitor": """{system}

{style_full_instruction}

Ситуация: Клиент говорит что уже использует другую CRM/систему.

=== ИНФОРМАЦИЯ О КОНКУРЕНТАХ (используй для сравнения) ===
{retrieved_facts}
===========================================================

Информация о клиенте:
- Размер: {bc_size_label} ({company_size} человек)
- Отрасль: {industry}
- Проблема: {pain_point}

Диалог:
{history}

Клиент: "{user_message}"

Структура ответа:
1. Признай что другие системы тоже хороши (покажи уважение к выбору)
2. Используй ФАКТЫ ВЫШЕ для сравнения (НЕ придумывай!)
3. Предложи посмотреть демо — вдруг понравится больше

ВАЖНО: Если клиент упомянул конкретную систему (Poster, iiko, R-Keeper) —
используй факты о ней из раздела выше. НЕ игнорируй конкурента!

Ответ на русском (2-3 предложения):""",

    "answer_with_facts": """{system}

ВАЖНО: Отвечай СТРОГО на основе фактов ниже.
Если информации нет в фактах — скажи "Уточню у коллег и вернусь с ответом".
НЕ ПРИДУМЫВАЙ информацию, которой нет в фактах.

=== ФАКТЫ О ПРОДУКТЕ ===
{retrieved_facts}
========================

Диалог:
{history}

Клиент: "{user_message}"

Ответь точно по фактам выше, на русском (2-3 предложения):""",

    "answer_with_knowledge": """{system}

{style_full_instruction}

ВАЖНО: Отвечай СТРОГО на основе фактов ниже.
Если информации нет в фактах — скажи "Уточню у коллег и сразу вернусь с ответом".
НЕ ПРИДУМЫВАЙ информацию, которой нет.

=== ФАКТЫ О ПРОДУКТЕ ===
{retrieved_facts}
========================

Информация о клиенте:
- Отрасль: {industry}
- Размер: {bc_size_label} ({company_size} человек)
- Потребность: {pain_point}
{pain_reference}

{effective_actions_hint}

Диалог:
{history}

Клиент: "{user_message}"

Ответь кратко (2-3 предложения), используя ТОЛЬКО факты выше.
Ответ на русском:""",

    "answer_question": """{system}

{style_full_instruction}

ВАЖНО: Клиент задал вопрос — ты ОБЯЗАН на него ответить!
Используй ТОЛЬКО факты ниже. Если информации нет — честно скажи что уточнишь.

=== ФАКТЫ О ПРОДУКТЕ ===
{retrieved_facts}
========================

Информация о клиенте:
- Отрасль: {industry}
- Размер: {bc_size_label} ({company_size} человек)
{pain_reference}

{effective_actions_hint}

Диалог:
{history}

Клиент спросил: "{user_message}"

Твоя задача:
1. СНАЧАЛА кратко ответь на вопрос клиента (2-3 предложения)
2. ПОТОМ задай ОДИН уточняющий вопрос чтобы лучше понять потребности
   (например: сколько человек в команде, какие задачи хотите решить)

НЕ игнорируй вопрос клиента! Сначала ответ, потом вопрос.
Ответ на русском:""",

    "soft_close": """{system}

{style_full_instruction}

Ситуация: Клиент не заинтересован или отказывается.

Информация о клиенте:
- Отрасль: {industry}
- Размер: {bc_size_label}
{pain_reference}

Диалог:
{history}

Клиент: "{user_message}"

Структура ответа:
1. Признай решение клиента (без давления, с уважением)
2. Поблагодари за время
3. Оставь дверь открытой (если передумает — всегда рады помочь)

ВАЖНО: Генерируй УНИКАЛЬНЫЙ ответ, адаптированный к контексту. НЕ копируй примеры дословно!

Варианты стилей (выбери и адаптируй под контекст):
- "Хорошо, не буду настаивать. Спасибо за разговор! Будут вопросы — пишите."
- "Понял вас. Рад был пообщаться! Если что-то изменится — всегда на связи."
- "Принято! Спасибо что уделили время. Удачи вам, обращайтесь если понадобится."
- "Без проблем! Благодарю за диалог. Контакты сохраню — вдруг пригодится."
- "Окей, понимаю. Было приятно познакомиться! Если тема станет актуальной — напишите."

Ответ на русском (2 предложения, тепло и без обиды, свой уникальный вариант):""",

    "close": """{system}

{style_full_instruction}

Ситуация: Клиент заинтересован и готов к следующему шагу.

Информация о клиенте:
- Отрасль: {industry}
- Размер: {bc_size_label} ({company_size} человек)
- Проблема: {pain_point}
{pain_reference}

Питч для демо: {bc_demo_pitch}
Ценностное предложение: {bc_value_prop}

{effective_actions_hint}

Диалог:
{history}

Клиент: "{user_message}"

Структура ответа:
1. Позитивно отреагируй на интерес клиента
2. Предложи конкретный следующий шаг (демо или тестовый период)
3. Попроси контакт для связи

Пример: "Отлично, рад что заинтересовались! Давайте запишу вас на демо — покажу систему под ваши задачи. Подскажите удобный номер или почту для связи?"

Ответ на русском (2-3 предложения):""",

    # =================================================================
    # SPIN SELLING ПРОМПТЫ
    # =================================================================

    # S - Situation: понять текущую ситуацию
    "spin_situation": """{system}

ЭТАП: Situation (понять текущую ситуацию клиента)

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем о клиенте: {collected_data}
Осталось узнать: {missing_data}

{do_not_ask}

Твоя задача:
1. СНАЧАЛА кратко отреагируй на слова клиента (1 предложение, покажи эмпатию)
2. ПОТОМ задай ОДИН открытый вопрос о текущей ситуации

{available_questions}

ВАЖНО:
- НЕ спрашивай о том, что уже известно из collected_data
- НЕ задавай вопросы о проблемах — сначала пойми ситуацию
- Задай только ОДИН вопрос
Ответ на русском (2 предложения: реакция + вопрос):""",

    # P - Problem: выявить проблемы
    "spin_problem": """{system}

{style_full_instruction}

ЭТАП: Problem (выявить боли и проблемы)

Информация о клиенте:
- Отрасль: {industry} (уверенность: {industry_confidence}%)
- Размер: {bc_size_label} ({company_size} человек)
- Категория: {size_category}
- Фокус боли для размера: {bc_pain_focus}
- Типичные боли в этой отрасли: {ic_pain_examples}

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем о клиенте: {collected_data}
Осталось узнать: {missing_data}

{do_not_ask}

{effective_actions_hint}

Твоя задача:
1. СНАЧАЛА отреагируй на информацию клиента (покажи что понял ситуацию)
2. ПОТОМ задай ОДИН вопрос о ПРОБЛЕМАХ/ТРУДНОСТЯХ

{available_questions}

ВАЖНО:
- НЕ спрашивай о том, что уже известно из collected_data
- Задай именно вопрос о ПРОБЛЕМЕ, не о желаниях
- Задай только ОДИН вопрос. Адаптируй вопрос под отрасль клиента.
Ответ на русском (2 предложения: реакция + вопрос о проблеме):""",

    # I - Implication: показать последствия
    "spin_implication": """{system}

{style_full_instruction}

ЭТАП: Implication (помочь осознать последствия проблемы)

Информация о клиенте:
- Отрасль: {industry}
- Размер: {bc_size_label} ({company_size} человек)
- Выявленная проблема: {pain_point}
{pain_reference}

Уже знаем о клиенте: {collected_data}
Осталось узнать: {missing_data}

{do_not_ask}

{effective_actions_hint}

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. СНАЧАЛА признай проблему клиента (покажи эмпатию и понимание)
2. ПОТОМ задай ОДИН вопрос о ПОСЛЕДСТВИЯХ этой проблемы

{available_questions}

ВАЖНО:
- НЕ спрашивай о том, что уже известно из collected_data
- Не преувеличивай и не драматизируй
- Просто помоги клиенту ОСОЗНАТЬ масштаб проблемы
- Вопрос должен быть о ПОСЛЕДСТВИЯХ, не о самой проблеме

Задай только ОДИН вопрос.
Ответ на русском (2 предложения: эмпатия + вопрос о последствиях):""",

    # N - Need-Payoff: создать ценность решения
    "spin_need_payoff": """{system}

{style_full_instruction}

ЭТАП: Need-Payoff (клиент сам формулирует ценность решения)

Информация о клиенте:
- Отрасль: {industry}
- Размер: {bc_size_label} ({company_size} человек)
- Проблема: {pain_point}
- Последствия: {pain_impact}
- Ценностное предложение: {bc_value_prop}
{pain_reference}

Уже знаем о клиенте: {collected_data}
Осталось узнать: {missing_data}

{do_not_ask}

{effective_actions_hint}

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. СНАЧАЛА подтверди понимание ситуации (кратко)
2. ПОТОМ задай ОДИН вопрос, чтобы КЛИЕНТ САМ сформулировал ценность решения

{available_questions}

ВАЖНО:
- НЕ спрашивай о том, что уже известно из collected_data
- НЕ говори сам какую пользу принесёт система
- Пусть КЛИЕНТ САМ озвучит желаемый результат
- Это создаёт внутреннюю мотивацию к покупке

Задай только ОДИН вопрос.
Ответ на русском (2 предложения):""",

    # Переход из spin_situation
    "transition_to_spin_problem": """{system}

Клиент рассказал о своей ситуации. Переходим к выявлению проблем.

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Кратко подтверди что понял ситуацию (1 предложение)
2. Плавно перейди к вопросу о трудностях/проблемах

Пример: "Понял, команда из {company_size} человек, работаете в Excel. Скажите, какая главная сложность с текущим учётом?"

Ответ на русском (2 предложения):""",

    # Переход из spin_problem
    "transition_to_spin_implication": """{system}

Клиент озвучил проблему. Помогаем осознать её последствия.

Диалог:
{history}

Клиент: "{user_message}"

Проблема клиента: {pain_point}
Уже знаем: {collected_data}

Твоя задача:
1. Признай проблему с эмпатией (покажи что понимаешь)
2. Задай вопрос о ПОСЛЕДСТВИЯХ этой проблемы

Пример: "Да, путаница в остатках — частая проблема. А как это влияет на продажи? Бывает что клиент уходит без покупки из-за этого?"

Ответ на русском (2 предложения):""",

    # Переход из spin_implication
    "transition_to_spin_need_payoff": """{system}

Клиент осознал последствия проблемы. Помогаем сформулировать ценность решения.

Диалог:
{history}

Клиент: "{user_message}"

Проблема: {pain_point}
Уже знаем: {collected_data}

Твоя задача:
1. Подтверди понимание масштаба проблемы
2. Задай вопрос чтобы клиент САМ озвучил желаемый результат

Пример: "Да, это ощутимые потери. Если бы остатки обновлялись автоматически после каждой продажи — насколько это упростило бы работу?"

Ответ на русском (2 предложения):""",

    # Переход из spin_need_payoff в presentation
    "transition_to_presentation": """{system}

Клиент сформулировал желаемый результат. Переходим к презентации решения.

Диалог:
{history}

Клиент: "{user_message}"

Информация о клиенте:
- Размер: {company_size} человек
- Проблема: {pain_point}
- Желаемый результат: {desired_outcome}

Наш продукт: {product_overview}

Твоя задача:
1. Подтверди что понял потребность клиента
2. Покажи как наш продукт РЕШАЕТ ИМЕННО ЕГО проблему
3. Свяжи функции продукта с его желаемым результатом
4. Спроси готов ли попробовать

ВАЖНО: Презентация должна быть персонализированной под ЕГО ситуацию!

Ответ на русском (3-4 предложения):""",

    # =================================================================
    # PROBE TEMPLATES - переспрашивание при неясных ответах
    # =================================================================

    # Переспросить о ситуации (при unclear в spin_situation)
    "probe_situation": """{system}

СИТУАЦИЯ: Клиент дал неясный ответ на вопрос о текущей ситуации.
Нужно мягко переспросить, чтобы понять его ситуацию.

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Покажи что понял (не критикуй за неясный ответ)
2. Переформулируй вопрос более конкретно
3. Предложи варианты для удобства ответа

Пример: "Понял, давайте уточню — сколько примерно человек у вас занимается продажами или работой с клиентами? 2-3, около 10, или больше?"

Ответ на русском (2 предложения):""",

    # Переспросить о проблемах (при unclear или no_problem в spin_problem)
    "probe_problem": """{system}

СИТУАЦИЯ: Клиент не озвучил конкретную проблему или сказал что проблем нет.
Нужно мягко помочь выявить скрытые сложности.

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Признай ответ клиента (не спорь)
2. Задай вопрос о конкретной рутинной задаче
3. Ищи скрытые неудобства, а не явные проблемы

Хорошие формулировки (чередуй, НЕ повторяй одинаковые вступления):
- "Ясно. А если говорить о рутине — что занимает больше всего времени?"
- "Хорошо. А бывают моменты когда хотелось бы видеть информацию быстрее?"
- "Окей. А как отслеживаете кто из клиентов давно не обращался?"

Ответ на русском (2 предложения):""",

    # Переспросить о последствиях (при unclear в spin_implication)
    "probe_implication": """{system}

СИТУАЦИЯ: Клиент дал неясный ответ на вопрос о последствиях проблемы.
Нужно помочь осознать масштаб, но без давления.

Диалог:
{history}

Клиент: "{user_message}"

Проблема клиента: {pain_point}
Уже знаем: {collected_data}

Твоя задача:
1. Покажи понимание (не настаивай на точных цифрах)
2. Переформулируй вопрос о последствиях проще
3. Предложи примерные рамки для оценки

Хорошие формулировки (чередуй, НЕ повторяй одинаковые вступления):
- "Сложно оценить точно, да. Скажите примерно — это часто случается? Раз в неделю, в месяц?"
- "Да, тут нужно подумать. А в целом — это скорее небольшое неудобство или реально влияет на работу?"
- "Ясно. Если по ощущениям — это отнимает заметное время или терпимо?"

Ответ на русском (2 предложения):""",

    # Переспросить о ценности (при unclear в spin_need_payoff)
    "probe_need_payoff": """{system}

СИТУАЦИЯ: Клиент не смог сформулировать желаемый результат.
Нужно помочь представить идеальную ситуацию.

Диалог:
{history}

Клиент: "{user_message}"

Проблема: {pain_point}
Уже знаем: {collected_data}

Твоя задача:
1. Покажи понимание (это нормально что сложно представить)
2. Предложи конкретный сценарий улучшения
3. Спроси было бы это полезно

Хорошие формулировки (чередуй, НЕ повторяй одинаковые вступления):
- "Сложно сразу представить, да. А если бы вся информация о клиентах была в одном месте и доступна в пару кликов — это упростило бы работу?"
- "Ясно. Давайте так — если бы система сама напоминала о задачах и следующих шагах с клиентами — было бы полезно?"
- "Хороший вопрос. А представьте: все продажи, остатки и заказы видны в реальном времени с телефона — это бы помогло?"

Ответ на русском (2 предложения):""",

    # =================================================================
    # УНИВЕРСАЛЬНЫЕ TEMPLATES для small_talk и gratitude
    # =================================================================

    # Ответить на small talk и продолжить SPIN
    "small_talk_and_continue": """{system}

СИТУАЦИЯ: Клиент отклонился от темы (small talk).
Нужно вежливо ответить и мягко вернуться к делу.

Диалог:
{history}

Клиент: "{user_message}"

Текущая фаза: {spin_phase}
Уже знаем: {collected_data}

Твоя задача:
1. Кратко и дружелюбно ответь на реплику клиента (1 предложение)
2. Плавно верни разговор к теме

Пример: "Спасибо, всё хорошо! Так вот, возвращаясь к вашей ситуации..."

Ответ на русском (2 короткие предложения):""",

    # Поблагодарить и продолжить SPIN
    "acknowledge_and_continue": """{system}

СИТУАЦИЯ: Клиент выразил благодарность в середине разговора.
Нужно принять благодарность и продолжить диалог.

Диалог:
{history}

Клиент: "{user_message}"

Текущая фаза: {spin_phase}
Уже знаем: {collected_data}

Твоя задача:
1. Кратко и тепло ответить на благодарность
2. Продолжить разговор по теме

Пример: "Пожалуйста! Рад помочь. Так вот, продолжая наш разговор..."

Ответ на русском (2 короткие предложения):""",

    # =================================================================
    # PHASE 2: ЕСТЕСТВЕННОСТЬ ДИАЛОГА - НОВЫЕ ПРОМПТЫ
    # =================================================================

    # Ответ на вопрос о цене с диапазоном (заменяет deflect_and_continue в ранних фазах)
    "answer_with_range_and_qualify": """{system}

Клиент спросил о цене. Сначала назови тарифы, потом уточни.

Тарифы: {retrieved_facts}

Диалог:
{history}

Клиент: "{user_message}"

Ответь по структуре:
1. Назови основные тарифы
2. Упомяни что зависит от задач бизнеса
3. Спроси о бизнесе клиента

Пример: "Основные тарифы от 5 000₸/мес (Mini) до 500 000₸/год (Pro) — зависит от ваших задач. Расскажите о вашем бизнесе?"

Ответ на русском (2 предложения, до 40 слов):""",

    # Короткий ответ для раздражённого клиента
    "short_response_frustrated": """{system}

ВАЖНО: Клиент раздражён. Будь МАКСИМАЛЬНО кратким.

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Признай неудобство (одна фраза)
2. Ответь по существу максимально коротко
3. НЕ задавай лишних вопросов

Максимум 1-2 предложения, до 25 слов.

Ответ на русском:""",

    # Ответ с эмпатией (для problem-фазы)
    "empathetic_response": """{system}

КОНТЕКСТ: Клиент озвучил проблему. Покажи что понимаешь.

Диалог:
{history}

Клиент: "{user_message}"

Проблема клиента: {pain_point}
Уже знаем: {collected_data}

Твоя задача:
1. Признай проблему с эмпатией (НЕ шаблонно!)
2. Задай один уточняющий вопрос о последствиях

Примеры эмпатичных реакций (чередуй, НЕ начинай со слова "Понимаю"):
- "Да, знакомая ситуация..."
- "Это реально отнимает силы..."
- "Многие с этим сталкиваются..."

НЕ используй: "Отлично!", "Спасибо за информацию!", "Понимаю вас!", "Понимаю,"

Ответ на русском (2 предложения):""",

    # Ответ неформальным стилем (если клиент общается неформально)
    "informal_response": """{system}

КОНТЕКСТ: Клиент общается неформально. Подстройся под его стиль.

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Ответь в том же неформальном стиле
2. Используй "ты" вместо "вы" если клиент сам на "ты"
3. Можно использовать разговорные выражения

Примеры:
- "Короче, тут такая тема..."
- "Ну смотри, по ценам..."
- "Понял, окей..."

НЕ перегибай с неформальностью. Будь естественным.

Ответ на русском (2-3 предложения):""",

    # Мягкое завершение для critically frustrated
    "soft_exit_frustrated": """{system}

СИТУАЦИЯ: Клиент очень раздражён. Нужно завершить без давления.

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. Кратко извинись
2. Предложи альтернативу (информация на почту / связаться позже)
3. НЕ навязывайся

Пример: "Хорошо, не буду отнимать время. Если будет интересно — пишите, с удовольствием помогу."

Максимум 2 предложения.

Ответ на русском:""",

    # =================================================================
    # НОВЫЕ TEMPLATES для обработки интентов
    # =================================================================

    # Ответить на вопрос и продолжить разговор
    "answer_and_continue": """{system}

СИТУАЦИЯ: Клиент задал вопрос. Нужно ответить и продолжить диалог.

ВАЖНО: Отвечай СТРОГО на основе фактов ниже.
НЕ ПРИДУМЫВАЙ информацию, которой нет в фактах.

=== ФАКТЫ ДЛЯ ОТВЕТА ===
{retrieved_facts}
=========================

Диалог:
{history}

Клиент: "{user_message}"

Текущая фаза: {spin_phase}
Уже знаем: {collected_data}

Твоя задача:
1. Кратко и по делу ответь на вопрос клиента, используя ТОЛЬКО факты выше
2. Плавно верни разговор к текущей теме

Ответ на русском (2-3 предложения):""",

    # Уточнить непонятное и продолжить
    "clarify_and_continue": """{system}

СИТУАЦИЯ: Ответ клиента неясен. Нужно мягко уточнить.

Диалог:
{history}

Клиент: "{user_message}"

Текущая фаза: {spin_phase}
Уже знаем: {collected_data}

Твоя задача:
1. Покажи что услышал клиента
2. Мягко уточни что он имел в виду

Пример: "Интересно! Можете рассказать подробнее?"

Ответ на русском (1-2 предложения):""",

    # Подтвердить интерес и собрать контакт
    "confirm_and_collect_contact": """{system}

СИТУАЦИЯ: Клиент выразил интерес к демо/звонку/консультации.
Нужно подтвердить и собрать контактные данные.

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Подтверди что всё понял
2. Попроси контактные данные (телефон или email) для связи

Пример: "Отлично, договорились! Подскажите номер телефона — перезвоним в удобное время."

Ответ на русском (2 предложения):""",

    # Обработка прощания
    "handle_farewell": """{system}

СИТУАЦИЯ: Клиент прощается. Нужно вежливо завершить разговор.

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Попрощаться тепло и дружелюбно
2. Если контакт не собран — мягко предложить связаться позже

Пример: "До свидания! Если появятся вопросы — обращайтесь."

Ответ на русском (1-2 предложения):""",

    # Обработка возражения "нет времени"
    "handle_objection_no_time": """{system}

СИТУАЦИЯ: Клиент говорит что у него нет времени.

Контраргумент: {objection_counter}

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Проявить понимание
2. Предложить альтернативу (связаться позже, отправить информацию)
3. НЕ давить

Ответ на русском (2 предложения):""",

    # Обработка возражения "надо подумать"
    "handle_objection_think": """{system}

СИТУАЦИЯ: Клиент говорит что ему нужно подумать/посоветоваться.

Контраргумент: {objection_counter}

Диалог:
{history}

Клиент: "{user_message}"

Уже знаем: {collected_data}

Твоя задача:
1. Поддержать решение
2. Предложить дополнительную информацию или ответить на вопросы
3. Договориться о следующем шаге

Ответ на русском (2-3 предложения):""",

    # Обработка возражения "нет потребности"
    "handle_objection_no_need": """{system}

СИТУАЦИЯ: Клиент говорит что ему не нужна CRM / справляется без неё.

Контраргумент: {objection_counter}

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. Не спорь — признай что можно работать и без CRM
2. Мягко покажи что система может помочь с текущими задачами
3. Предложи просто посмотреть, без обязательств

Ответ на русском (2 предложения):""",

    # Обработка возражения "не доверяю"
    "handle_objection_trust": """{system}

СИТУАЦИЯ: Клиент сомневается или не доверяет.

Контраргумент: {objection_counter}

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. Признай что недоверие понятно — много пустых обещаний на рынке
2. Предложи конкретные доказательства: отзывы, кейсы, пробный период
3. Не оправдывайся — просто покажи факты

Ответ на русском (2-3 предложения):""",

    # Обработка возражения "не сейчас / потом"
    "handle_objection_timing": """{system}

СИТУАЦИЯ: Клиент хочет отложить решение.

Контраргумент: {objection_counter}

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. Принять решение без давления
2. Уточнить когда будет удобно вернуться к разговору
3. Предложить оставить контакт для связи

Ответ на русском (2 предложения):""",

    # Обработка возражения "сложно внедрять"
    "handle_objection_complexity": """{system}

СИТУАЦИЯ: Клиент боится сложности внедрения.

Контраргумент: {objection_counter}

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. Признай что страх сложности понятен
2. Объясни что система простая и есть поддержка
3. Предложи показать на демо как это работает

Ответ на русском (2 предложения):""",

    # Ответ на повторный вопрос с фактами и резюме (repair: repeated_question)
    "answer_with_summary": (
        "{system}\n\n"
        "СИТУАЦИЯ: Клиент повторяет вопрос — значит предыдущий ответ был недостаточным.\n"
        "Нужно ответить конкретнее, используя факты.\n\n"
        "=== ФАКТЫ ===\n{retrieved_facts}\n=============\n\n"
        "Что мы уже обсудили: {collected_data}\n\n"
        "Диалог:\n{history}\n\n"
        "Клиент: \"{user_message}\"\n\n"
        "Цель текущего этапа: {goal}\n\n"
        "Твоя задача:\n"
        "1. Кратко признай что уже обсуждали это (1 фраза, без извинений)\n"
        "2. Дай КОНКРЕТНЫЙ ответ с цифрами/фактами из секции ФАКТЫ\n"
        "3. Если фактов нет — честно скажи что уточнишь и вернёшься\n"
        "4. Задай ОДИН вопрос по цели этапа\n\n"
        "Ответ на русском (2-3 предложения, ОБЯЗАТЕЛЬНО включи конкретный ответ):"
    ),

    # Ответ на запрос краткости (request_brevity)
    "respond_briefly": """{system}

СИТУАЦИЯ: Клиент попросил говорить короче/по сути.
Это НЕ возражение! Просто стиль коммуникации.

Что уже знаем о клиенте: {collected_data}
Текущая фаза: {spin_phase}

=== ФАКТЫ (если нужны для краткого ответа) ===
{retrieved_facts}
================================================

Диалог:
{history}

Клиент: "{user_message}"

Твоя задача:
1. Подтвердить что понял (1 слово: "Понял" или "Хорошо")
2. Дать КОРОТКИЙ ответ по сути (1 предложение максимум), используя факты выше если релевантно
3. Если нужен вопрос — один простой вопрос

ВАЖНО: Не извиняйся, не объясняй почему был многословен.

Ответ на русском (максимум 2 коротких предложения):""",
}
