# =============================================================================
# SOCIAL SELLING STATES
# =============================================================================
# FIX: Переработано для использования universal intents
# =============================================================================

states:
  social_trust:
    extends: _base_phase
    mixins:
      - unified_progress
    goal: "Построить доверие"
    on_enter:
      set_flags:
        trust_probed: true
    required_data:
      - trust_probed
    parameters:
      prev_phase_state: greeting
      next_phase_state: social_value
      default_price_action: answer_with_pricing
      default_unclear_action: continue_current_goal
    rules:
      unclear: build_credibility
    transitions:
      data_complete: social_value

  social_value:
    extends: _base_phase
    mixins:
      - unified_progress
    goal: "Поделиться ценностью"
    on_enter:
      set_flags:
        value_shared: true
    required_data:
      - value_shared
    parameters:
      prev_phase_state: social_trust
      next_phase_state: social_engage
      default_price_action: answer_with_pricing
      default_unclear_action: continue_current_goal
    rules:
      unclear: provide_value
    transitions:
      data_complete: social_engage

  social_engage:
    extends: _base_phase
    mixins:
      - unified_progress
    goal: "Вовлечь в диалог"
    phase: engage
    required_data:
      - company_size
    parameters:
      prev_phase_state: social_value
      next_phase_state: social_convert
      default_price_action: answer_with_pricing
      default_unclear_action: continue_current_goal
    rules:
      unclear: encourage_engagement
    transitions:
      data_complete: social_convert

  social_convert:
    extends: _base_phase
    mixins:
      - unified_progress
    goal: "Конвертировать в клиента"
    required_data:
      - desired_outcome
    parameters:
      prev_phase_state: social_engage
      next_phase_state: presentation
      default_price_action: answer_with_facts
      default_unclear_action: continue_current_goal
    rules:
      unclear: guide_to_conversion
    transitions:
      data_complete: presentation
      demo_request: close
      callback_request: close
