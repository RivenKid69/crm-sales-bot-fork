"""
Примеры фраз для каждого интента — используются для семантического поиска.

Каждый интент имеет набор примеров, которые представляют типичные
формулировки пользователей. При классификации считается cosine similarity
между сообщением пользователя и примерами каждого интента.

Принципы составления примеров:
1. Разнообразие формулировок (формальные, разговорные, с опечатками)
2. Покрытие edge cases (короткие, длинные, с контекстом)
3. Баланс между специфичностью и обобщением
"""

from typing import Dict, List


# =============================================================================
# INTENT_EXAMPLES: Примеры для семантической классификации
# =============================================================================

INTENT_EXAMPLES: Dict[str, List[str]] = {
    # =========================================================================
    # ПРИВЕТСТВИЯ И ПРОЩАНИЯ
    # =========================================================================
    "greeting": [
        "привет",
        "здравствуйте",
        "добрый день",
        "доброе утро",
        "добрый вечер",
        "хай",
        "приветик",
        "салам",
        "здарова",
        "доброго времени суток",
        "рад вас видеть",
        "приветствую",
    ],

    "farewell": [
        "до свидания",
        "пока",
        "всего хорошего",
        "удачи",
        "до встречи",
        "прощайте",
        "бывай",
        "счастливо",
        "хорошего дня",
        "спасибо, пока",
        "всё, я пошёл",
        "на связи",
    ],

    "gratitude": [
        "спасибо",
        "благодарю",
        "спасибо большое",
        "огромное спасибо",
        "благодарю вас",
        "спс",
        "thx",
        "благодарствую",
        "очень признателен",
        "спасибо за информацию",
        "спасибо что уделили время",
    ],

    # =========================================================================
    # ВОПРОСЫ О ПРОДУКТЕ
    # =========================================================================
    "price_question": [
        "сколько стоит",
        "какая цена",
        "во сколько обойдётся",
        "какой прайс",
        "расскажите о ценах",
        "какие тарифы",
        "сколько это будет стоить",
        "какая стоимость подписки",
        "есть ли бесплатный тариф",
        "сколько за месяц",
        "какие расценки",
        "прайс лист покажите",
        "что по деньгам",
        "ценник какой",
    ],

    "pricing_details": [
        "а что входит в этот тариф",
        "какие ограничения на базовом плане",
        "чем отличаются тарифы",
        "что даёт премиум подписка",
        "есть ли скрытые платежи",
        "за что ещё надо платить",
        "какие дополнительные услуги",
        "расскажите подробнее о тарифах",
        "что включено в стоимость",
        "есть годовая подписка со скидкой",
    ],

    "question_features": [
        "какие функции есть",
        "что умеет ваша система",
        "расскажите о возможностях",
        "какой функционал",
        "есть ли аналитика",
        "можно ли делать отчёты",
        "как работает автоматизация",
        "есть мобильное приложение",
        "какие есть фичи",
        "что можно делать в системе",
        "опишите основные возможности",
        "чем ваша CRM отличается",
        "есть ли воронка продаж",
        "можно настроить под себя",
    ],

    "question_integrations": [
        "с чем интегрируется",
        "есть интеграция с 1С",
        "работает с телефонией",
        "можно подключить WhatsApp",
        "есть API",
        "интеграция с почтой",
        "работает с Telegram",
        "можно связать с сайтом",
        "есть виджет для сайта",
        "интеграция с банком",
        "подключается к кассе",
        "работает с эквайрингом",
        "есть коннектор к маркетплейсам",
        "синхронизация с Google Calendar",
    ],

    # =========================================================================
    # ВОЗРАЖЕНИЯ
    # =========================================================================
    "objection_price": [
        "слишком дорого",
        "дороговато для нас",
        "не укладываемся в бюджет",
        "нет денег на это",
        "цена кусается",
        "дорого для такого функционала",
        "у конкурентов дешевле",
        "не можем себе позволить",
        "бюджет не позволяет",
        "это слишком много для нас",
        "накладно выходит",
        "денег сейчас нет",
        "урезали бюджет",
        "дорого за такие деньги",
        "неоправданно высокая цена",
        "за эти деньги можно найти лучше",
    ],

    "objection_no_time": [
        "сейчас нет времени",
        "очень занят",
        "давайте позже",
        "не до этого сейчас",
        "перезвоните через месяц",
        "сейчас завал на работе",
        "после нового года вернёмся",
        "в следующем квартале",
        "некогда разбираться",
        "горят дедлайны",
        "аврал на работе",
        "конец года, отчётность",
        "сейчас не могу говорить",
        "времени в обрез",
        "загружены по горло",
    ],

    "objection_competitor": [
        "у нас уже есть CRM",
        "мы используем Битрикс",
        "работаем в AmoCRM",
        "пользуемся 1С",
        "уже внедрили другую систему",
        "нас устраивает текущее решение",
        "не хотим менять систему",
        "вложили много денег в текущую",
        "команда привыкла к другой",
        "зачем менять если работает",
        "сидим на Мегаплане",
        "есть своя самописная система",
        "недавно перешли на Salesforce",
        "уже всё настроено под нас",
    ],

    "objection_think": [
        "надо подумать",
        "нужно посоветоваться",
        "обсужу с руководством",
        "дайте время на раздумья",
        "не могу решить сам",
        "спрошу у директора",
        "это не в моей компетенции",
        "надо согласовать",
        "вернусь с ответом позже",
        "пока не готов принять решение",
        "нужно взвесить все за и против",
        "посовещаюсь с партнёром",
        "покажу коллегам",
        "не уполномочен решать",
    ],

    # =========================================================================
    # СОГЛАСИЕ И ИНТЕРЕС
    # =========================================================================
    "agreement": [
        "да, интересно",
        "давайте попробуем",
        "хочу попробовать",
        "согласен",
        "звучит хорошо",
        "готов обсудить",
        "это то что нужно",
        "берём",
        "оформляйте",
        "выставляйте счёт",
        "подходит",
        "договорились",
        "окей давайте",
        "меня устраивает",
        "готовы начать",
        "присылайте договор",
        "записывайте",
        "да конечно интересно",
        "нам актуально",
    ],

    "rejection": [
        "нет не интересно",
        "не нужно",
        "отказываюсь",
        "не хочу",
        "отстаньте",
        "не звоните больше",
        "в бан",
        "хватит спамить",
        "не актуально",
        "категорически нет",
        "ни за что",
        "это не для нас",
        "мы не ваша целевая",
        "прекратите звонить",
        "удалите мой номер",
        "идите лесом",
        "надоели",
    ],

    # =========================================================================
    # ЗАПРОСЫ НА ДЕЙСТВИЕ
    # =========================================================================
    "demo_request": [
        "хочу посмотреть демо",
        "можно демонстрацию",
        "покажите как работает",
        "запишите на демо",
        "хочу потестировать",
        "есть пробный период",
        "дайте тестовый доступ",
        "хочу попробовать бесплатно",
        "можно посмотреть систему",
        "покажите в действии",
        "организуйте презентацию",
        "хотим пилотный проект",
        "дайте триал",
        "хочу пощупать",
        "можно потыкать интерфейс",
    ],

    "callback_request": [
        "перезвоните мне",
        "можете позвонить",
        "жду звонка",
        "свяжитесь со мной",
        "вот мой номер",
        "наберите меня",
        "позвоните завтра",
        "запишите телефон",
        "лучше по телефону",
        "давайте созвонимся",
        "когда можете позвонить",
        "напишите в WhatsApp",
        "стукните в телеграм",
    ],

    "consultation_request": [
        "нужна консультация",
        "можете проконсультировать",
        "хотел бы обсудить",
        "нужен совет",
        "помогите разобраться",
        "есть вопросы по системе",
        "хочу понять подробнее",
        "объясните пожалуйста",
        "не могу разобраться",
        "нужен специалист",
        "поговорить с менеджером",
        "запутался в тарифах",
    ],

    "contact_provided": [
        "мой номер 89001234567",
        "пишите на email@example.com",
        "телефон +7 900 123 45 67",
        "вот моя почта",
        "контакт для связи",
        "записывайте номер",
        "звоните по этому",
        "мой телеграм @username",
    ],

    # =========================================================================
    # СРАВНЕНИЕ
    # =========================================================================
    "comparison": [
        "чем вы лучше AmoCRM",
        "в чём отличие от Битрикс",
        "сравните с Мегапланом",
        "почему вы а не 1С",
        "преимущества перед конкурентами",
        "что у вас есть чего нет у других",
        "AmoCRM или вы",
        "Битрикс vs ваша система",
        "чем отличаетесь от Salesforce",
        "почему стоит выбрать вас",
    ],

    # =========================================================================
    # SPIN ИНТЕНТЫ
    # =========================================================================
    "situation_provided": [
        "у нас 15 человек в команде",
        "мы ресторан в центре города",
        "работаем на рынке 5 лет",
        "оборот около миллиона в месяц",
        "3 точки продаж",
        "занимаемся оптовой торговлей",
        "небольшой интернет-магазин",
        "B2B сегмент",
        "50 сотрудников",
        "стартап на ранней стадии",
    ],

    "problem_revealed": [
        "теряем клиентов",
        "менеджеры забывают перезванивать",
        "нет контроля над продажами",
        "не видим воронку",
        "сделки уходят конкурентам",
        "хаос в задачах",
        "клиенты жалуются на сервис",
        "долго обрабатываем заявки",
        "теряем деньги на ошибках",
        "нет аналитики",
        "не понимаем откуда клиенты",
    ],

    "implication_acknowledged": [
        "да это серьёзная проблема",
        "из-за этого теряем деньги",
        "понимаю что надо решать",
        "это влияет на прибыль",
        "клиенты уходят к конкурентам",
        "репутация страдает",
        "команда демотивирована",
        "это стоит нам дорого",
    ],

    "need_expressed": [
        "нам нужна автоматизация",
        "хотим контролировать продажи",
        "нужна прозрачность",
        "хочу видеть аналитику",
        "нужно навести порядок",
        "хотим расти",
        "нужна система для масштабирования",
        "хотим улучшить сервис",
    ],

    "no_problem": [
        "у нас всё хорошо",
        "проблем нет",
        "справляемся сами",
        "нас всё устраивает",
        "не вижу проблемы",
        "работает и ладно",
    ],

    "no_need": [
        "нам это не нужно",
        "обходимся без этого",
        "не вижу необходимости",
        "справимся по-старому",
        "зачем нам это",
    ],

    "info_provided": [
        "мы занимаемся продажами",
        "у нас 10 менеджеров",
        "работаем с корпоративными клиентами",
        "основной канал - сайт",
        "средний чек 50 тысяч",
        "продаём услуги",
    ],

    # =========================================================================
    # НАВИГАЦИЯ
    # =========================================================================
    "go_back": [
        "вернёмся назад",
        "давайте к предыдущему",
        "подождите вернитесь",
        "не то обсуждаем",
        "хочу уточнить предыдущее",
    ],

    "correct_info": [
        "я ошибся",
        "неправильно сказал",
        "поправка",
        "не 10 а 15",
        "перепутал",
        "исправлюсь",
    ],

    # =========================================================================
    # НЕЯСНЫЕ И РАЗГОВОРНЫЕ
    # =========================================================================
    "unclear": [
        "что",
        "а",
        "не понял",
        "???",
        "эээ",
        "хм",
        "...",
        "ась",
        "чего",
        "не понятно",
    ],

    "small_talk": [
        "как дела",
        "как погода",
        "что нового",
        "как выходные",
        "хорошего дня",
        "отличная погода сегодня",
        "как настроение",
    ],
}


# =============================================================================
# Валидация: все интенты должны иметь примеры
# =============================================================================

def get_all_intents() -> List[str]:
    """Получить список всех интентов с примерами."""
    return list(INTENT_EXAMPLES.keys())


def get_examples_for_intent(intent: str) -> List[str]:
    """Получить примеры для конкретного интента."""
    return INTENT_EXAMPLES.get(intent, [])


def get_total_examples_count() -> int:
    """Получить общее количество примеров."""
    return sum(len(examples) for examples in INTENT_EXAMPLES.values())


# При импорте проверяем что примеры не пустые
assert len(INTENT_EXAMPLES) > 0, "INTENT_EXAMPLES must not be empty"
assert all(len(v) >= 3 for v in INTENT_EXAMPLES.values()), \
    "Each intent must have at least 3 examples"
